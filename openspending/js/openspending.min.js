(function(z){var w="0.4.0",v="hasOwnProperty",u=/[\.\/]/,t="*",r=function(){},q=function(e,d){return e-d},p,o,n={n:{}},l=function(H,G){var F=n,E=o,D=Array.prototype.slice.call(arguments,2),C=l.listeners(H),B=0,A=!1,k,j=[],i={},h=[],g=[];p=H,o=0;for(var J=0,I=C.length;J<I;J++){"zIndex" in C[J]&&(j.push(C[J].zIndex),C[J].zIndex<0&&(i[C[J].zIndex]=C[J]))}j.sort(q);while(j[B]<0){k=i[j[B++]],h.push(k.apply(G,D));if(o){o=E;return h}}for(J=0;J<I;J++){k=C[J];if("zIndex" in k){if(k.zIndex==j[B]){h.push(k.apply(G,D));if(o){o=E;return h}do{B++,k=i[j[B]],k&&h.push(k.apply(G,D));if(o){o=E;return h}}while(k)}else{i[k.zIndex]=k}}else{h.push(k.apply(G,D));if(o){o=E;return h}}}o=E;return h.length?h:null};l.listeners=function(J){var I=J.split(u),H=n,G,F,E,D,C,B,A,j,e=[H],d=[];for(D=0,C=I.length;D<C;D++){j=[];for(B=0,A=e.length;B<A;B++){H=e[B].n,F=[H[I[D]],H[t]],E=2;while(E--){G=F[E],G&&(j.push(G),d=d.concat(G.f||[]))}}e=j}return d},l.on=function(f,d){var A=f.split(u),k=n;for(var j=0,i=A.length;j<i;j++){k=k.n,!k[A[j]]&&(k[A[j]]={n:{}}),k=k[A[j]]}k.f=k.f||[];for(j=0,i=k.f.length;j<i;j++){if(k.f[j]==d){return r}}k.f.push(d);return function(b){+b==+b&&(d.zIndex=+b)}},l.stop=function(){o=1},l.nt=function(b){if(b){return(new RegExp("(?:\\.|\\/|^)"+b+"(?:\\.|\\/|$)")).test(p)}return p},l.unbind=function(I,H){var G=I.split(u),F,E,D,C,B,A,j,e=[n];for(C=0,B=G.length;C<B;C++){for(A=0;A<e.length;A+=D.length-2){D=[A,1],F=e[A].n;if(G[C]!=t){F[G[C]]&&D.push(F[G[C]])}else{for(E in F){F[v](E)&&D.push(F[E])}}e.splice.apply(e,D)}}for(C=0,B=e.length;C<B;C++){F=e[C];while(F.n){if(H){if(F.f){for(A=0,j=F.f.length;A<j;A++){if(F.f[A]==H){F.f.splice(A,1);break}}!F.f.length&&delete F.f}for(E in F.n){if(F.n[v](E)&&F.n[E].f){var d=F.n[E].f;for(A=0,j=d.length;A<j;A++){if(d[A]==H){d.splice(A,1);break}}!d.length&&delete F.n[E].f}}}else{delete F.f;for(E in F.n){F.n[v](E)&&F.n[E].f&&delete F.n[E].f}}F=F.n}}},l.once=function(e,d){var f=function(){d.apply(this,arguments),l.unbind(e,f)};return l.on(e,f)},l.version=w,l.toString=function(){return"You are running Eve "+w},typeof module!="undefined"&&module.exports?module.exports=l:z.eve=l})(this),function(){function ad(bt,bs,br,bq,bp,bo){br=cG(br);var bn,bm,bl,bk=[],bj,bi,bg,bd=bt.ms,bb={},Z={},X={};if(bq){for(T=0,Q=ak.length;T<Q;T++){var V=ak[T];if(V.el.id==bs.id&&V.anim==bt){V.percent!=br?(ak.splice(T,1),bl=1):bm=V,bs.attr(V.totalOrigin);break}}}else{bq=+Z}for(var T=0,Q=bt.percents.length;T<Q;T++){if(bt.percents[T]==br||bt.percents[T]>bq*bt.top){br=bt.percents[T],bi=bt.percents[T-1]||0,bd=bd/bt.top*(br-bi),bj=bt.percents[T+1],bn=bt.anim[br];break}bq&&bs.attr(bt.anim[bt.percents[T]])}if(!!bn){if(!bm){for(var bh in bn){if(bn[aR](bh)){if(cx[aR](bh)||bs.paper.customAttributes[aR](bh)){bb[bh]=bs.attr(bh),bb[bh]==null&&(bb[bh]=cA[bh]),Z[bh]=bn[bh];switch(cx[bh]){case c3:X[bh]=(Z[bh]-bb[bh])/bd;break;case"colour":bb[bh]=a2.getRGB(bb[bh]);var bf=a2.getRGB(Z[bh]);X[bh]={r:(bf.r-bb[bh].r)/bd,g:(bf.g-bb[bh].g)/bd,b:(bf.b-bb[bh].b)/bd};break;case"path":var be=dj(bb[bh],Z[bh]),bc=be[1];bb[bh]=be[0],X[bh]=[];for(T=0,Q=bb[bh].length;T<Q;T++){X[bh][T]=[0];for(var ba=1,Y=bb[bh][T].length;ba<Y;ba++){X[bh][T][ba]=(bc[T][ba]-bb[bh][T][ba])/bd}}break;case"transform":var W=bs._,U=da(W[bh],Z[bh]);if(U){bb[bh]=U.from,Z[bh]=U.to,X[bh]=[],X[bh].real=!0;for(T=0,Q=bb[bh].length;T<Q;T++){X[bh][T]=[bb[bh][T][0]];for(ba=1,Y=bb[bh][T].length;ba<Y;ba++){X[bh][T][ba]=(Z[bh][T][ba]-bb[bh][T][ba])/bd}}}else{var S=bs.matrix||new c9,N={_:{transform:W.transform},getBBox:function(){return bs.getBBox(1)}};bb[bh]=[S.a,S.b,S.c,S.d,S.e,S.f],dc(N,Z[bh]),Z[bh]=N._.transform,X[bh]=[(N.matrix.a-S.a)/bd,(N.matrix.b-S.b)/bd,(N.matrix.c-S.c)/bd,(N.matrix.d-S.d)/bd,(N.matrix.e-S.e)/bd,(N.matrix.e-S.f)/bd]}break;case"csv":var C=aA(bn[bh])[ay](aZ),r=aA(bb[bh])[ay](aZ);if(bh=="clip-rect"){bb[bh]=r,X[bh]=[],T=r.length;while(T--){X[bh][T]=(C[T]-bb[bh][T])/bd}}Z[bh]=C;break;default:C=[][aI](bn[bh]),r=[][aI](bb[bh]),X[bh]=[],T=bs.paper.customAttributes[bh].length;while(T--){X[bh][T]=((C[T]||0)-(r[T]||0))/bd}}}}}var n=bn.easing,g=a2.easing_formulas[n];if(!g){g=aA(n).match(cL);if(g&&g.length==5){var a=g;g=function(b){return af(b,+a[1],+a[2],+a[3],+a[4],bd)}}else{g=cB}}bg=bn.start||bt.start||+(new Date),V={anim:bt,percent:br,timestamp:bg,start:bg+(bt.del||0),status:0,initstatus:bq||0,stop:!1,ms:bd,easing:g,from:bb,diff:X,to:Z,el:bs,callback:bn.callback,prev:bi,next:bj,repeat:bo||bt.times,origin:bs.attr(),totalOrigin:bp},ak.push(V);if(bq&&!bm&&!bl){V.stop=!0,V.start=new Date-bd*bq;if(ak.length==1){return ah()}}bl&&(V.start=new Date-V.ms*bq),ak.length==1&&ai(ah)}else{bm.initstatus=bq,bm.start=new Date-bm.ms*bq}eve("anim.start."+bs.id,bs,bt)}}function ae(g,f){var j=[],i={};this.ms=f,this.times=1;if(g){for(var h in g){g[aR](h)&&(i[cG(h)]=g[h],j.push(cG(h)))}j.sort(cF)}this.anim=i,this.top=j[j.length-1],this.percents=j}function af(G,F,E,D,C,B){function p(h,g){var I,H,o,n,l,i;for(o=h,i=0;i<8;i++){n=r(o)-h;if(aj(n)<g){return o}l=(3*w*o+2*z)*o+A;if(aj(l)<0.000001){break}o=o-n/l}I=0,H=1,o=h;if(o<I){return I}if(o>H){return H}while(I<H){n=r(o);if(aj(n-h)<g){return o}h>n?I=o:H=o,o=(H-I)/2+I}return o}function q(e,d){var f=p(e,d);return((t*f+u)*f+v)*f}function r(b){return((w*b+z)*b+A)*b}var A=3*F,z=3*(D-F)-A,w=1-A-z,v=3*E,u=3*(C-E)-v,t=1-v-u;return q(G,1/(200*B))}function aC(){return this.x+aB+this.y+aB+this.width+" × "+this.height}function aE(){return this.x+aB+this.y}function c9(h,g,l,k,j,i){h!=null?(this.a=+h,this.b=+g,this.c=+l,this.d=+k,this.e=+j,this.f=+i):(this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0)}function aV(g){var f=[];for(var j=0,i=g.length;i-2>j;j+=2){var h=[{x:+g[j],y:+g[j+1]},{x:+g[j],y:+g[j+1]},{x:+g[j+2],y:+g[j+3]},{x:+g[j+4],y:+g[j+5]}];i-4==j?(h[0]={x:+g[j-2],y:+g[j-1]},h[3]=h[2]):j&&(h[0]={x:+g[j-2],y:+g[j-1]}),f.push(["C",(-h[0].x+6*h[1].x+h[2].x)/6,(-h[0].y+6*h[1].y+h[2].y)/6,(h[1].x+6*h[2].x-h[3].x)/6,(h[1].y+6*h[2].y-h[3].y)/6,h[2].x,h[2].y])}return f}function aX(){return this.hex}function a1(f,e,h){function g(){var j=Array.prototype.slice.call(arguments,0),d=j.join("␀"),b=g.cache=g.cache||{},a=g.count=g.count||[];if(b[aR](d)){a3(a,d);return h?h(b[d]):b[d]}a.length>=1000&&delete b[a.shift()],a.push(d),b[d]=f[aJ](e,j);return h?h(b[d]):b[d]}return g}function a3(f,e){for(var h=0,g=f.length;h<g;h++){if(f[h]===e){return f.push(f.splice(h,1)[0])}}}function a2(f){if(a2.is(f,"function")){return a0?f():eve.on("DOMload",f)}if(a2.is(f,cZ)){return a2._engine.create[aJ](a2,f.splice(0,3+a2.is(f[0],c3))).add(f)}var b=Array.prototype.slice.call(arguments,0);if(a2.is(b[b.length-1],"function")){var a=b.pop();return a0?a.call(a2._engine.create[aJ](a2,b)):eve.on("DOMload",function(){a.call(a2._engine.create[aJ](a2,b))})}return a2._engine.create[aJ](a2,arguments)}a2.version="2.0.1",a2.eve=eve;var a0,aZ=/[, ]+/,aW={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},aU=/\{(\d+)\}/g,aT="prototype",aR="hasOwnProperty",aP={doc:document,win:window},aN={was:Object.prototype[aR].call(aP.win,"Raphael"),is:aP.win.Raphael},aM=function(){this.ca=this.customAttributes={}},aL,aK="appendChild",aJ="apply",aI="concat",aG="createTouch" in aP.doc,aD="",aB=" ",aA=String,ay="split",aw="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend touchcancel"[ay](aB),au={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},ar=aA.prototype.toLowerCase,ap=Math,an=ap.max,al=ap.min,aj=ap.abs,c7=ap.pow,c5=ap.PI,c3="number",c1="string",cZ="array",cX="toString",cV="fill",cT=Object.prototype.toString,cR={},cQ="push",cP=a2._ISURL=/^url\(['"]?([^\)]+?)['"]?\)$/i,cO=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+%?)?)\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i,cN={NaN:1,Infinity:1,"-Infinity":1},cL=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,cK=ap.round,cI="setAttribute",cG=parseFloat,cE=parseInt,cC=aA.prototype.toUpperCase,cA=a2._availableAttrs={"arrow-end":"none","arrow-start":"none",blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/","letter-spacing":0,opacity:1,path:"M0,0",r:0,rx:0,ry:0,src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt","stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",transform:"",width:0,x:0,y:0},cx=a2._availableAnimAttrs={blur:c3,"clip-rect":"csv",cx:c3,cy:c3,fill:"colour","fill-opacity":c3,"font-size":c3,height:c3,opacity:c3,path:"path",r:c3,rx:c3,ry:c3,stroke:"colour","stroke-opacity":c3,"stroke-width":c3,transform:"transform",width:c3,x:c3,y:c3},cv=/\s*,\s*/,b8={hs:1,rg:1},b6=/,?([achlmqrstvxz]),?/gi,b4=/([achlmrqstvz])[\s,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?\s*,?\s*)+)/ig,b2=/([rstm])[\s,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?\s*,?\s*)+)/ig,dr=/(-?\d*\.?\d*(?:e[\-+]?\d+)?)\s*,?\s*/ig,a6=a2._radial_gradient=/^r(?:\(([^,]+?)\s*,\s*([^\)]+?)\))?/,cJ={},cH=function(e,d){return e.key-d.key},cF=function(e,d){return cG(e)-cG(d)},cD=function(){},cB=function(b){return b},cy=a2._rectPath=function(g,f,j,i,h){if(h){return[["M",g+h,f],["l",j-h*2,0],["a",h,h,0,0,1,h,h],["l",0,i-h*2],["a",h,h,0,0,1,-h,h],["l",h*2-j,0],["a",h,h,0,0,1,-h,-h],["l",0,h*2-i],["a",h,h,0,0,1,h,-h],["z"]]}return[["M",g,f],["l",j,0],["l",0,i],["l",-j,0],["z"]]},cw=function(f,e,h,g){g==null&&(g=h);return[["M",f,e],["m",0,-g],["a",h,g,0,1,1,0,2*g],["a",h,g,0,1,1,0,-2*g],["z"]]},b9=a2._getPath={path:function(b){return b.attr("path")},circle:function(e){var d=e.attrs;return cw(d.cx,d.cy,d.r)},ellipse:function(e){var d=e.attrs;return cw(d.cx,d.cy,d.rx,d.ry)},rect:function(e){var d=e.attrs;return cy(d.x,d.y,d.width,d.height,d.r)},image:function(e){var d=e.attrs;return cy(d.x,d.y,d.width,d.height)},text:function(e){var d=e._getBBox();return cy(d.x,d.y,d.width,d.height)}},b7=a2.mapPath=function(t,r){if(!r){return t}var q,p,o,n,l,k,j;t=dj(t);for(o=0,l=t.length;o<l;o++){j=t[o];for(n=1,k=j.length;n<k;n+=2){q=r.x(j[n],j[n+1]),p=r.y(j[n],j[n+1]),j[n]=q,j[n+1]=p}}return t};a2._g=aP,a2.type=aP.win.SVGAngle||aP.doc.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML";if(a2.type=="VML"){var b5=aP.doc.createElement("div"),b3;b5.innerHTML='<v:shape adj="1"/>',b3=b5.firstChild,b3.style.behavior="url(#default#VML)";if(!b3||typeof b3.adj!="object"){return a2.type=aD}b5=null}a2.svg=!(a2.vml=a2.type=="VML"),a2._Paper=aM,a2.fn=aL=aM.prototype=a2.prototype,a2._id=0,a2._oid=0,a2.is=function(e,d){d=ar.call(d);if(d=="finite"){return !cN[aR](+e)}if(d=="array"){return e instanceof Array}return d=="null"&&e===null||d==typeof e&&e!==null||d=="object"&&e===Object(e)||d=="array"&&Array.isArray&&Array.isArray(e)||cT.call(e).slice(8,-1).toLowerCase()==d},a2.angle=function(a,q,p,o,n,l){if(n==null){var k=a-p,j=q-o;if(!k&&!j){return 0}return(180+ap.atan2(-j,-k)*180/c5+360)%360}return a2.angle(a,q,n,l)-a2.angle(p,o,n,l)},a2.rad=function(b){return b%360*c5/180},a2.deg=function(b){return b*180/c5%360},a2.snapTo=function(a,j,i){i=a2.is(i,"finite")?i:10;if(a2.is(a,cZ)){var h=a.length;while(h--){if(aj(a[h]-j)<=i){return a[h]}}}else{a=+a;var g=j%a;if(g<i){return j-g}if(g>a-i){return j-g+a}}return j};var b1=a2.createUUID=function(e,d){return function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(e,d).toUpperCase()}}(/[xy]/g,function(e){var d=ap.random()*16|0,f=e=="x"?d:d&3|8;return f.toString(16)});a2.setWindow=function(a){eve("setWindow",a2,aP.win,a),aP.win=a,aP.doc=aP.win.document,a2._engine.initWin&&a2._engine.initWin(aP.win)};var b0=function(a){if(a2.vml){var o=/^\s+|\s+$/g,n;try{var l=new ActiveXObject("htmlfile");l.write("<body>"),l.close(),n=l.body}catch(k){n=createPopup().document.body}var j=n.createTextRange();b0=a1(function(f){try{n.style.color=aA(f).replace(o,aD);var d=j.queryCommandValue("ForeColor");d=(d&255)<<16|d&65280|(d&16711680)>>>16;return"#"+("000000"+d.toString(16)).slice(-6)}catch(g){return"none"}})}else{var h=aP.doc.createElement("i");h.title="Raphaël Colour Picker",h.style.display="none",aP.doc.body.appendChild(h),b0=a1(function(b){h.style.color=b;return aP.doc.defaultView.getComputedStyle(h,aD).getPropertyValue("color")})}return b0(a)},a9=function(){return"hsb("+[this.h,this.s,this.b]+")"},a8=function(){return"hsl("+[this.h,this.s,this.l]+")"},a7=function(){return this.hex},a5=function(a,h,g){h==null&&a2.is(a,"object")&&"r" in a&&"g" in a&&"b" in a&&(g=a.b,h=a.g,a=a.r);if(h==null&&a2.is(a,c1)){var f=a2.getRGB(a);a=f.r,h=f.g,g=f.b}if(a>1||h>1||g>1){a/=255,h/=255,g/=255}return[a,h,g]},a4=function(a,j,i,h){a*=255,j*=255,i*=255;var g={r:a,g:j,b:i,hex:a2.rgb(a,j,i),toString:a7};a2.is(h,"finite")&&(g.opacity=h);return g};a2.color=function(a){var d;a2.is(a,"object")&&"h" in a&&"s" in a&&"b" in a?(d=a2.hsb2rgb(a),a.r=d.r,a.g=d.g,a.b=d.b,a.hex=d.hex):a2.is(a,"object")&&"h" in a&&"s" in a&&"l" in a?(d=a2.hsl2rgb(a),a.r=d.r,a.g=d.g,a.b=d.b,a.hex=d.hex):(a2.is(a,"string")&&(a=a2.getRGB(a)),a2.is(a,"object")&&"r" in a&&"g" in a&&"b" in a?(d=a2.rgb2hsl(a),a.h=d.h,a.s=d.s,a.l=d.l,d=a2.rgb2hsb(a),a.v=d.b):(a={hex:"none"},a.r=a.g=a.b=a.h=a.s=a.v=a.l=-1)),a.toString=a7;return a},a2.hsb2rgb=function(t,r,q,p){this.is(t,"object")&&"h" in t&&"s" in t&&"b" in t&&(q=t.b,r=t.s,t=t.h,p=t.o),t*=360;var o,n,l,k,j;t=t%360/60,j=q*r,k=j*(1-aj(t%2-1)),o=n=l=q-j,t=~~t,o+=[j,k,0,0,k,j][t],n+=[k,j,j,k,0,0][t],l+=[0,0,k,j,j,k][t];return a4(o,n,l,p)},a2.hsl2rgb=function(t,r,q,p){this.is(t,"object")&&"h" in t&&"s" in t&&"l" in t&&(q=t.l,r=t.s,t=t.h);if(t>1||r>1||q>1){t/=360,r/=100,q/=100}t*=360;var o,n,l,k,j;t=t%360/60,j=2*r*(q<0.5?q:1-q),k=j*(1-aj(t%2-1)),o=n=l=q-j/2,t=~~t,o+=[j,k,0,0,k,j][t],n+=[k,j,j,k,0,0][t],l+=[0,0,k,j,j,k][t];return a4(o,n,l,p)},a2.rgb2hsb=function(i,h,o){o=a5(i,h,o),i=o[0],h=o[1],o=o[2];var n,l,k,j;k=an(i,h,o),j=k-al(i,h,o),n=j==0?null:k==i?(h-o)/j:k==h?(o-i)/j+2:(i-h)/j+4,n=(n+360)%6*60/360,l=j==0?0:j/k;return{h:n,s:l,b:k,toString:a9}},a2.rgb2hsl=function(t,r,q){q=a5(t,r,q),t=q[0],r=q[1],q=q[2];var p,o,n,l,k,j;l=an(t,r,q),k=al(t,r,q),j=l-k,p=j==0?null:l==t?(r-q)/j:l==r?(q-t)/j+2:(t-r)/j+4,p=(p+360)%6*60/360,n=(l+k)/2,o=j==0?0:n<0.5?j/(2*n):j/(2-2*n);return{h:p,s:o,l:n,toString:a8}},a2._path2string=function(){return this.join(",").replace(b6,"$1")};var aY=a2._preload=function(e,d){var f=aP.doc.createElement("img");f.style.cssText="position:absolute;left:-9999em;top:-9999em",f.onload=function(){d.call(this),this.onload=null,aP.doc.body.removeChild(this)},f.onerror=function(){aP.doc.body.removeChild(this)},aP.doc.body.appendChild(f),f.src=e};a2.getRGB=a1(function(t){if(!t||!!((t=aA(t)).indexOf("-")+1)){return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:aX}}if(t=="none"){return{r:-1,g:-1,b:-1,hex:"none",toString:aX}}!b8[aR](t.toLowerCase().substring(0,2))&&t.charAt()!="#"&&(t=b0(t));var r,q,p,o,n,l,g,a=t.match(cO);if(a){a[2]&&(o=cE(a[2].substring(5),16),p=cE(a[2].substring(3,5),16),q=cE(a[2].substring(1,3),16)),a[3]&&(o=cE((l=a[3].charAt(3))+l,16),p=cE((l=a[3].charAt(2))+l,16),q=cE((l=a[3].charAt(1))+l,16)),a[4]&&(g=a[4][ay](cv),q=cG(g[0]),g[0].slice(-1)=="%"&&(q*=2.55),p=cG(g[1]),g[1].slice(-1)=="%"&&(p*=2.55),o=cG(g[2]),g[2].slice(-1)=="%"&&(o*=2.55),a[1].toLowerCase().slice(0,4)=="rgba"&&(n=cG(g[3])),g[3]&&g[3].slice(-1)=="%"&&(n/=100));if(a[5]){g=a[5][ay](cv),q=cG(g[0]),g[0].slice(-1)=="%"&&(q*=2.55),p=cG(g[1]),g[1].slice(-1)=="%"&&(p*=2.55),o=cG(g[2]),g[2].slice(-1)=="%"&&(o*=2.55),(g[0].slice(-3)=="deg"||g[0].slice(-1)=="°")&&(q/=360),a[1].toLowerCase().slice(0,4)=="hsba"&&(n=cG(g[3])),g[3]&&g[3].slice(-1)=="%"&&(n/=100);return a2.hsb2rgb(q,p,o,n)}if(a[6]){g=a[6][ay](cv),q=cG(g[0]),g[0].slice(-1)=="%"&&(q*=2.55),p=cG(g[1]),g[1].slice(-1)=="%"&&(p*=2.55),o=cG(g[2]),g[2].slice(-1)=="%"&&(o*=2.55),(g[0].slice(-3)=="deg"||g[0].slice(-1)=="°")&&(q/=360),a[1].toLowerCase().slice(0,4)=="hsla"&&(n=cG(g[3])),g[3]&&g[3].slice(-1)=="%"&&(n/=100);return a2.hsl2rgb(q,p,o,n)}a={r:q,g:p,b:o,toString:aX},a.hex="#"+(16777216|o|p<<8|q<<16).toString(16).slice(1),a2.is(n,"finite")&&(a.opacity=n);return a}return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:aX}},a2),a2.hsb=a1(function(a,f,e){return a2.hsb2rgb(a,f,e).hex}),a2.hsl=a1(function(a,f,e){return a2.hsl2rgb(a,f,e).hex}),a2.rgb=a1(function(e,d,f){return"#"+(16777216|f|d<<8|e<<16).toString(16).slice(1)}),a2.getColor=function(e){var d=this.getColor.start=this.getColor.start||{h:0,s:1,b:e||0.75},f=this.hsb2rgb(d.h,d.s,d.b);d.h+=0.075,d.h>1&&(d.h=0,d.s-=0.2,d.s<=0&&(this.getColor.start={h:0,s:1,b:d.b}));return f.hex},a2.getColor.reset=function(){delete this.start},a2.parsePathString=a1(function(a){if(!a){return null}var f={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},e=[];a2.is(a,cZ)&&a2.is(a[0],cZ)&&(e=aQ(a)),e.length||aA(a).replace(b4,function(h,d,k){var j=[],i=d.toLowerCase();k.replace(dr,function(l,g){g&&j.push(+g)}),i=="m"&&j.length>2&&(e.push([d][aI](j.splice(0,2))),i="l",d=d=="m"?"l":"L");if(i=="r"){e.push([d][aI](j))}else{while(j.length>=f[i]){e.push([d][aI](j.splice(0,f[i])));if(!f[i]){break}}}}),e.toString=a2._path2string;return e}),a2.parseTransformString=a1(function(a){if(!a){return null}var f={r:3,s:4,t:2,m:6},e=[];a2.is(a,cZ)&&a2.is(a[0],cZ)&&(e=aQ(a)),e.length||aA(a).replace(b2,function(g,d,j){var i=[],h=ar.call(d);j.replace(dr,function(l,k){k&&i.push(+k)}),e.push([d][aI](i))}),e.toString=a2._path2string;return e}),a2.findDotsAtSegment=function(Y,X,W,V,U,T,S,R,Q){var P=1-Q,O=c7(P,3),N=c7(P,2),M=Q*Q,L=M*Q,J=O*Y+N*3*Q*W+P*3*Q*Q*U+L*S,I=O*X+N*3*Q*V+P*3*Q*Q*T+L*R,H=Y+2*Q*(W-Y)+M*(U-2*W+Y),G=X+2*Q*(V-X)+M*(T-2*V+X),F=W+2*Q*(U-W)+M*(S-2*U+W),E=V+2*Q*(T-V)+M*(R-2*T+V),D=P*Y+Q*W,C=P*X+Q*V,B=P*U+Q*S,A=P*T+Q*R,w=90-ap.atan2(H-F,G-E)*180/c5;(H>F||G<E)&&(w+=180);return{x:J,y:I,m:{x:H,y:G},n:{x:F,y:E},start:{x:D,y:C},end:{x:B,y:A},alpha:w}},a2._removedFactory=function(b){return function(){throw new Error("Raphaël: you are calling to method “"+b+"” of removed object")}};var aS=a1(function(z){if(!z){return{x:0,y:0,width:0,height:0}}z=dj(z);var w=0,v=0,u=[],t=[],r;for(var q=0,p=z.length;q<p;q++){r=z[q];if(r[0]=="M"){w=r[1],v=r[2],u.push(w),t.push(v)}else{var o=dk(w,v,r[1],r[2],r[3],r[4],r[5],r[6]);u=u[aI](o.min.x,o.max.x),t=t[aI](o.min.y,o.max.y),w=r[5],v=r[6]}}var n=al[aJ](0,u),l=al[aJ](0,t);return{x:n,y:l,width:an[aJ](0,u)-n,height:an[aJ](0,t)-l}},null,function(b){return{x:b.x,y:b.y,width:b.width,height:b.height}}),aQ=function(a){var l=[];if(!a2.is(a,cZ)||!a2.is(a&&a[0],cZ)){a=a2.parsePathString(a)}for(var k=0,j=a.length;k<j;k++){l[k]=[];for(var i=0,h=a[k].length;i<h;i++){l[k][i]=a[k][i]}}l.toString=a2._path2string;return l},aO=a2._pathToRelative=a1(function(I){if(!a2.is(I,cZ)||!a2.is(I&&I[0],cZ)){I=a2.parsePathString(I)}var H=[],G=0,F=0,E=0,D=0,C=0;I[0][0]=="M"&&(G=I[0][1],F=I[0][2],E=G,D=F,C++,H.push(["M",G,F]));for(var B=C,A=I.length;B<A;B++){var z=H[B]=[],w=I[B];if(w[0]!=ar.call(w[0])){z[0]=ar.call(w[0]);switch(z[0]){case"a":z[1]=w[1],z[2]=w[2],z[3]=w[3],z[4]=w[4],z[5]=w[5],z[6]=+(w[6]-G).toFixed(3),z[7]=+(w[7]-F).toFixed(3);break;case"v":z[1]=+(w[1]-F).toFixed(3);break;case"m":E=w[1],D=w[2];default:for(var v=1,u=w.length;v<u;v++){z[v]=+(w[v]-(v%2?G:F)).toFixed(3)}}}else{z=H[B]=[],w[0]=="m"&&(E=w[1]+G,D=w[2]+F);for(var t=0,r=w.length;t<r;t++){H[B][t]=w[t]}}var a=H[B].length;switch(H[B][0]){case"z":G=E,F=D;break;case"h":G+=+H[B][a-1];break;case"v":F+=+H[B][a-1];break;default:G+=+H[B][a-2],F+=+H[B][a-1]}}H.toString=a2._path2string;return H},0,aQ),dq=a2._pathToAbsolute=a1(function(I){if(!a2.is(I,cZ)||!a2.is(I&&I[0],cZ)){I=a2.parsePathString(I)}if(!I||!I.length){return[["M",0,0]]}var H=[],G=0,F=0,E=0,D=0,C=0;I[0][0]=="M"&&(G=+I[0][1],F=+I[0][2],E=G,D=F,C++,H[0]=["M",G,F]);for(var B,A,z=C,w=I.length;z<w;z++){H.push(B=[]),A=I[z];if(A[0]!=cC.call(A[0])){B[0]=cC.call(A[0]);switch(B[0]){case"A":B[1]=A[1],B[2]=A[2],B[3]=A[3],B[4]=A[4],B[5]=A[5],B[6]=+(A[6]+G),B[7]=+(A[7]+F);break;case"V":B[1]=+A[1]+F;break;case"H":B[1]=+A[1]+G;break;case"R":var v=[G,F][aI](A.slice(1));for(var u=2,t=v.length;u<t;u++){v[u]=+v[u]+G,v[++u]=+v[u]+F}H.pop(),H=H[aI](aV(v));break;case"M":E=+A[1]+G,D=+A[2]+F;default:for(u=1,t=A.length;u<t;u++){B[u]=+A[u]+(u%2?G:F)}}}else{if(A[0]=="R"){v=[G,F][aI](A.slice(1)),H.pop(),H=H[aI](aV(v)),B=["R"][aI](A.slice(-2))}else{for(var n=0,a=A.length;n<a;n++){B[n]=A[n]}}}switch(B[0]){case"Z":G=E,F=D;break;case"H":G=B[1];break;case"V":F=B[1];break;case"M":E=B[B.length-2],D=B[B.length-1];default:G=B[B.length-2],F=B[B.length-1]}}H.toString=a2._path2string;return H},null,aQ),dp=function(f,e,h,g){return[f,e,h,g,h,g]},dn=function(j,i,q,p,o,n){var l=1/3,k=2/3;return[l*j+k*q,l*i+k*p,l*o+k*q,l*n+k*p,o,n]},dm=function(bM,bL,bK,bJ,bI,bH,bG,bF,bE,bD){var bC=c5*120/180,bB=c5/180*(+bI||0),bA=[],bz,by=a1(function(g,f,j){var i=g*ap.cos(j)-f*ap.sin(j),h=g*ap.sin(j)+f*ap.cos(j);return{x:i,y:h}});if(!bD){bz=by(bM,bL,-bB),bM=bz.x,bL=bz.y,bz=by(bF,bE,-bB),bF=bz.x,bE=bz.y;var bx=ap.cos(c5/180*bI),bw=ap.sin(c5/180*bI),bv=(bM-bF)/2,bu=(bL-bE)/2,bt=bv*bv/(bK*bK)+bu*bu/(bJ*bJ);bt>1&&(bt=ap.sqrt(bt),bK=bt*bK,bJ=bt*bJ);var bs=bK*bK,br=bJ*bJ,bq=(bH==bG?-1:1)*ap.sqrt(aj((bs*br-bs*bu*bu-br*bv*bv)/(bs*bu*bu+br*bv*bv))),bp=bq*bK*bu/bJ+(bM+bF)/2,bo=bq*-bJ*bv/bK+(bL+bE)/2,bn=ap.asin(((bL-bo)/bJ).toFixed(9)),bm=ap.asin(((bE-bo)/bJ).toFixed(9));bn=bM<bp?c5-bn:bn,bm=bF<bp?c5-bm:bm,bn<0&&(bn=c5*2+bn),bm<0&&(bm=c5*2+bm),bG&&bn>bm&&(bn=bn-c5*2),!bG&&bm>bn&&(bm=bm-c5*2)}else{bn=bD[0],bm=bD[1],bp=bD[2],bo=bD[3]}var bl=bm-bn;if(aj(bl)>bC){var bk=bm,bj=bF,bi=bE;bm=bn+bC*(bG&&bm>bn?1:-1),bF=bp+bK*ap.cos(bm),bE=bo+bJ*ap.sin(bm),bA=dm(bF,bE,bK,bJ,bI,0,bG,bj,bi,[bm,bk,bp,bo])}bl=bm-bn;var bh=ap.cos(bn),bg=ap.sin(bn),bf=ap.cos(bm),be=ap.sin(bm),bd=ap.tan(bl/4),bc=4/3*bK*bd,bb=4/3*bJ*bd,ba=[bM,bL],Z=[bM+bc*bg,bL-bb*bh],Y=[bF+bc*be,bE-bb*bf],B=[bF,bE];Z[0]=2*ba[0]-Z[0],Z[1]=2*ba[1]-Z[1];if(bD){return[Z,Y,B][aI](bA)}bA=[Z,Y,B][aI](bA).join()[ay](",");var z=[];for(var w=0,n=bA.length;w<n;w++){z[w]=w%2?by(bA[w-1],bA[w],bB).y:by(bA[w],bA[w+1],bB).x}return z},dl=function(v,u,t,r,q,p,o,n,l){var k=1-l;return{x:c7(k,3)*v+c7(k,2)*3*l*t+k*3*l*l*q+c7(l,3)*o,y:c7(k,3)*u+c7(k,2)*3*l*r+k*3*l*l*p+c7(l,3)*n}},dk=a1(function(J,I,H,G,F,E,D,C){var B=F-2*H+J-(D-2*F+H),A=2*(H-J)-2*(F-H),z=J-H,w=(-A+ap.sqrt(A*A-4*B*z))/2/B,v=(-A-ap.sqrt(A*A-4*B*z))/2/B,u=[I,C],t=[J,D],r;aj(w)>"1e12"&&(w=0.5),aj(v)>"1e12"&&(v=0.5),w>0&&w<1&&(r=dl(J,I,H,G,F,E,D,C,w),t.push(r.x),u.push(r.y)),v>0&&v<1&&(r=dl(J,I,H,G,F,E,D,C,v),t.push(r.x),u.push(r.y)),B=E-2*G+I-(C-2*E+G),A=2*(G-I)-2*(E-G),z=I-G,w=(-A+ap.sqrt(A*A-4*B*z))/2/B,v=(-A-ap.sqrt(A*A-4*B*z))/2/B,aj(w)>"1e12"&&(w=0.5),aj(v)>"1e12"&&(v=0.5),w>0&&w<1&&(r=dl(J,I,H,G,F,E,D,C,w),t.push(r.x),u.push(r.y)),v>0&&v<1&&(r=dl(J,I,H,G,F,E,D,C,v),t.push(r.x),u.push(r.y));return{min:{x:al[aJ](0,t),y:al[aJ](0,u)},max:{x:an[aJ](0,t),y:an[aJ](0,u)}}}),dj=a2._path2curve=a1(function(H,G){var F=dq(H),E=G&&dq(G),D={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},C={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},B=function(f,e){var h,g;if(!f){return["C",e.x,e.y,e.x,e.y,e.x,e.y]}!(f[0] in {T:1,Q:1})&&(e.qx=e.qy=null);switch(f[0]){case"M":e.X=f[1],e.Y=f[2];break;case"A":f=["C"][aI](dm[aJ](0,[e.x,e.y][aI](f.slice(1))));break;case"S":h=e.x+(e.x-(e.bx||e.x)),g=e.y+(e.y-(e.by||e.y)),f=["C",h,g][aI](f.slice(1));break;case"T":e.qx=e.x+(e.x-(e.qx||e.x)),e.qy=e.y+(e.y-(e.qy||e.y)),f=["C"][aI](dn(e.x,e.y,e.qx,e.qy,f[1],f[2]));break;case"Q":e.qx=f[1],e.qy=f[2],f=["C"][aI](dn(e.x,e.y,f[1],f[2],f[3],f[4]));break;case"L":f=["C"][aI](dp(e.x,e.y,f[1],f[2]));break;case"H":f=["C"][aI](dp(e.x,e.y,f[1],e.y));break;case"V":f=["C"][aI](dp(e.x,e.y,e.x,f[1]));break;case"Z":f=["C"][aI](dp(e.x,e.y,e.X,e.Y))}return f},A=function(f,d){if(f[d].length>7){f[d].shift();var g=f[d];while(g.length){f.splice(d++,0,["C"][aI](g.splice(0,6)))}f.splice(d,1),v=an(F.length,E&&E.length||0)}},z=function(h,d,k,j,i){h&&d&&h[i][0]=="M"&&d[i][0]!="M"&&(d.splice(i,0,["M",j.x,j.y]),k.bx=0,k.by=0,k.x=h[i][1],k.y=h[i][2],v=an(F.length,E&&E.length||0))};for(var w=0,v=an(F.length,E&&E.length||0);w<v;w++){F[w]=B(F[w],D),A(F,w),E&&(E[w]=B(E[w],C)),E&&A(E,w),z(F,E,D,C,w),z(E,F,C,D,w);var u=F[w],t=E&&E[w],r=u.length,n=E&&t.length;D.x=u[r-2],D.y=u[r-1],D.bx=cG(u[r-4])||D.x,D.by=cG(u[r-3])||D.y,C.bx=E&&(cG(t[n-4])||C.x),C.by=E&&(cG(t[n-3])||C.y),C.x=E&&t[n-2],C.y=E&&t[n-1]}return E?[F,E]:F},null,aQ),di=a2._parseDots=a1(function(v){var u=[];for(var t=0,r=v.length;t<r;t++){var q={},p=v[t].match(/^([^:]*):?([\d\.]*)/);q.color=a2.getRGB(p[1]);if(q.color.error){return null}q.color=q.color.hex,p[2]&&(q.offset=p[2]+"%"),u.push(q)}for(t=1,r=u.length-1;t<r;t++){if(!u[t].offset){var o=cG(u[t-1].offset||0),n=0;for(var l=t+1;l<r;l++){if(u[l].offset){n=u[l].offset;break}}n||(n=100,l=r),n=cG(n);var a=(n-o)/(l-t+1);for(;t<l;t++){o+=a,u[t].offset=o+"%"}}}return u}),dh=a2._tear=function(e,d){e==d.top&&(d.top=e.prev),e==d.bottom&&(d.bottom=e.next),e.next&&(e.next.prev=e.prev),e.prev&&(e.prev.next=e.next)},dg=a2._tofront=function(e,d){d.top!==e&&(dh(e,d),e.next=null,e.prev=d.top,d.top.next=e,d.top=e)},df=a2._toback=function(e,d){d.bottom!==e&&(dh(e,d),e.next=d.bottom,e.prev=null,d.bottom.prev=e,d.bottom=e)},de=a2._insertafter=function(e,d,f){dh(e,f),d==f.top&&(f.top=e),d.next&&(d.next.prev=e),e.next=d.next,e.prev=d,d.next=e},dd=a2._insertbefore=function(e,d,f){dh(e,f),d==f.bottom&&(f.bottom=e),d.prev&&(d.prev.next=e),e.prev=d.prev,d.prev=e,e.next=d},dc=a2._extractTransform=function(S,R){if(R==null){return S._.transform}R=aA(R).replace(/\.{3}|\u2026/g,S._.transform||aD);var Q=a2.parseTransformString(R),P=0,O=0,N=0,M=1,L=1,J=S._,I=new c9;J.transform=Q||[];if(Q){for(var H=0,G=Q.length;H<G;H++){var F=Q[H],E=F.length,D=aA(F[0]).toLowerCase(),C=F[0]!=D,B=C?I.invert():0,A,z,r,p,a;D=="t"&&E==3?C?(A=B.x(0,0),z=B.y(0,0),r=B.x(F[1],F[2]),p=B.y(F[1],F[2]),I.translate(r-A,p-z)):I.translate(F[1],F[2]):D=="r"?E==2?(a=a||S.getBBox(1),I.rotate(F[1],a.x+a.width/2,a.y+a.height/2),P+=F[1]):E==4&&(C?(r=B.x(F[2],F[3]),p=B.y(F[2],F[3]),I.rotate(F[1],r,p)):I.rotate(F[1],F[2],F[3]),P+=F[1]):D=="s"?E==2||E==3?(a=a||S.getBBox(1),I.scale(F[1],F[E-1],a.x+a.width/2,a.y+a.height/2),M*=F[1],L*=F[E-1]):E==5&&(C?(r=B.x(F[3],F[4]),p=B.y(F[3],F[4]),I.scale(F[1],F[2],r,p)):I.scale(F[1],F[2],F[3],F[4]),M*=F[1],L*=F[2]):D=="m"&&E==7&&I.add(F[1],F[2],F[3],F[4],F[5],F[6]),J.dirtyT=1,S.matrix=I}}S.matrix=I,J.sx=M,J.sy=L,J.deg=P,J.dx=O=I.e,J.dy=N=I.f,M==1&&L==1&&!P&&J.bbox?(J.bbox.x+=+O,J.bbox.y+=+N):J.dirtyT=1},db=function(e){var d=e[0];switch(d.toLowerCase()){case"t":return[d,0,0];case"m":return[d,1,0,0,1,0,0];case"r":return e.length==4?[d,0,e[2],e[3]]:[d,0];case"s":return e.length==5?[d,1,1,e[3],e[4]]:e.length==3?[d,1,1]:[d,1]}},da=a2._equaliseTransform=function(v,u){u=aA(u).replace(/\.{3}|\u2026/g,v),v=a2.parseTransformString(v)||[],u=a2.parseTransformString(u)||[];var t=an(v.length,u.length),r=[],q=[],p=0,o,n,l,a;for(;p<t;p++){l=v[p]||db(u[p]),a=u[p]||db(l);if(l[0]!=a[0]||l[0].toLowerCase()=="r"&&(l[2]!=a[2]||l[3]!=a[3])||l[0].toLowerCase()=="s"&&(l[3]!=a[3]||l[4]!=a[4])){return}r[p]=[],q[p]=[];for(o=0,n=an(l.length,a.length);o<n;o++){o in l&&(r[p][o]=l[o]),o in a&&(q[p][o]=a[o])}}return{from:r,to:q}};a2._getContainer=function(a,j,i,h){var g;g=h==null&&!a2.is(a,"object")?aP.doc.getElementById(a):a;if(g!=null){if(g.tagName){return j==null?{container:g,width:g.style.pixelWidth||g.offsetWidth,height:g.style.pixelHeight||g.offsetHeight}:{container:g,width:j,height:i}}return{container:1,x:a,y:j,width:i,height:h}}},a2.pathToRelative=aO,a2._engine={},a2.path2curve=dj,a2.matrix=function(h,g,l,k,j,i){return new c9(h,g,l,k,j,i)},function(a){function e(g){var d=ap.sqrt(f(g));g[0]&&(g[0]/=d),g[1]&&(g[1]/=d)}function f(b){return b[0]*b[0]+b[1]*b[1]}a.add=function(C,B,A,z,w,v){var u=[[],[],[]],t=[[this.a,this.c,this.e],[this.b,this.d,this.f],[0,0,1]],r=[[C,A,w],[B,z,v],[0,0,1]],q,p,o,n;C&&C instanceof c9&&(r=[[C.a,C.c,C.e],[C.b,C.d,C.f],[0,0,1]]);for(q=0;q<3;q++){for(p=0;p<3;p++){n=0;for(o=0;o<3;o++){n+=t[q][o]*r[o][p]}u[q][p]=n}}this.a=u[0][0],this.b=u[1][0],this.c=u[0][1],this.d=u[1][1],this.e=u[0][2],this.f=u[1][2]},a.invert=function(){var g=this,d=g.a*g.d-g.b*g.c;return new c9(g.d/d,-g.b/d,-g.c/d,g.a/d,(g.c*g.f-g.d*g.e)/d,(g.b*g.e-g.a*g.f)/d)},a.clone=function(){return new c9(this.a,this.b,this.c,this.d,this.e,this.f)},a.translate=function(g,d){this.add(1,0,0,1,g,d)},a.scale=function(h,g,j,i){g==null&&(g=h),(j||i)&&this.add(1,0,0,1,j,i),this.add(h,0,0,g,0,0),(j||i)&&this.add(1,0,0,1,-j,-i)},a.rotate=function(g,k,j){g=a2.rad(g),k=k||0,j=j||0;var i=+ap.cos(g).toFixed(9),h=+ap.sin(g).toFixed(9);this.add(i,h,-h,i,k,j),this.add(1,0,0,1,-k,-j)},a.x=function(g,d){return g*this.a+d*this.c+this.e},a.y=function(g,d){return g*this.b+d*this.d+this.f},a.get=function(b){return +this[aA.fromCharCode(97+b)].toFixed(4)},a.toString=function(){return a2.svg?"matrix("+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)].join()+")":[this.get(0),this.get(2),this.get(1),this.get(3),0,0].join()},a.toFilter=function(){return"progid:DXImageTransform.Microsoft.Matrix(M11="+this.get(0)+", M12="+this.get(2)+", M21="+this.get(1)+", M22="+this.get(3)+", Dx="+this.get(4)+", Dy="+this.get(5)+", sizingmethod='auto expand')"},a.offset=function(){return[this.e.toFixed(4),this.f.toFixed(4)]},a.split=function(){var d={};d.dx=this.e,d.dy=this.f;var j=[[this.a,this.c],[this.b,this.d]];d.scalex=ap.sqrt(f(j[0])),e(j[0]),d.shear=j[0][0]*j[1][0]+j[0][1]*j[1][1],j[1]=[j[1][0]-j[0][0]*d.shear,j[1][1]-j[0][1]*d.shear],d.scaley=ap.sqrt(f(j[1])),e(j[1]),d.shear/=d.scaley;var i=-j[0][1],h=j[1][1];h<0?(d.rotate=a2.deg(ap.acos(h)),i<0&&(d.rotate=360-d.rotate)):d.rotate=a2.deg(ap.asin(i)),d.isSimple=!+d.shear.toFixed(9)&&(d.scalex.toFixed(9)==d.scaley.toFixed(9)||!d.rotate),d.isSuperSimple=!+d.shear.toFixed(9)&&d.scalex.toFixed(9)==d.scaley.toFixed(9)&&!d.rotate,d.noRotation=!+d.shear.toFixed(9)&&!d.rotate;return d},a.toTransformString=function(g){var d=g||this[ay]();if(d.isSimple){d.scalex=+d.scalex.toFixed(4),d.scaley=+d.scaley.toFixed(4),d.rotate=+d.rotate.toFixed(4);return(d.dx&&d.dy?"t"+[d.dx,d.dy]:aD)+(d.scalex!=1||d.scaley!=1?"s"+[d.scalex,d.scaley,0,0]:aD)+(d.rotate?"r"+[d.rotate,0,0]:aD)}return"m"+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)]}}(c9.prototype);var c8=navigator.userAgent.match(/Version\/(.*?)\s/)||navigator.userAgent.match(/Chrome\/(\d+)/);navigator.vendor=="Apple Computer, Inc."&&(c8&&c8[1]<4||navigator.platform.slice(0,2)=="iP")||navigator.vendor=="Google Inc."&&c8&&c8[1]<8?aL.safari=function(){var b=this.rect(-99,-99,this.width+99,this.height+99).attr({stroke:"none"});setTimeout(function(){b.remove()})}:aL.safari=cD;var c6=function(){this.returnValue=!1},c4=function(){return this.originalEvent.preventDefault()},c2=function(){this.cancelBubble=!0},c0=function(){return this.originalEvent.stopPropagation()},cY=function(){if(aP.doc.addEventListener){return function(h,g,l,k){var j=aG&&au[g]?au[g]:g,i=function(r){var q=aP.doc.documentElement.scrollTop||aP.doc.body.scrollTop,p=aP.doc.documentElement.scrollLeft||aP.doc.body.scrollLeft,o=r.clientX+p,d=r.clientY+q;if(aG&&au[aR](g)){for(var b=0,a=r.targetTouches&&r.targetTouches.length;b<a;b++){if(r.targetTouches[b].target==h){var t=r;r=r.targetTouches[b],r.originalEvent=t,r.preventDefault=c4,r.stopPropagation=c0;break}}}return l.call(k,r,o,d)};h.addEventListener(j,i,!1);return function(){h.removeEventListener(j,i,!1);return !0}}}if(aP.doc.attachEvent){return function(h,g,l,k){var j=function(n){n=n||aP.win.event;var d=aP.doc.documentElement.scrollTop||aP.doc.body.scrollTop,q=aP.doc.documentElement.scrollLeft||aP.doc.body.scrollLeft,p=n.clientX+q,o=n.clientY+d;n.preventDefault=n.preventDefault||c6,n.stopPropagation=n.stopPropagation||c2;return l.call(k,n,p,o)};h.attachEvent("on"+g,j);var i=function(){h.detachEvent("on"+g,j);return !0};return i}}}(),cW=[],cU=function(E){var D=E.clientX,C=E.clientY,B=aP.doc.documentElement.scrollTop||aP.doc.body.scrollTop,A=aP.doc.documentElement.scrollLeft||aP.doc.body.scrollLeft,z,w=cW.length;while(w--){z=cW[w];if(aG){var v=E.touches.length,u;while(v--){u=E.touches[v];if(u.identifier==z.el._drag.id){D=u.clientX,C=u.clientY,(E.originalEvent?E.originalEvent:E).preventDefault();break}}}else{E.preventDefault()}var t=z.el.node,r,q=t.nextSibling,o=t.parentNode,h=t.style.display;aP.win.opera&&o.removeChild(t),t.style.display="none",r=z.el.paper.getElementByPoint(D,C),t.style.display=h,aP.win.opera&&(q?o.insertBefore(t,q):o.appendChild(t)),r&&eve("drag.over."+z.el.id,z.el,r),D+=A,C+=B,eve("drag.move."+z.el.id,z.move_scope||z.el,D-z.el._drag.x,C-z.el._drag.y,D,C,E)}},cS=function(a){a2.unmousemove(cU).unmouseup(cS);var f=cW.length,e;while(f--){e=cW[f],e.el._drag={},eve("drag.end."+e.el.id,e.end_scope||e.start_scope||e.move_scope||e.el,a)}cW=[]},ds=a2.el={};for(var cM=aw.length;cM--;){(function(a){a2[a]=ds[a]=function(e,b){a2.is(e,"function")&&(this.events=this.events||[],this.events.push({name:a,f:e,unbind:cY(this.shape||this.node||aP.doc,a,e,b||this)}));return this},a2["un"+a]=ds["un"+a]=function(b){var f=this.events,e=f.length;while(e--){if(f[e].name==a&&f[e].f==b){f[e].unbind(),f.splice(e,1),!f.length&&delete this.events;return this}}return this}})(aw[cM])}ds.data=function(a,h){var g=cJ[this.id]=cJ[this.id]||{};if(arguments.length==1){if(a2.is(a,"object")){for(var f in a){a[aR](f)&&this.data(f,a[f])}return this}eve("data.get."+this.id,this,g[a],a);return g[a]}g[a]=h,eve("data.set."+this.id,this,h,a);return this},ds.removeData=function(b){b==null?cJ[this.id]={}:cJ[this.id]&&delete cJ[this.id][b];return this},ds.hover=function(f,e,h,g){return this.mouseover(f,h).mouseout(e,g||h)},ds.unhover=function(e,d){return this.unmouseover(e).unmouseout(d)};var aH=[];ds.drag=function(a,o,n,l,k,j){function h(e){(e.originalEvent||e).preventDefault();var d=aP.doc.documentElement.scrollTop||aP.doc.body.scrollTop,b=aP.doc.documentElement.scrollLeft||aP.doc.body.scrollLeft;this._drag.x=e.clientX+b,this._drag.y=e.clientY+d,this._drag.id=e.identifier,!cW.length&&a2.mousemove(cU).mouseup(cS),cW.push({el:this,move_scope:l,start_scope:k,end_scope:j}),o&&eve.on("drag.start."+this.id,o),a&&eve.on("drag.move."+this.id,a),n&&eve.on("drag.end."+this.id,n),eve("drag.start."+this.id,k||l||this,e.clientX+b,e.clientY+d,e)}this._drag={},aH.push({el:this,start:h}),this.mousedown(h);return this},ds.onDragOver=function(b){b?eve.on("drag.over."+this.id,b):eve.unbind("drag.over."+this.id)},ds.undrag=function(){var a=aH.length;while(a--){aH[a].el==this&&(this.unmousedown(aH[a].start),aH.splice(a,1),eve.unbind("drag.*."+this.id))}!aH.length&&a2.unmousemove(cU).unmouseup(cS)},aL.circle=function(a,h,g){var f=a2._engine.circle(this,a||0,h||0,g||0);this.__set__&&this.__set__.push(f);return f},aL.rect=function(a,l,k,j,i){var h=a2._engine.rect(this,a||0,l||0,k||0,j||0,i||0);this.__set__&&this.__set__.push(h);return h},aL.ellipse=function(a,j,i,h){var g=a2._engine.ellipse(this,a||0,j||0,i||0,h||0);this.__set__&&this.__set__.push(g);return g},aL.path=function(a){a&&!a2.is(a,c1)&&!a2.is(a[0],cZ)&&(a+=aD);var d=a2._engine.path(a2.format[aJ](a2,arguments),this);this.__set__&&this.__set__.push(d);return d},aL.image=function(a,l,k,j,i){var h=a2._engine.image(this,a||"about:blank",l||0,k||0,j||0,i||0);this.__set__&&this.__set__.push(h);return h},aL.text=function(a,h,g){var f=a2._engine.text(this,a||0,h||0,aA(g));this.__set__&&this.__set__.push(f);return f},aL.set=function(a){!a2.is(a,"array")&&(a=Array.prototype.splice.call(arguments,0,arguments.length));var d=new ac(a);this.__set__&&this.__set__.push(d);return d},aL.setStart=function(b){this.__set__=b||this.set()},aL.setFinish=function(e){var d=this.__set__;delete this.__set__;return d},aL.setSize=function(a,d){return a2._engine.setSize.call(this,a,d)},aL.setViewBox=function(a,j,i,h,g){return a2._engine.setViewBox.call(this,a,j,i,h,g)},aL.top=aL.bottom=null,aL.raphael=a2;var aF=function(t){var r=t.getBoundingClientRect(),q=t.ownerDocument,p=q.body,o=q.documentElement,n=o.clientTop||p.clientTop||0,l=o.clientLeft||p.clientLeft||0,k=r.top+(aP.win.pageYOffset||o.scrollTop||p.scrollTop)-n,h=r.left+(aP.win.pageXOffset||o.scrollLeft||p.scrollLeft)-l;return{y:k,x:h}};aL.getElementByPoint=function(j,h){var q=this,p=q.canvas,o=aP.doc.elementFromPoint(j,h);if(aP.win.opera&&o.tagName=="svg"){var n=aF(p),l=p.createSVGRect();l.x=j-n.x,l.y=h-n.y,l.width=l.height=1;var k=p.getIntersectionList(l,null);k.length&&(o=k[k.length-1])}if(!o){return null}while(o.parentNode&&o!=p.parentNode&&!o.raphael){o=o.parentNode}o==q.canvas.parentNode&&(o=p),o=o&&o.raphael?q.getById(o.raphaelid):null;return o},aL.getById=function(e){var d=this.bottom;while(d){if(d.id==e){return d}d=d.next}return null},aL.forEach=function(e,d){var f=this.bottom;while(f){if(e.call(d,f)===!1){return this}f=f.next}return this},ds.getBBox=function(e){if(this.removed){return{}}var d=this._;if(e){if(d.dirty||!d.bboxwt){this.realPath=b9[this.type](this),d.bboxwt=aS(this.realPath),d.bboxwt.toString=aC,d.dirty=0}return d.bboxwt}if(d.dirty||d.dirtyT||!d.bbox){if(d.dirty||!this.realPath){d.bboxwt=0,this.realPath=b9[this.type](this)}d.bbox=aS(b7(this.realPath,this.matrix)),d.bbox.toString=aC,d.dirty=d.dirtyT=0}return d.bbox},ds.clone=function(){if(this.removed){return null}var b=this.paper[this.type]().attr(this.attr());this.__set__&&this.__set__.push(b);return b},ds.glow=function(i){if(this.type=="text"){return null}i=i||{};var h={width:(i.width||10)+(+this.attr("stroke-width")||1),fill:i.fill||!1,opacity:i.opacity||0.5,offsetx:i.offsetx||0,offsety:i.offsety||0,color:i.color||"#000"},o=h.width/2,n=this.paper,l=n.set(),k=this.realPath||b9[this.type](this);k=this.matrix?b7(k,this.matrix):k;for(var j=1;j<o+1;j++){l.push(n.path(k).attr({stroke:h.color,fill:h.fill?h.color:"none","stroke-linejoin":"round","stroke-linecap":"round","stroke-width":+(h.width/o*j).toFixed(3),opacity:+(h.opacity/o).toFixed(3)}))}return l.insertBefore(this).translate(h.offsetx,h.offsety)};var az={},ax=function(L,J,I,H,G,F,E,D,C){var B=0,A=100,z=[L,J,I,H,G,F,E,D].join(),w=az[z],v,u;!w&&(az[z]=w={data:[]}),w.timer&&clearTimeout(w.timer),w.timer=setTimeout(function(){delete az[z]},2000);if(C!=null&&!w.precision){var t=ax(L,J,I,H,G,F,E,D);w.precision=~~t*10,w.data=[]}A=w.precision||A;for(var a=0;a<A+1;a++){w.data[a*A]?u=w.data[a*A]:(u=a2.findDotsAtSegment(L,J,I,H,G,F,E,D,a/A),w.data[a*A]=u),a&&(B+=c7(c7(v.x-u.x,2)+c7(v.y-u.y,2),0.5));if(C!=null&&B>=C){return u}v=u}if(C==null){return B}},av=function(a,d){return function(E,D,C){E=dj(E);var B,A,z,w,v="",u={},t,r=0;for(var q=0,b=E.length;q<b;q++){z=E[q];if(z[0]=="M"){B=+z[1],A=+z[2]}else{w=ax(B,A,z[1],z[2],z[3],z[4],z[5],z[6]);if(r+w>D){if(d&&!u.start){t=ax(B,A,z[1],z[2],z[3],z[4],z[5],z[6],D-r),v+=["C"+t.start.x,t.start.y,t.m.x,t.m.y,t.x,t.y];if(C){return v}u.start=v,v=["M"+t.x,t.y+"C"+t.n.x,t.n.y,t.end.x,t.end.y,z[5],z[6]].join(),r+=w,B=+z[5],A=+z[6];continue}if(!a&&!d){t=ax(B,A,z[1],z[2],z[3],z[4],z[5],z[6],D-r);return{x:t.x,y:t.y,alpha:t.alpha}}}r+=w,B=+z[5],A=+z[6]}v+=z.shift()+z}u.end=v,t=a?r:d?u:a2.findDotsAtSegment(B,A,z[0],z[1],z[2],z[3],z[4],z[5],1),t.alpha&&(t={x:t.x,y:t.y,alpha:t.alpha});return t}},at=av(1),aq=av(),ao=av(0,1);a2.getTotalLength=at,a2.getPointAtLength=aq,a2.getSubpath=function(f,e,h){if(this.getTotalLength(f)-h<0.000001){return ao(f,e).end}var g=ao(f,h,1);return e?ao(g,e).end:g},ds.getTotalLength=function(){if(this.type=="path"){if(this.node.getTotalLength){return this.node.getTotalLength()}return at(this.attrs.path)}},ds.getPointAtLength=function(b){if(this.type=="path"){return aq(this.attrs.path,b)}},ds.getSubpath=function(a,d){if(this.type=="path"){return a2.getSubpath(this.attrs.path,a,d)}};var am=a2.easing_formulas={linear:function(b){return b},"<":function(b){return c7(b,1.7)},">":function(b){return c7(b,0.48)},"<>":function(j){var i=0.48-j/1.04,q=ap.sqrt(0.1734+i*i),p=q-i,o=c7(aj(p),1/3)*(p<0?-1:1),n=-q-i,l=c7(aj(n),1/3)*(n<0?-1:1),k=o+l+0.5;return(1-k)*3*k*k+k*k*k},backIn:function(e){var d=1.70158;return e*e*((d+1)*e-d)},backOut:function(e){e=e-1;var d=1.70158;return e*e*((d+1)*e+d)+1},elastic:function(b){if(b==!!b){return b}return c7(2,-10*b)*ap.sin((b-0.075)*2*c5/0.3)+1},bounce:function(f){var e=7.5625,h=2.75,g;f<1/h?g=e*f*f:f<2/h?(f-=1.5/h,g=e*f*f+0.75):f<2.5/h?(f-=2.25/h,g=e*f*f+0.9375):(f-=2.625/h,g=e*f*f+0.984375);return g}};am.easeIn=am["ease-in"]=am["<"],am.easeOut=am["ease-out"]=am[">"],am.easeInOut=am["ease-in-out"]=am["<>"],am["back-in"]=am.backIn,am["back-out"]=am.backOut;var ak=[],ai=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(b){setTimeout(b,16)},ah=function(){var U=+(new Date),T=0;for(;T<ak.length;T++){var S=ak[T];if(S.el.removed||S.paused){continue}var R=U-S.start,Q=S.ms,P=S.easing,O=S.from,N=S.diff,M=S.to,L=S.t,J=S.el,I={},H,F={},E;S.initstatus?(R=(S.initstatus*S.anim.top-S.prev)/(S.percent-S.prev)*Q,S.status=S.initstatus,delete S.initstatus,S.stop&&ak.splice(T--,1)):S.status=(S.prev+(S.percent-S.prev)*(R/Q))/S.anim.top;if(R<0){continue}if(R<Q){var D=P(R/Q);for(var C in O){if(O[aR](C)){switch(cx[C]){case c3:H=+O[C]+D*Q*N[C];break;case"colour":H="rgb("+[ag(cK(O[C].r+D*Q*N[C].r)),ag(cK(O[C].g+D*Q*N[C].g)),ag(cK(O[C].b+D*Q*N[C].b))].join(",")+")";break;case"path":H=[];for(var B=0,q=O[C].length;B<q;B++){H[B]=[O[C][B][0]];for(var n=1,g=O[C][B].length;n<g;n++){H[B][n]=+O[C][B][n]+D*Q*N[C][B][n]}H[B]=H[B].join(aB)}H=H.join(aB);break;case"transform":if(N[C].real){H=[];for(B=0,q=O[C].length;B<q;B++){H[B]=[O[C][B][0]];for(n=1,g=O[C][B].length;n<g;n++){H[B][n]=O[C][B][n]+D*Q*N[C][B][n]}}}else{var a=function(b){return +O[C][b]+D*Q*N[C][b]};H=[["m",a(0),a(1),a(2),a(3),a(4),a(5)]]}break;case"csv":if(C=="clip-rect"){H=[],B=4;while(B--){H[B]=+O[C][B]+D*Q*N[C][B]}}break;default:var G=[][aI](O[C]);H=[],B=J.paper.customAttributes[C].length;while(B--){H[B]=+G[B]+D*Q*N[C][B]}}I[C]=H}}J.attr(I),function(e,d,f){setTimeout(function(){eve("anim.frame."+e,d,f)})}(J.id,J,S.anim)}else{(function(e,h,f){setTimeout(function(){eve("anim.frame."+h.id,h,f),eve("anim.finish."+h.id,h,f),a2.is(e,"function")&&e.call(h)})})(S.callback,J,S.anim),J.attr(M),ak.splice(T--,1);if(S.repeat>1&&!S.next){for(E in M){M[aR](E)&&(F[E]=S.totalOrigin[E])}S.el.attr(F),ad(S.anim,S.el,S.anim.percents[0],null,S.totalOrigin,S.repeat-1)}S.next&&!S.stop&&ad(S.anim,S.el,S.next,null,S.totalOrigin,S.repeat)}}a2.svg&&J&&J.paper&&J.paper.safari(),ak.length&&ai(ah)},ag=function(b){return b>255?255:b<0?0:b};ds.animateWith=function(a,q,p,o,n,l){var k=p?a2.animation(p,o,n,l):q,j=a.status(q);return this.animate(k).status(k,j*q.ms/k.ms)},ds.onAnimation=function(b){b?eve.on("anim.frame."+this.id,b):eve.unbind("anim.frame."+this.id);return this},ae.prototype.delay=function(e){var d=new ae(this.anim,this.ms);d.times=this.times,d.del=+e||0;return d},ae.prototype.repeat=function(e){var d=new ae(this.anim,this.ms);d.del=this.del,d.times=ap.floor(an(e,0))||1;return d},a2.animation=function(a,o,n,l){if(a instanceof ae){return a}if(a2.is(n,"function")||!n){l=l||n||null,n=null}a=Object(a),o=+o||0;var k={},j,g;for(g in a){a[aR](g)&&cG(g)!=g&&cG(g)+"%"!=g&&(j=!0,k[g]=a[g])}if(!j){return new ae(a,o)}n&&(k.easing=n),l&&(k.callback=l);return new ae({100:k},o)},ds.animate=function(a,l,k,j){var i=this;if(i.removed){j&&j.call(i);return i}var h=a instanceof ae?a:a2.animation(a,l,k,j);ad(h,i,h.percents[0],null,i.attr());return i},ds.setTime=function(e,d){e&&d!=null&&this.status(e,al(d,e.ms)/e.ms);return this},ds.status=function(h,g){var l=[],k=0,j,i;if(g!=null){ad(h,this,-1,al(g,1));return this}j=ak.length;for(;k<j;k++){i=ak[k];if(i.el.id==this.id&&(!h||i.anim==h)){if(h){return i.status}l.push({anim:i.anim,status:i.status})}}if(h){return 0}return l},ds.pause=function(e){for(var d=0;d<ak.length;d++){ak[d].el.id==this.id&&(!e||ak[d].anim==e)&&eve("anim.pause."+this.id,this,ak[d].anim)!==!1&&(ak[d].paused=!0)}return this},ds.resume=function(e){for(var d=0;d<ak.length;d++){if(ak[d].el.id==this.id&&(!e||ak[d].anim==e)){var f=ak[d];eve("anim.resume."+this.id,this,f.anim)!==!1&&(delete f.paused,this.status(f.anim,f.status))}}return this},ds.stop=function(e){for(var d=0;d<ak.length;d++){ak[d].el.id==this.id&&(!e||ak[d].anim==e)&&eve("anim.stop."+this.id,this,ak[d].anim)!==!1&&ak.splice(d--,1)}return this},ds.toString=function(){return"Raphaël’s object"};var ac=function(e){this.items=[],this.length=0,this.type="set";if(e){for(var d=0,f=e.length;d<f;d++){e[d]&&(e[d].constructor==ds.constructor||e[d].constructor==ac)&&(this[this.items.length]=this.items[this.items.length]=e[d],this.length++)}}},ab=ac.prototype;ab.push=function(){var f,e;for(var h=0,g=arguments.length;h<g;h++){f=arguments[h],f&&(f.constructor==ds.constructor||f.constructor==ac)&&(e=this.items.length,this[e]=this.items[e]=f,this.length++)}return this},ab.pop=function(){this.length&&delete this[this.length--];return this.items.pop()},ab.forEach=function(f,e){for(var h=0,g=this.items.length;h<g;h++){if(f.call(e,this.items[h],h)===!1){return this}}return this};for(var aa in ds){ds[aR](aa)&&(ab[aa]=function(b){return function(){var a=arguments;return this.forEach(function(d){d[b][aJ](d,a)})}}(aa))}ab.attr=function(a,l){if(a&&a2.is(a,cZ)&&a2.is(a[0],"object")){for(var k=0,j=a.length;k<j;k++){this.items[k].attr(a[k])}}else{for(var i=0,h=this.items.length;i<h;i++){this.items[i].attr(a,l)}}return this},ab.clear=function(){while(this.length){this.pop()}},ab.splice=function(j,i,q){j=j<0?an(this.length+j,0):j,i=an(0,al(this.length-j,i));var p=[],o=[],n=[],l;for(l=2;l<arguments.length;l++){n.push(arguments[l])}for(l=0;l<i;l++){o.push(this[j+l])}for(;l<this.length-j;l++){p.push(this[j+l])}var k=n.length;for(l=0;l<k+p.length;l++){this.items[j+l]=this[j+l]=l<k?n[l]:p[l-k]}l=this.items.length=this.length-=i-k;while(this[l]){delete this[l++]}return new ac(o)},ab.exclude=function(e){for(var d=0,f=this.length;d<f;d++){if(this[d]==e){this.splice(d,1);return !0}}},ab.animate=function(v,u,t,r){(a2.is(t,"function")||!t)&&(r=t||null);var q=this.items.length,p=q,o,n=this,l;if(!q){return this}r&&(l=function(){!--q&&r.call(n)}),t=a2.is(t,c1)?t:l;var a=a2.animation(v,u,t,l);o=this.items[--p].animate(a);while(p--){this.items[p]&&!this.items[p].removed&&this.items[p].animateWith(o,a)}return this},ab.insertAfter=function(e){var d=this.items.length;while(d--){this.items[d].insertAfter(e)}return this},ab.getBBox=function(){var h=[],g=[],l=[],k=[];for(var j=this.items.length;j--;){if(!this.items[j].removed){var i=this.items[j].getBBox();h.push(i.x),g.push(i.y),l.push(i.x+i.width),k.push(i.y+i.height)}}h=al[aJ](0,h),g=al[aJ](0,g);return{x:h,y:g,width:an[aJ](0,l)-h,height:an[aJ](0,k)-g}},ab.clone=function(e){e=new ac;for(var d=0,f=this.items.length;d<f;d++){e.push(this.items[d].clone())}return e},ab.toString=function(){return"Raphaël‘s set"},a2.registerFont=function(i){if(!i.face){return i}this.fonts=this.fonts||{};var g={w:i.w,face:{},glyphs:{}},o=i.face["font-family"];for(var n in i.face){i.face[aR](n)&&(g.face[n]=i.face[n])}this.fonts[o]?this.fonts[o].push(g):this.fonts[o]=[g];if(!i.svg){g.face["units-per-em"]=cE(i.face["units-per-em"],10);for(var l in i.glyphs){if(i.glyphs[aR](l)){var k=i.glyphs[l];g.glyphs[l]={w:k.w,k:{},d:k.d&&"M"+k.d.replace(/[mlcxtrv]/g,function(b){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[b]||"M"})+"z"};if(k.k){for(var j in k.k){k[aR](j)&&(g.glyphs[l].k[j]=k.k[j])}}}}}return i},aL.getFont=function(v,u,t,r){r=r||"normal",t=t||"normal",u=+u||{normal:400,bold:700,lighter:300,bolder:800}[u]||400;if(!!a2.fonts){var q=a2.fonts[v];if(!q){var p=new RegExp("(^|\\s)"+v.replace(/[^\w\d\s+!~.:_-]/g,aD)+"(\\s|$)","i");for(var o in a2.fonts){if(a2.fonts[aR](o)&&p.test(o)){q=a2.fonts[o];break}}}var n;if(q){for(var g=0,a=q.length;g<a;g++){n=q[g];if(n.face["font-weight"]==u&&(n.face["font-style"]==t||!n.face["font-style"])&&n.face["font-stretch"]==r){break}}}return n}},aL.print=function(Q,P,O,N,M,L,J){L=L||"middle",J=an(al(J||0,1),-1);var I=this.set(),H=aA(O)[ay](aD),G=0,F=aD,E;a2.is(N,O)&&(N=this.getFont(N));if(N){E=(M||16)/N.face["units-per-em"];var D=N.face.bbox[ay](aZ),C=+D[0],B=+D[1]+(L=="baseline"?D[3]-D[1]+ +N.face.descent:(D[3]-D[1])/2);for(var A=0,r=H.length;A<r;A++){var p=A&&N.glyphs[H[A-1]]||{},a=N.glyphs[H[A]];G+=A?(p.w||N.w)+(p.k&&p.k[H[A]]||0)+N.w*J:0,a&&a.d&&I.push(this.path(a.d).attr({fill:"#000",stroke:"none",transform:[["t",G*E,0]]}))}I.transform(["...s",E,E,C,B,"t",(Q-C)/E,(P-B)/E])}return I},aL.add=function(a){if(a2.is(a,"array")){var j=this.set(),i=0,g=a.length,d;for(;i<g;i++){d=a[i]||{},aW[aR](d.type)&&j.push(this[d.type]().attr(d))}}return j},a2.format=function(a,f){var e=a2.is(f,cZ)?[0][aI](f):arguments;a&&a2.is(a,c1)&&e.length-1&&(a=a.replace(aU,function(g,d){return e[++d]==null?aD:e[d]}));return a||aD},a2.fullfill=function(){var e=/\{([^\}]+)\}/g,d=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g,f=function(b,i,h){var g=h;i.replace(d,function(k,j,o,n,l){j=j||n,g&&(j in g&&(g=g[j]),typeof g=="function"&&l&&(g=g()))}),g=(g==null||g==h?b:g)+"";return g};return function(a,g){return String(a).replace(e,function(i,h){return f(i,h,g)})}}(),a2.ninja=function(){aN.was?aP.win.Raphael=aN.is:delete Raphael;return a2},a2.st=ab,function(a,h,g){function f(){/in/.test(a.readyState)?setTimeout(f,9):a2.eve("DOMload")}a.readyState==null&&a.addEventListener&&(a.addEventListener(h,g=function(){a.removeEventListener(h,g,!1),a.readyState="complete"},!1),a.readyState="loading"),f()}(document,"DOMContentLoaded"),aN.was?aP.win.Raphael=a2:Raphael=a2,eve.on("DOMload",function(){a0=!0})}(),window.Raphael.svg&&function(ag){var af="hasOwnProperty",ae=String,ad=parseFloat,ac=parseInt,ab=Math,aa=ab.max,Z=ab.abs,Y=ab.pow,X=/[, ]+/,W=ag.eve,V="",U=" ",T="http://www.w3.org/1999/xlink",S={block:"M5,0 0,2.5 5,5z",classic:"M5,0 0,2.5 5,5 3.5,3 3.5,2z",diamond:"M2.5,0 5,2.5 2.5,5 0,2.5z",open:"M6,1 1,3.5 6,6",oval:"M2.5,0A2.5,2.5,0,0,1,2.5,5 2.5,2.5,0,0,1,2.5,0z"},R={};ag.toString=function(){return"Your browser supports SVG.\nYou are running Raphaël "+this.version};var P=function(g,b){if(b){typeof g=="string"&&(g=P(g));for(var a in b){b[af](a)&&(a.substring(0,6)=="xlink:"?g.setAttributeNS(T,a.substring(6),ae(b[a])):g.setAttribute(a,ae(b[a])))}}else{g=ag._g.doc.createElementNS("http://www.w3.org/2000/svg",g),g.style&&(g.style.webkitTapHighlightColor="rgba(0,0,0,0)")}return g},N=function(A,q){var l="linear",i=A.id+q,h=0.5,g=0.5,f=A.node,d=A.paper,a=f.style,ak=ag._g.doc.getElementById(i);if(!ak){q=ae(q).replace(ag._radial_gradient,function(k,j,o){l="radial";if(j&&o){h=ad(j),g=ad(o);var n=(g>0.5)*2-1;Y(h-0.5,2)+Y(g-0.5,2)>0.25&&(g=ab.sqrt(0.25-Y(h-0.5,2))*n+0.5)&&g!=0.5&&(g=g.toFixed(5)-0.00001*n)}return V}),q=q.split(/\s*\-\s*/);if(l=="linear"){var aj=q.shift();aj=-ad(aj);if(isNaN(aj)){return null}var ai=[0,0,ab.cos(ag.rad(aj)),ab.sin(ag.rad(aj))],ah=1/(aa(Z(ai[2]),Z(ai[3]))||1);ai[2]*=ah,ai[3]*=ah,ai[2]<0&&(ai[0]=-ai[2],ai[2]=0),ai[3]<0&&(ai[1]=-ai[3],ai[3]=0)}var C=ag._parseDots(q);if(!C){return null}i=i.replace(/[\(\)\s,\xb0#]/g,"_"),A.gradient&&i!=A.gradient.id&&(d.defs.removeChild(A.gradient),delete A.gradient);if(!A.gradient){ak=P(l+"Gradient",{id:i}),A.gradient=ak,P(ak,l=="radial"?{fx:h,fy:g}:{x1:ai[0],y1:ai[1],x2:ai[2],y2:ai[3],gradientTransform:A.matrix.invert()}),d.defs.appendChild(ak);for(var B=0,z=C.length;B<z;B++){ak.appendChild(P("stop",{offset:C[B].offset?C[B].offset:B?"100%":"0%","stop-color":C[B].color||"#fff"}))}}}P(f,{fill:"url(#"+i+")",opacity:1,"fill-opacity":1}),a.fill=V,a.opacity=1,a.fillOpacity=1;return 1},L=function(e){var d=e.getBBox(1);P(e.pattern,{patternTransform:e.matrix.invert()+" translate("+d.x+","+d.y+")"})},J=function(aB,aA,az){if(aB.type=="path"){var ay=ae(aA).toLowerCase().split("-"),ax=aB.paper,aw=az?"end":"start",av=aB.node,au=aB.attrs,at=au["stroke-width"],ar=ay.length,ao="classic",am,ak,ai,q,p,o=3,b=3,a=5;while(ar--){switch(ay[ar]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":ao=ay[ar];break;case"wide":b=5;break;case"narrow":b=2;break;case"long":o=5;break;case"short":o=2}}ao=="open"?(o+=2,b+=2,a+=2,ai=1,q=az?4:1,p={fill:"none",stroke:au.stroke}):(q=ai=o/2,p={fill:au.stroke,stroke:"none"}),aB._.arrows?az?(aB._.arrows.endPath&&R[aB._.arrows.endPath]--,aB._.arrows.endMarker&&R[aB._.arrows.endMarker]--):(aB._.arrows.startPath&&R[aB._.arrows.startPath]--,aB._.arrows.startMarker&&R[aB._.arrows.startMarker]--):aB._.arrows={};if(ao!="none"){var aq="raphael-marker-"+ao,ap="raphael-marker-"+aw+ao+o+b;ag._g.doc.getElementById(aq)?R[aq]++:(ax.defs.appendChild(P(P("path"),{"stroke-linecap":"round",d:S[ao],id:aq})),R[aq]=1);var an=ag._g.doc.getElementById(ap),al;an?(R[ap]++,al=an.getElementsByTagName("use")[0]):(an=P(P("marker"),{id:ap,markerHeight:b,markerWidth:o,orient:"auto",refX:q,refY:b/2}),al=P(P("use"),{"xlink:href":"#"+aq,transform:(az?" rotate(180 "+o/2+" "+b/2+") ":U)+"scale("+o/a+","+b/a+")","stroke-width":1/((o/a+b/a)/2)}),an.appendChild(al),ax.defs.appendChild(an),R[ap]=1),P(al,p);var aj=ai*(ao!="diamond"&&ao!="oval");az?(am=aB._.arrows.startdx*at||0,ak=ag.getTotalLength(au.path)-aj*at):(am=aj*at,ak=ag.getTotalLength(au.path)-(aB._.arrows.enddx*at||0)),p={},p["marker-"+aw]="url(#"+ap+")";if(ak||am){p.d=Raphael.getSubpath(au.path,am,ak)}P(av,p),aB._.arrows[aw+"Path"]=aq,aB._.arrows[aw+"Marker"]=ap,aB._.arrows[aw+"dx"]=aj,aB._.arrows[aw+"Type"]=ao,aB._.arrows[aw+"String"]=aA}else{az?(am=aB._.arrows.startdx*at||0,ak=ag.getTotalLength(au.path)-am):(am=0,ak=ag.getTotalLength(au.path)-(aB._.arrows.enddx*at||0)),aB._.arrows[aw+"Path"]&&P(av,{d:Raphael.getSubpath(au.path,am,ak)}),delete aB._.arrows[aw+"Path"],delete aB._.arrows[aw+"Marker"],delete aB._.arrows[aw+"dx"],delete aB._.arrows[aw+"Type"],delete aB._.arrows[aw+"String"]}for(p in R){if(R[af](p)&&!R[p]){var ah=ag._g.doc.getElementById(p);ah&&ah.parentNode.removeChild(ah)}}}},I={"":[0],none:[0],"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},H=function(j,i,p){i=I[ae(i).toLowerCase()];if(i){var o=j.attrs["stroke-width"]||"1",n={round:o,square:o,butt:0}[j.attrs["stroke-linecap"]||p["stroke-linecap"]]||0,l=[],k=i.length;while(k--){l[k]=i[k]*o+(k%2?1:-1)*n}P(j.node,{"stroke-dasharray":l.join(",")})}},G=function(ao,an){var am=ao.node,al=ao.attrs,ak=am.style.visibility;am.style.visibility="hidden";for(var aj in an){if(an[af](aj)){if(!ag._availableAttrs[af](aj)){continue}var ai=an[aj];al[aj]=ai;switch(aj){case"blur":ao.blur(ai);break;case"href":case"title":case"target":var q=am.parentNode;if(q.tagName.toLowerCase()!="a"){var j=P("a");q.insertBefore(j,am),j.appendChild(am),q=j}aj=="target"&&ai=="blank"?q.setAttributeNS(T,"show","new"):q.setAttributeNS(T,aj,ai);break;case"cursor":am.style.cursor=ai;break;case"transform":ao.transform(ai);break;case"arrow-start":J(ao,ai);break;case"arrow-end":J(ao,ai,1);break;case"clip-rect":var g=ae(ai).split(X);if(g.length==4){ao.clip&&ao.clip.parentNode.parentNode.removeChild(ao.clip.parentNode);var a=P("clipPath"),ah=P("rect");a.id=ag.createUUID(),P(ah,{x:g[0],y:g[1],width:g[2],height:g[3]}),a.appendChild(ah),ao.paper.defs.appendChild(a),P(am,{"clip-path":"url(#"+a.id+")"}),ao.clip=ah}if(!ai){var v=am.getAttribute("clip-path");if(v){var t=ag._g.doc.getElementById(v.replace(/(^url\(#|\)$)/g,V));t&&t.parentNode.removeChild(t),P(am,{"clip-path":V}),delete ao.clip}}break;case"path":ao.type=="path"&&(P(am,{d:ai?al.path=ag._pathToAbsolute(ai):"M0,0"}),ao._.dirty=1,ao._.arrows&&("startString" in ao._.arrows&&J(ao,ao._.arrows.startString),"endString" in ao._.arrows&&J(ao,ao._.arrows.endString,1)));break;case"width":am.setAttribute(aj,ai),ao._.dirty=1;if(al.fx){aj="x",ai=al.x}else{break}case"x":al.fx&&(ai=-al.x-(al.width||0));case"rx":if(aj=="rx"&&ao.type=="rect"){break}case"cx":am.setAttribute(aj,ai),ao.pattern&&L(ao),ao._.dirty=1;break;case"height":am.setAttribute(aj,ai),ao._.dirty=1;if(al.fy){aj="y",ai=al.y}else{break}case"y":al.fy&&(ai=-al.y-(al.height||0));case"ry":if(aj=="ry"&&ao.type=="rect"){break}case"cy":am.setAttribute(aj,ai),ao.pattern&&L(ao),ao._.dirty=1;break;case"r":ao.type=="rect"?P(am,{rx:ai,ry:ai}):am.setAttribute(aj,ai),ao._.dirty=1;break;case"src":ao.type=="image"&&am.setAttributeNS(T,"href",ai);break;case"stroke-width":if(ao._.sx!=1||ao._.sy!=1){ai/=aa(Z(ao._.sx),Z(ao._.sy))||1}ao.paper._vbSize&&(ai*=ao.paper._vbSize),am.setAttribute(aj,ai),al["stroke-dasharray"]&&H(ao,al["stroke-dasharray"],an),ao._.arrows&&("startString" in ao._.arrows&&J(ao,ao._.arrows.startString),"endString" in ao._.arrows&&J(ao,ao._.arrows.endString,1));break;case"stroke-dasharray":H(ao,ai,an);break;case"fill":var r=ae(ai).match(ag._ISURL);if(r){a=P("pattern");var n=P("image");a.id=ag.createUUID(),P(a,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1}),P(n,{x:0,y:0,"xlink:href":r[1]}),a.appendChild(n),function(d){ag._preload(r[1],function(){var f=this.offsetWidth,i=this.offsetHeight;P(d,{width:f,height:i}),P(n,{width:f,height:i}),ao.paper.safari()})}(a),ao.paper.defs.appendChild(a),am.style.fill="url(#"+a.id+")",P(am,{fill:"url(#"+a.id+")"}),ao.pattern=a,ao.pattern&&L(ao);break}var l=ag.getRGB(ai);if(!l.error){delete an.gradient,delete al.gradient,!ag.is(al.opacity,"undefined")&&ag.is(an.opacity,"undefined")&&P(am,{opacity:al.opacity}),!ag.is(al["fill-opacity"],"undefined")&&ag.is(an["fill-opacity"],"undefined")&&P(am,{"fill-opacity":al["fill-opacity"]})}else{if((ao.type=="circle"||ao.type=="ellipse"||ae(ai).charAt()!="r")&&N(ao,ai)){if("opacity" in al||"fill-opacity" in al){var h=ag._g.doc.getElementById(am.getAttribute("fill").replace(/^url\(#|\)$/g,V));if(h){var e=h.getElementsByTagName("stop");P(e[e.length-1],{"stop-opacity":("opacity" in al?al.opacity:1)*("fill-opacity" in al?al["fill-opacity"]:1)})}}al.gradient=ai,al.fill="none";break}}l[af]("opacity")&&P(am,{"fill-opacity":l.opacity>1?l.opacity/100:l.opacity});case"stroke":l=ag.getRGB(ai),am.setAttribute(aj,l.hex),aj=="stroke"&&l[af]("opacity")&&P(am,{"stroke-opacity":l.opacity>1?l.opacity/100:l.opacity}),aj=="stroke"&&ao._.arrows&&("startString" in ao._.arrows&&J(ao,ao._.arrows.startString),"endString" in ao._.arrows&&J(ao,ao._.arrows.endString,1));break;case"gradient":(ao.type=="circle"||ao.type=="ellipse"||ae(ai).charAt()!="r")&&N(ao,ai);break;case"opacity":al.gradient&&!al[af]("stroke-opacity")&&P(am,{"stroke-opacity":ai>1?ai/100:ai});case"fill-opacity":if(al.gradient){h=ag._g.doc.getElementById(am.getAttribute("fill").replace(/^url\(#|\)$/g,V)),h&&(e=h.getElementsByTagName("stop"),P(e[e.length-1],{"stop-opacity":ai}));break}default:aj=="font-size"&&(ai=ac(ai,10)+"px");var b=aj.replace(/(\-.)/g,function(d){return d.substring(1).toUpperCase()});am.style[b]=ai,ao._.dirty=1,am.setAttribute(aj,ai)}}}E(ao,an),am.style.visibility=ak},F=1.2,E=function(B,A){if(B.type=="text"&&!!(A[af]("text")||A[af]("font")||A[af]("font-size")||A[af]("x")||A[af]("y"))){var z=B.attrs,w=B.node,v=w.firstChild?ac(ag._g.doc.defaultView.getComputedStyle(w.firstChild,V).getPropertyValue("font-size"),10):10;if(A[af]("text")){z.text=A.text;while(w.firstChild){w.removeChild(w.firstChild)}var u=ae(A.text).split("\n"),t=[],q;for(var l=0,e=u.length;l<e;l++){q=P("tspan"),l&&P(q,{dy:v*F,x:z.x}),q.appendChild(ag._g.doc.createTextNode(u[l])),w.appendChild(q),t[l]=q}}else{t=w.getElementsByTagName("tspan");for(l=0,e=t.length;l<e;l++){l?P(t[l],{dy:v*F,x:z.x}):P(t[0],{dy:0})}}P(w,{x:z.x,y:z.y}),B._.dirty=1;var b=B._getBBox(),a=z.y-(b.y+b.height/2);a&&ag.is(a,"finite")&&P(t[0],{dy:a})}},D=function(a,h){var g=0,f=0;this[0]=this.node=a,a.raphael=!0,this.id=ag._oid++,a.raphaelid=this.id,this.matrix=ag.matrix(),this.realPath=null,this.paper=h,this.attrs=this.attrs||{},this._={transform:[],sx:1,sy:1,deg:0,dx:0,dy:0,dirty:1},!h.bottom&&(h.bottom=this),this.prev=h.top,h.top&&(h.top.next=this),h.top=this,this.next=null},Q=ag.el;D.prototype=Q,Q.constructor=D,ag._engine.path=function(f,e){var h=P("path");e.canvas&&e.canvas.appendChild(h);var g=new D(h,e);g.type="path",G(g,{fill:"none",stroke:"#000",path:f});return g},Q.rotate=function(g,d,i){if(this.removed){return this}g=ae(g).split(X),g.length-1&&(d=ad(g[1]),i=ad(g[2])),g=ad(g[0]),i==null&&(d=i);if(d==null||i==null){var h=this.getBBox(1);d=h.x+h.width/2,i=h.y+h.height/2}this.transform(this._.transform.concat([["r",g,d,i]]));return this},Q.scale=function(h,d,k,j){if(this.removed){return this}h=ae(h).split(X),h.length-1&&(d=ad(h[1]),k=ad(h[2]),j=ad(h[3])),h=ad(h[0]),d==null&&(d=h),j==null&&(k=j);if(k==null||j==null){var i=this.getBBox(1)}k=k==null?i.x+i.width/2:k,j=j==null?i.y+i.height/2:j,this.transform(this._.transform.concat([["s",h,d,k,j]]));return this},Q.translate=function(e,d){if(this.removed){return this}e=ae(e).split(X),e.length-1&&(d=ad(e[1])),e=ad(e[0])||0,d=+d||0,this.transform(this._.transform.concat([["t",e,d]]));return this},Q.transform=function(f){var b=this._;if(f==null){return b.transform}ag._extractTransform(this,f),this.clip&&P(this.clip,{transform:this.matrix.invert()}),this.pattern&&L(this),this.node&&P(this.node,{transform:this.matrix});if(b.sx!=1||b.sy!=1){var a=this.attrs[af]("stroke-width")?this.attrs["stroke-width"]:1;this.attr({"stroke-width":a})}return this},Q.hide=function(){!this.removed&&this.paper.safari(this.node.style.display="none");return this},Q.show=function(){!this.removed&&this.paper.safari(this.node.style.display="");return this},Q.remove=function(){if(!this.removed){var a=this.paper;a.__set__&&a.__set__.exclude(this),W.unbind("*.*."+this.id),this.gradient&&a.defs.removeChild(this.gradient),ag._tear(this,a),this.node.parentNode.removeChild(this.node);for(var d in this){this[d]=typeof this[d]=="function"?ag._removedFactory(d):null}this.removed=!0}},Q._getBBox=function(){if(this.node.style.display=="none"){this.show();var e=!0}var d={};try{d=this.node.getBBox()}catch(f){}finally{d=d||{}}e&&this.hide();return d},Q.attr=function(A,z){if(this.removed){return this}if(A==null){var w={};for(var v in this.attrs){this.attrs[af](v)&&(w[v]=this.attrs[v])}w.gradient&&w.fill=="none"&&(w.fill=w.gradient)&&delete w.gradient,w.transform=this._.transform;return w}if(z==null&&ag.is(A,"string")){if(A=="fill"&&this.attrs.fill=="none"&&this.attrs.gradient){return this.attrs.gradient}if(A=="transform"){return this._.transform}var u=A.split(X),t={};for(var r=0,q=u.length;r<q;r++){A=u[r],A in this.attrs?t[A]=this.attrs[A]:ag.is(this.paper.customAttributes[A],"function")?t[A]=this.paper.customAttributes[A].def:t[A]=ag._availableAttrs[A]}return q-1?t:t[u[0]]}if(z==null&&ag.is(A,"array")){t={};for(r=0,q=A.length;r<q;r++){t[A[r]]=this.attr(A[r])}return t}if(z!=null){var k={};k[A]=z}else{A!=null&&ag.is(A,"object")&&(k=A)}for(var j in k){W("attr."+j+"."+this.id,this,k[j])}for(j in this.paper.customAttributes){if(this.paper.customAttributes[af](j)&&k[af](j)&&ag.is(this.paper.customAttributes[j],"function")){var b=this.paper.customAttributes[j].apply(this,[].concat(k[j]));this.attrs[j]=k[j];for(var a in b){b[af](a)&&(k[a]=b[a])}}}G(this,k);return this},Q.toFront=function(){if(this.removed){return this}this.node.parentNode.tagName.toLowerCase()=="a"?this.node.parentNode.parentNode.appendChild(this.node.parentNode):this.node.parentNode.appendChild(this.node);var a=this.paper;a.top!=this&&ag._tofront(this,a);return this},Q.toBack=function(){if(this.removed){return this}var a=this.node.parentNode;a.tagName.toLowerCase()=="a"?a.parentNode.insertBefore(this.node.parentNode,this.node.parentNode.parentNode.firstChild):a.firstChild!=this.node&&a.insertBefore(this.node,this.node.parentNode.firstChild),ag._toback(this,this.paper);var d=this.paper;return this},Q.insertAfter=function(a){if(this.removed){return this}var d=a.node||a[a.length-1].node;d.nextSibling?d.parentNode.insertBefore(this.node,d.nextSibling):d.parentNode.appendChild(this.node),ag._insertafter(this,a,this.paper);return this},Q.insertBefore=function(a){if(this.removed){return this}var d=a.node||a[0].node;d.parentNode.insertBefore(this.node,d),ag._insertbefore(this,a,this.paper);return this},Q.blur=function(a){var h=this;if(+a!==0){var g=P("filter"),f=P("feGaussianBlur");h.attrs.blur=a,g.id=ag.createUUID(),P(f,{stdDeviation:+a||1.5}),g.appendChild(f),h.paper.defs.appendChild(g),h._blur=g,P(h.node,{filter:"url(#"+g.id+")"})}else{h._blur&&(h._blur.parentNode.removeChild(h._blur),delete h._blur,delete h.attrs.blur),h.node.removeAttribute("filter")}},ag._engine.circle=function(h,g,l,k){var j=P("circle");h.canvas&&h.canvas.appendChild(j);var i=new D(j,h);i.attrs={cx:g,cy:l,r:k,fill:"none",stroke:"#000"},i.type="circle",P(j,i.attrs);return i},ag._engine.rect=function(j,i,q,p,o,n){var l=P("rect");j.canvas&&j.canvas.appendChild(l);var k=new D(l,j);k.attrs={x:i,y:q,width:p,height:o,r:n||0,rx:n||0,ry:n||0,fill:"none",stroke:"#000"},k.type="rect",P(l,k.attrs);return k},ag._engine.ellipse=function(i,h,o,n,l){var k=P("ellipse");i.canvas&&i.canvas.appendChild(k);var j=new D(k,i);j.attrs={cx:h,cy:o,rx:n,ry:l,fill:"none",stroke:"#000"},j.type="ellipse",P(k,j.attrs);return j},ag._engine.image=function(j,i,q,p,o,n){var l=P("image");P(l,{x:q,y:p,width:o,height:n,preserveAspectRatio:"none"}),l.setAttributeNS(T,"href",i),j.canvas&&j.canvas.appendChild(l);var k=new D(l,j);k.attrs={x:q,y:p,width:o,height:n,src:i},k.type="image";return k},ag._engine.text=function(a,l,k,j){var i=P("text");a.canvas&&a.canvas.appendChild(i);var h=new D(i,a);h.attrs={x:l,y:k,"text-anchor":"middle",text:j,font:ag._availableAttrs.font,stroke:"none",fill:"#000"},h.type="text",G(h,h.attrs);return h},ag._engine.setSize=function(e,d){this.width=e||this.width,this.height=d||this.height,this.canvas.setAttribute("width",this.width),this.canvas.setAttribute("height",this.height),this._viewBox&&this.setViewBox.apply(this,this._viewBox);return this},ag._engine.create=function(){var t=ag._getContainer.apply(0,arguments),r=t&&t.container,q=t.x,p=t.y,o=t.width,n=t.height;if(!r){throw new Error("SVG container not found.")}var l=P("svg"),k="overflow:hidden;",a;q=q||0,p=p||0,o=o||512,n=n||342,P(l,{height:n,version:1.1,width:o,xmlns:"http://www.w3.org/2000/svg"}),r==1?(l.style.cssText=k+"position:absolute;left:"+q+"px;top:"+p+"px",ag._g.doc.body.appendChild(l),a=1):(l.style.cssText=k+"position:relative",r.firstChild?r.insertBefore(l,r.firstChild):r.appendChild(l)),r=new ag._Paper,r.width=o,r.height=n,r.canvas=l,r.clear(),r._left=r._top=0,a&&(r.renderfix=function(){}),r.renderfix();return r},ag._engine.setViewBox=function(v,u,t,r,q){W("setViewBox",this,this._viewBox,[v,u,t,r,q]);var p=aa(t/this.width,r/this.height),o=this.top,n=q?"meet":"xMinYMin",k,g;v==null?(this._vbSize&&(p=1),delete this._vbSize,k="0 0 "+this.width+U+this.height):(this._vbSize=p,k=v+U+u+U+t+U+r),P(this.canvas,{viewBox:k,preserveAspectRatio:n});while(p&&o){g="stroke-width" in o.attrs?o.attrs["stroke-width"]:1,o.attr({"stroke-width":g}),o._.dirty=1,o._.dirtyT=1,o=o.prev}this._viewBox=[v,u,t,r,!!q];return this},ag.prototype.renderfix=function(){var g=this.canvas,f=g.style,j=g.getScreenCTM()||g.createSVGMatrix(),i=-j.e%1,h=-j.f%1;if(i||h){i&&(this._left=(this._left+i)%1,f.left=this._left+"px"),h&&(this._top=(this._top+h)%1,f.top=this._top+"px")}},ag.prototype.clear=function(){ag.eve("clear",this);var a=this.canvas;while(a.firstChild){a.removeChild(a.firstChild)}this.bottom=this.top=null,(this.desc=P("desc")).appendChild(ag._g.doc.createTextNode("Created with Raphaël "+ag.version)),a.appendChild(this.desc),a.appendChild(this.defs=P("defs"))},ag.prototype.remove=function(){W("remove",this),this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas);for(var a in this){this[a]=typeof this[a]=="function"?ag._removedFactory(a):null}};var O=ag.st;for(var M in Q){Q[af](M)&&!O[af](M)&&(O[M]=function(b){return function(){var a=arguments;return this.forEach(function(d){d[b].apply(d,a)})}}(M))}}(window.Raphael),window.Raphael.vml&&function(aq){var ap="hasOwnProperty",ao=String,an=parseFloat,am=Math,al=am.round,ak=am.max,aj=am.min,ai=am.abs,ah="fill",ag=/[, ]+/,af=aq.eve,ae=" progid:DXImageTransform.Microsoft",ad=" ",ac="",ab={M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},Z=/([clmz]),?([^clmz]*)/gi,X=/ progid:\S+Blur\([^\)]+\)/g,V=/-?[^,\s-]+/g,T="position:absolute;left:0;top:0;width:1px;height:1px",R=21600,P={path:1,rect:1,image:1},N={circle:1,ellipse:1},L=function(z){var w=/[ahqstv]/ig,v=aq._pathToAbsolute;ao(z).match(w)&&(v=aq._path2curve),w=/[clmz]/g;if(v==aq._pathToAbsolute&&!ao(z).match(w)){var u=ao(z).replace(Z,function(i,h,r){var l=[],k=h.toLowerCase()=="m",j=ab[h];r.replace(V,function(b){k&&l.length==2&&(j+=l+ab[h=="m"?"l":"L"],l=[]),l.push(al(b*R))});return j+l});return u}var t=v(z),q,p;u=[];for(var o=0,n=t.length;o<n;o++){q=t[o],p=t[o][0].toLowerCase(),p=="z"&&(p="x");for(var f=1,a=q.length;f<a;f++){p+=al(q[f]*R)+(f!=a-1?",":ac)}u.push(p)}return u.join(ad)},J=function(a,h,g){var f=aq.matrix();f.rotate(-a,0.5,0.5);return{dx:f.x(h,g),dy:f.y(h,g)}},I=function(av,au,at,ar,H,G){var F=av._,E=av.matrix,D=F.fillpos,C=av.node,B=C.style,A=1,z="",w,u=R/au,n=R/at;B.visibility="hidden";if(!!au&&!!at){C.coordsize=ai(u)+ad+ai(n),B.rotation=G*(au*at<0?-1:1);if(G){var j=J(G,ar,H);ar=j.dx,H=j.dy}au<0&&(z+="x"),at<0&&(z+=" y")&&(A=-1),B.flip=z,C.coordorigin=ar*-u+ad+H*-n;if(D||F.fillsize){var i=C.getElementsByTagName(ah);i=i&&i[0],C.removeChild(i),D&&(j=J(G,E.x(D[0],D[1]),E.y(D[0],D[1])),i.position=j.dx*A+ad+j.dy*A),F.fillsize&&(i.size=F.fillsize[0]*ai(au)+ad+F.fillsize[1]*ai(at)),C.appendChild(i)}B.visibility="visible"}};aq.toString=function(){return"Your browser doesn’t support SVG. Falling down to VML.\nYou are running Raphaël "+this.version};var aa=function(w,v,u){var t=ao(v).toLowerCase().split("-"),r=u?"end":"start",q=t.length,p="classic",o="medium",n="medium";while(q--){switch(t[q]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":p=t[q];break;case"wide":case"narrow":n=t[q];break;case"long":case"short":o=t[q]}}var l=w.node.getElementsByTagName("stroke")[0];l[r+"arrow"]=p,l[r+"arrowlength"]=o,l[r+"arrowwidth"]=n},Y=function(aI,aH){aI.attrs=aI.attrs||{};var aG=aI.node,aF=aI.attrs,aE=aG.style,aD,aB=P[aI.type]&&(aH.x!=aF.x||aH.y!=aF.y||aH.width!=aF.width||aH.height!=aF.height||aH.cx!=aF.cx||aH.cy!=aF.cy||aH.rx!=aF.rx||aH.ry!=aF.ry||aH.r!=aF.r),az=N[aI.type]&&(aF.cx!=aH.cx||aF.cy!=aH.cy||aF.r!=aH.r||aF.rx!=aH.rx||aF.ry!=aH.ry),ay=aI;for(var at in aH){aH[ap](at)&&(aF[at]=aH[at])}aB&&(aF.path=aq._getPath[aI.type](aI),aI._.dirty=1),aH.href&&(aG.href=aH.href),aH.title&&(aG.title=aH.title),aH.target&&(aG.target=aH.target),aH.cursor&&(aE.cursor=aH.cursor),"blur" in aH&&aI.blur(aH.blur);if(aH.path&&aI.type=="path"||aB){aG.path=L(~ao(aF.path).toLowerCase().indexOf("r")?aq._pathToAbsolute(aF.path):aF.path),aI.type=="image"&&(aI._.fillpos=[aF.x,aF.y],aI._.fillsize=[aF.width,aF.height],I(aI,1,1,0,0,0))}"transform" in aH&&aI.transform(aH.transform);if(az){var aC=+aF.cx,aA=+aF.cy,ax=+aF.rx||+aF.r||0,aw=+aF.ry||+aF.r||0;aG.path=aq.format("ar{0},{1},{2},{3},{4},{1},{4},{1}x",al((aC-ax)*R),al((aA-aw)*R),al((aC+ax)*R),al((aA+aw)*R),al(aC*R))}if("clip-rect" in aH){var av=ao(aH["clip-rect"]).split(ag);if(av.length==4){av[2]=+av[2]+ +av[0],av[3]=+av[3]+ +av[1];var au=aG.clipRect||aq._g.doc.createElement("div"),ar=au.style;ar.clip=aq.format("rect({1}px {2}px {3}px {0}px)",av),aG.clipRect||(ar.position="absolute",ar.top=0,ar.left=0,ar.width=aI.paper.width+"px",ar.height=aI.paper.height+"px",aG.parentNode.insertBefore(au,aG),au.appendChild(aG),aG.clipRect=au)}aH["clip-rect"]||aG.clipRect&&(aG.clipRect.style.clip="auto")}if(aI.textpath){var F=aI.textpath.style;aH.font&&(F.font=aH.font),aH["font-family"]&&(F.fontFamily='"'+aH["font-family"].split(",")[0].replace(/^['"]+|['"]+$/g,ac)+'"'),aH["font-size"]&&(F.fontSize=aH["font-size"]),aH["font-weight"]&&(F.fontWeight=aH["font-weight"]),aH["font-style"]&&(F.fontStyle=aH["font-style"])}"arrow-start" in aH&&aa(ay,aH["arrow-start"]),"arrow-end" in aH&&aa(ay,aH["arrow-end"],1);if(aH.opacity!=null||aH["stroke-width"]!=null||aH.fill!=null||aH.src!=null||aH.stroke!=null||aH["stroke-width"]!=null||aH["stroke-opacity"]!=null||aH["fill-opacity"]!=null||aH["stroke-dasharray"]!=null||aH["stroke-miterlimit"]!=null||aH["stroke-linejoin"]!=null||aH["stroke-linecap"]!=null){var C=aG.getElementsByTagName(ah),A=!1;C=C&&C[0],!C&&(A=C=Q(ah)),aI.type=="image"&&aH.src&&(C.src=aH.src),aH.fill&&(C.on=!0);if(C.on==null||aH.fill=="none"||aH.fill===null){C.on=!1}if(C.on&&aH.fill){var z=ao(aH.fill).match(aq._ISURL);if(z){C.parentNode==aG&&aG.removeChild(C),C.rotate=!0,C.src=z[1],C.type="tile";var w=aI.getBBox(1);C.position=w.x+ad+w.y,aI._.fillpos=[w.x,w.y],aq._preload(z[1],function(){aI._.fillsize=[this.offsetWidth,this.offsetHeight]})}else{C.color=aq.getRGB(aH.fill).hex,C.src=ac,C.type="solid",aq.getRGB(aH.fill).error&&(ay.type in {circle:1,ellipse:1}||ao(aH.fill).charAt()!="r")&&W(ay,aH.fill,C)&&(aF.fill="none",aF.gradient=aH.fill,C.rotate=!1)}}if("fill-opacity" in aH||"opacity" in aH){var v=((+aF["fill-opacity"]+1||2)-1)*((+aF.opacity+1||2)-1)*((+aq.getRGB(aH.fill).o+1||2)-1);v=aj(ak(v,0),1),C.opacity=v,C.src&&(C.color="none")}aG.appendChild(C);var o=aG.getElementsByTagName("stroke")&&aG.getElementsByTagName("stroke")[0],j=!1;!o&&(j=o=Q("stroke"));if(aH.stroke&&aH.stroke!="none"||aH["stroke-width"]||aH["stroke-opacity"]!=null||aH["stroke-dasharray"]||aH["stroke-miterlimit"]||aH["stroke-linejoin"]||aH["stroke-linecap"]){o.on=!0}(aH.stroke=="none"||aH.stroke===null||o.on==null||aH.stroke==0||aH["stroke-width"]==0)&&(o.on=!1);var h=aq.getRGB(aH.stroke);o.on&&aH.stroke&&(o.color=h.hex),v=((+aF["stroke-opacity"]+1||2)-1)*((+aF.opacity+1||2)-1)*((+h.o+1||2)-1);var g=(an(aH["stroke-width"])||1)*0.75;v=aj(ak(v,0),1),aH["stroke-width"]==null&&(g=aF["stroke-width"]),aH["stroke-width"]&&(o.weight=g),g&&g<1&&(v*=g)&&(o.weight=1),o.opacity=v,aH["stroke-linejoin"]&&(o.joinstyle=aH["stroke-linejoin"]||"miter"),o.miterlimit=aH["stroke-miterlimit"]||8,aH["stroke-linecap"]&&(o.endcap=aH["stroke-linecap"]=="butt"?"flat":aH["stroke-linecap"]=="square"?"square":"round");if(aH["stroke-dasharray"]){var f={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"};o.dashstyle=f[ap](aH["stroke-dasharray"])?f[aH["stroke-dasharray"]]:ac}j&&aG.appendChild(o)}if(ay.type=="text"){ay.paper.canvas.style.display=ac;var d=ay.paper.span,b=100,a=aF.font&&aF.font.match(/\d+(?:\.\d*)?(?=px)/);aE=d.style,aF.font&&(aE.font=aF.font),aF["font-family"]&&(aE.fontFamily=aF["font-family"]),aF["font-weight"]&&(aE.fontWeight=aF["font-weight"]),aF["font-style"]&&(aE.fontStyle=aF["font-style"]),a=an(aF["font-size"]||a&&a[0])||10,aE.fontSize=a*b+"px",ay.textpath.string&&(d.innerHTML=ao(ay.textpath.string).replace(/</g,"&#60;").replace(/&/g,"&#38;").replace(/\n/g,"<br>"));var k=d.getBoundingClientRect();ay.W=aF.w=(k.right-k.left)/b,ay.H=aF.h=(k.bottom-k.top)/b,ay.X=aF.x,ay.Y=aF.y+ay.H/2,("x" in aH||"y" in aH)&&(ay.path.v=aq.format("m{0},{1}l{2},{1}",al(aF.x*R),al(aF.y*R),al(aF.x*R)+1));var aJ=["x","y","text","font","font-family","font-weight","font-style","font-size"];for(var u=0,n=aJ.length;u<n;u++){if(aJ[u] in aH){ay._.dirty=1;break}}switch(aF["text-anchor"]){case"start":ay.textpath.style["v-text-align"]="left",ay.bbx=ay.W/2;break;case"end":ay.textpath.style["v-text-align"]="right",ay.bbx=-ay.W/2;break;default:ay.textpath.style["v-text-align"]="center",ay.bbx=0}ay.textpath.style["v-text-kern"]=!0}},W=function(C,B,A){C.attrs=C.attrs||{};var z=C.attrs,w=Math.pow,v,u,o="linear",n=".5 .5";C.attrs.gradient=B,B=ao(B).replace(aq._radial_gradient,function(g,f,h){o="radial",f&&h&&(f=an(f),h=an(h),w(f-0.5,2)+w(h-0.5,2)>0.25&&(h=am.sqrt(0.25-w(f-0.5,2))*((h>0.5)*2-1)+0.5),n=f+ad+h);return ac}),B=B.split(/\s*\-\s*/);if(o=="linear"){var e=B.shift();e=-an(e);if(isNaN(e)){return null}}var d=aq._parseDots(B);if(!d){return null}C=C.shape||C.node;if(d.length){C.removeChild(A),A.on=!0,A.method="none",A.color=d[0].color,A.color2=d[d.length-1].color;var a=[];for(var E=0,D=d.length;E<D;E++){d[E].offset&&a.push(d[E].offset+ad+d[E].color)}A.colors=a.length?a.join():"0% "+A.color,o=="radial"?(A.type="gradientTitle",A.focus="100%",A.focussize="0 0",A.focusposition=n,A.angle=0):(A.type="gradient",A.angle=(270-e)%360),C.appendChild(A)}return 1},U=function(a,d){this[0]=this.node=a,a.raphael=!0,this.id=aq._oid++,a.raphaelid=this.id,this.X=0,this.Y=0,this.attrs={},this.paper=d,this.matrix=aq.matrix(),this._={transform:[],sx:1,sy:1,dx:0,dy:0,deg:0,dirty:1,dirtyT:1},!d.bottom&&(d.bottom=this),this.prev=d.top,d.top&&(d.top.next=this),d.top=this,this.next=null},S=aq.el;U.prototype=S,S.constructor=U,S.transform=function(F){if(F==null){return this._.transform}var E=this.paper._viewBoxShift,D=E?"s"+[E.scale,E.scale]+"-1-1t"+[E.dx,E.dy]:ac,C;E&&(C=F=ao(F).replace(/\.{3}|\u2026/g,this._.transform||ac)),aq._extractTransform(this,D+F);var B=this.matrix.clone(),A=this.skew,z=this.node,w,v=~ao(this.attrs.fill).indexOf("-"),u=!ao(this.attrs.fill).indexOf("url(");B.translate(-0.5,-0.5);if(u||v||this.type=="image"){A.matrix="1 0 0 1",A.offset="0 0",w=B.split();if(v&&w.noRotation||!w.isSimple){z.style.filter=B.toFilter();var t=this.getBBox(),o=this.getBBox(1),n=t.x-o.x,a=t.y-o.y;z.coordorigin=n*-R+ad+a*-R,I(this,1,1,n,a,0)}else{z.style.filter=ac,I(this,w.scalex,w.scaley,w.dx,w.dy,w.rotate)}}else{z.style.filter=ac,A.matrix=ao(B),A.offset=B.offset()}C&&(this._.transform=C);return this},S.rotate=function(g,d,i){if(this.removed){return this}if(g!=null){g=ao(g).split(ag),g.length-1&&(d=an(g[1]),i=an(g[2])),g=an(g[0]),i==null&&(d=i);if(d==null||i==null){var h=this.getBBox(1);d=h.x+h.width/2,i=h.y+h.height/2}this._.dirtyT=1,this.transform(this._.transform.concat([["r",g,d,i]]));return this}},S.translate=function(e,d){if(this.removed){return this}e=ao(e).split(ag),e.length-1&&(d=an(e[1])),e=an(e[0])||0,d=+d||0,this._.bbox&&(this._.bbox.x+=e,this._.bbox.y+=d),this.transform(this._.transform.concat([["t",e,d]]));return this},S.scale=function(h,d,k,j){if(this.removed){return this}h=ao(h).split(ag),h.length-1&&(d=an(h[1]),k=an(h[2]),j=an(h[3]),isNaN(k)&&(k=null),isNaN(j)&&(j=null)),h=an(h[0]),d==null&&(d=h),j==null&&(k=j);if(k==null||j==null){var i=this.getBBox(1)}k=k==null?i.x+i.width/2:k,j=j==null?i.y+i.height/2:j,this.transform(this._.transform.concat([["s",h,d,k,j]])),this._.dirtyT=1;return this},S.hide=function(){!this.removed&&(this.node.style.display="none");return this},S.show=function(){!this.removed&&(this.node.style.display=ac);return this},S._getBBox=function(){if(this.removed){return{}}return{x:this.X+(this.bbx||0)-this.W/2,y:this.Y-this.H,width:this.W,height:this.H}},S.remove=function(){if(!this.removed){this.paper.__set__&&this.paper.__set__.exclude(this),aq.eve.unbind("*.*."+this.id),aq._tear(this,this.paper),this.node.parentNode.removeChild(this.node),this.shape&&this.shape.parentNode.removeChild(this.shape);for(var a in this){this[a]=typeof this[a]=="function"?aq._removedFactory(a):null}this.removed=!0}},S.attr=function(A,z){if(this.removed){return this}if(A==null){var w={};for(var v in this.attrs){this.attrs[ap](v)&&(w[v]=this.attrs[v])}w.gradient&&w.fill=="none"&&(w.fill=w.gradient)&&delete w.gradient,w.transform=this._.transform;return w}if(z==null&&aq.is(A,"string")){if(A==ah&&this.attrs.fill=="none"&&this.attrs.gradient){return this.attrs.gradient}var u=A.split(ag),t={};for(var r=0,l=u.length;r<l;r++){A=u[r],A in this.attrs?t[A]=this.attrs[A]:aq.is(this.paper.customAttributes[A],"function")?t[A]=this.paper.customAttributes[A].def:t[A]=aq._availableAttrs[A]}return l-1?t:t[u[0]]}if(this.attrs&&z==null&&aq.is(A,"array")){t={};for(r=0,l=A.length;r<l;r++){t[A[r]]=this.attr(A[r])}return t}var k;z!=null&&(k={},k[A]=z),z==null&&aq.is(A,"object")&&(k=A);for(var j in k){af("attr."+j+"."+this.id,this,k[j])}if(k){for(j in this.paper.customAttributes){if(this.paper.customAttributes[ap](j)&&k[ap](j)&&aq.is(this.paper.customAttributes[j],"function")){var b=this.paper.customAttributes[j].apply(this,[].concat(k[j]));this.attrs[j]=k[j];for(var a in b){b[ap](a)&&(k[a]=b[a])}}}k.text&&this.type=="text"&&(this.textpath.string=k.text),Y(this,k)}return this},S.toFront=function(){!this.removed&&this.node.parentNode.appendChild(this.node),this.paper&&this.paper.top!=this&&aq._tofront(this,this.paper);return this},S.toBack=function(){if(this.removed){return this}this.node.parentNode.firstChild!=this.node&&(this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild),aq._toback(this,this.paper));return this},S.insertAfter=function(a){if(this.removed){return this}a.constructor==aq.st.constructor&&(a=a[a.length-1]),a.node.nextSibling?a.node.parentNode.insertBefore(this.node,a.node.nextSibling):a.node.parentNode.appendChild(this.node),aq._insertafter(this,a,this.paper);return this},S.insertBefore=function(a){if(this.removed){return this}a.constructor==aq.st.constructor&&(a=a[0]),a.node.parentNode.insertBefore(this.node,a.node),aq._insertbefore(this,a,this.paper);return this},S.blur=function(a){var f=this.node.runtimeStyle,e=f.filter;e=e.replace(X,ac),+a!==0?(this.attrs.blur=a,f.filter=e+ad+ae+".Blur(pixelradius="+(+a||1.5)+")",f.margin=aq.format("-{0}px 0 0 -{0}px",al(+a||1.5))):(f.filter=e,f.margin=0,delete this.attrs.blur)},aq._engine.path=function(h,g){var l=Q("shape");l.style.cssText=T,l.coordsize=R+ad+R,l.coordorigin=g.coordorigin;var k=new U(l,g),j={fill:"none",stroke:"#000"};h&&(j.path=h),k.type="path",k.path=[],k.Path=ac,Y(k,j),g.canvas.appendChild(l);var i=Q("skew");i.on=!0,l.appendChild(i),k.skew=i,k.transform(ac);return k},aq._engine.rect=function(t,r,q,p,o,n){var l=aq._rectPath(r,q,p,o,n),k=t.path(l),a=k.attrs;k.X=a.x=r,k.Y=a.y=q,k.W=a.width=p,k.H=a.height=o,a.r=n,a.path=l,k.type="rect";return k},aq._engine.ellipse=function(i,h,o,n,l){var k=i.path(),j=k.attrs;k.X=h-n,k.Y=o-l,k.W=n*2,k.H=l*2,k.type="ellipse",Y(k,{cx:h,cy:o,rx:n,ry:l});return k},aq._engine.circle=function(h,g,l,k){var j=h.path(),i=j.attrs;j.X=g-k,j.Y=l-k,j.W=j.H=k*2,j.type="circle",Y(j,{cx:g,cy:l,r:k});return j},aq._engine.image=function(w,v,u,t,r,q){var p=aq._rectPath(u,t,r,q),o=w.path(p).attr({stroke:"none"}),n=o.attrs,j=o.node,a=j.getElementsByTagName(ah)[0];n.src=v,o.X=n.x=u,o.Y=n.y=t,o.W=n.width=r,o.H=n.height=q,n.path=p,o.type="image",a.parentNode==j&&j.removeChild(a),a.rotate=!0,a.src=v,a.type="tile",o._.fillpos=[u,t],o._.fillsize=[r,q],j.appendChild(a),I(o,1,1,0,0,0);return o},aq._engine.text=function(v,u,t,r){var q=Q("shape"),p=Q("path"),o=Q("textpath");u=u||0,t=t||0,r=r||"",p.v=aq.format("m{0},{1}l{2},{1}",al(u*R),al(t*R),al(u*R)+1),p.textpathok=!0,o.string=ao(r),o.on=!0,q.style.cssText=T,q.coordsize=R+ad+R,q.coordorigin="0 0";var n=new U(q,v),f={fill:"#000",stroke:"none",font:aq._availableAttrs.font,text:r};n.shape=q,n.path=p,n.textpath=o,n.type="text",n.attrs.text=ao(r),n.attrs.x=u,n.attrs.y=t,n.attrs.w=1,n.attrs.h=1,Y(n,f),q.appendChild(o),q.appendChild(p),v.canvas.appendChild(q);var a=Q("skew");a.on=!0,q.appendChild(a),n.skew=a,n.transform(ac);return n},aq._engine.setSize=function(a,f){var e=this.canvas.style;this.width=a,this.height=f,a==+a&&(a+="px"),f==+f&&(f+="px"),e.width=a,e.height=f,e.clip="rect(0 "+a+" "+f+" 0)",this._viewBox&&aq._engine.setViewBox.apply(this,this._viewBox);return this},aq._engine.setViewBox=function(v,u,t,r,q){aq.eve("setViewBox",this,this._viewBox,[v,u,t,r,q]);var p=this.width,o=this.height,n=1/ak(t/p,r/o),g,a;q&&(g=o/r,a=p/t,t*g<p&&(v-=(p-t*g)/2/g),r*a<o&&(u-=(o-r*a)/2/a)),this._viewBox=[v,u,t,r,!!q],this._viewBoxShift={dx:-v,dy:-u,scale:n},this.forEach(function(b){b.transform("...")});return this};var Q;aq._engine.initWin=function(e){var d=e.document;d.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{!d.namespaces.rvml&&d.namespaces.add("rvml","urn:schemas-microsoft-com:vml"),Q=function(b){return d.createElement("<rvml:"+b+' class="rvml">')}}catch(f){Q=function(b){return d.createElement("<"+b+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}},aq._engine.initWin(aq._g.win),aq._engine.create=function(){var v=aq._getContainer.apply(0,arguments),u=v.container,t=v.height,r,q=v.width,p=v.x,o=v.y;if(!u){throw new Error("VML container not found.")}var n=new aq._Paper,l=n.canvas=aq._g.doc.createElement("div"),a=l.style;p=p||0,o=o||0,q=q||512,t=t||342,n.width=q,n.height=t,q==+q&&(q+="px"),t==+t&&(t+="px"),n.coordsize=R*1000+ad+R*1000,n.coordorigin="0 0",n.span=aq._g.doc.createElement("span"),n.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;",l.appendChild(n.span),a.cssText=aq.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",q,t),u==1?(aq._g.doc.body.appendChild(l),a.left=p+"px",a.top=o+"px",a.position="absolute"):u.firstChild?u.insertBefore(l,u.firstChild):u.appendChild(l),n.renderfix=function(){};return n},aq.prototype.clear=function(){aq.eve("clear",this),this.canvas.innerHTML=ac,this.span=aq._g.doc.createElement("span"),this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;",this.canvas.appendChild(this.span),this.bottom=this.top=null},aq.prototype.remove=function(){aq.eve("remove",this),this.canvas.parentNode.removeChild(this.canvas);for(var a in this){this[a]=typeof this[a]=="function"?aq._removedFactory(a):null}return !0};var O=aq.st;for(var M in S){S[ap](M)&&!O[ap](M)&&(O[M]=function(b){return function(){var a=arguments;return this.forEach(function(d){d[b].apply(d,a)})}}(M))}}(window.Raphael);(function(){var N,M,L,J,I,H,G,F,E,D,C,B,A,z,w,v,u=Object.prototype.hasOwnProperty,t=function(f,e){function g(){this.constructor=f}for(var h in e){u.call(e,h)&&(f[h]=e[h])}g.prototype=e.prototype,f.prototype=new g,f.__super__=e.prototype;return f};D=typeof exports!="undefined"&&exports!==null?exports:this,F=(B=D.chroma)!=null?B:D.chroma={},typeof module!="undefined"&&module!==null&&(module.exports=F),F.version="0.3.0",L=function(){function b(a,l,k,j){var i,h;i=this,a==null&&l==null&&k==null&&j==null&&(a=[255,0,255]),C(a)==="array"&&a.length===3&&(j==null&&(j=l),h=a,a=h[0],l=h[1],k=h[2]),C(a)==="string"?j="hex":j==null&&(j="rgb"),j==="rgb"?i.rgb=[a,l,k]:j==="hsl"?i.rgb=b.hsl2rgb(a,l,k):j==="hsv"?i.rgb=b.hsv2rgb(a,l,k):j==="hex"?i.rgb=b.hex2rgb(a):j==="lab"?i.rgb=b.lab2rgb(a,l,k):j==="hcl"?i.rgb=b.hcl2rgb(a,l,k):j==="hsi"&&(i.rgb=b.hsi2rgb(a,l,k))}b.prototype.hex=function(){return b.rgb2hex(this.rgb)},b.prototype.toString=function(){return this.hex()},b.prototype.hsl=function(){return b.rgb2hsl(this.rgb)},b.prototype.hsv=function(){return b.rgb2hsv(this.rgb)},b.prototype.lab=function(){return b.rgb2lab(this.rgb)},b.prototype.hcl=function(){return b.rgb2hcl(this.rgb)},b.prototype.hsi=function(){return b.rgb2hsi(this.rgb)},b.prototype.interpolate=function(ab,aa,Z){var Y,X,W,V,U,T,S,R,Q,P,O,k,a;R=this,Z==null&&(Z="rgb"),C(aa)==="string"&&(aa=new b(aa));if(Z==="hsl"||Z==="hsv"||Z==="hcl"||Z==="hsi"){Z==="hsl"?(k=R.hsl(),a=aa.hsl()):Z==="hsv"?(k=R.hsv(),a=aa.hsv()):Z==="hcl"?(k=R.hcl(),a=aa.hcl()):Z==="hsi"&&(k=R.hsi(),a=aa.hsi()),W=k[0],P=k[1],T=k[2],V=a[0],O=a[1],S=a[2];if(!isNaN(W)&&!isNaN(V)){V>W&&V-W>180?Y=V-(W+360):V<W&&W-V>180?Y=V+360-W:Y=V-W,X=W+ab*Y}else{if(!isNaN(W)){X=W;if(S===1||S===0){Q=P}}else{if(!isNaN(V)){X=V;if(T===1||T===0){Q=O}}else{X=void 0}}}Q==null&&(Q=P+ab*(O-P)),U=T+ab*(S-T);return new b(X,Q,U,Z)}if(Z==="rgb"){k=R.rgb,a=aa.rgb;return new b(k[0]+ab*(a[0]-k[0]),k[1]+ab*(a[1]-k[1]),k[2]+ab*(a[2]-k[2]),Z)}if(Z==="lab"){k=R.lab(),a=aa.lab();return new b(k[0]+ab*(a[0]-k[0]),k[1]+ab*(a[1]-k[1]),k[2]+ab*(a[2]-k[2]),Z)}throw"color mode "+Z+" is not supported"};return b}(),L.hex2rgb=function(g){var f,j,i,h;if(!g.match(/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/)){if(F.colors!=null&&F.colors[g]){g=F.colors[g]}else{throw"unknown color format: "+g}}if(g.length===4||g.length===7){g=g.substr(1)}g.length===3&&(g=g[0]+g[0]+g[1]+g[1]+g[2]+g[2]),h=parseInt(g,16),i=h>>16,j=h>>8&255,f=h&255;return[i,j,f]},L.rgb2hex=function(h,g,l){var k,j,i;h!==void 0&&h.length===3&&(i=h,h=i[0],g=i[1],l=i[2]),j=h<<16|g<<8|l,k="000000"+j.toString(16).toUpperCase();return"#"+k.substr(k.length-6)},L.hsv2rgb=function(af,ae,ad){var ac,ab,aa,Z,Y,X,W,V,U,T,S,R,Q,P,O,k;C(af)==="array"&&af.length===3&&(T=af,af=T[0],ae=T[1],Y=T[2]),ad*=255;if(ae===0&&isNaN(af)){V=aa=ac=ad}else{af===360&&(af=0),af>360&&(af-=360),af<0&&(af+=360),af/=60,Z=Math.floor(af),ab=af-Z,X=ad*(1-ae),W=ad*(1-ae*ab),U=ad*(1-ae*(1-ab));switch(Z){case 0:S=[ad,U,X],V=S[0],aa=S[1],ac=S[2];break;case 1:R=[W,ad,X],V=R[0],aa=R[1],ac=R[2];break;case 2:Q=[X,ad,U],V=Q[0],aa=Q[1],ac=Q[2];break;case 3:P=[X,W,ad],V=P[0],aa=P[1],ac=P[2];break;case 4:O=[U,X,ad],V=O[0],aa=O[1],ac=O[2];break;case 5:k=[ad,X,W],V=k[0],aa=k[1],ac=k[2]}}V=Math.round(V),aa=Math.round(aa),ac=Math.round(ac);return[V,aa,ac]},L.rgb2hsv=function(Q,P,O){var r,q,p,o,n,l,k;Q!==void 0&&Q.length===3&&(k=Q,Q=k[0],P=k[1],O=k[2]),o=Math.min(Q,P,O),p=Math.max(Q,P,O),r=p-o,l=p/255,n=r/p,n===0?(q=void 0,n=0):(Q===p&&(q=(P-O)/r),P===p&&(q=2+(O-Q)/r),O===p&&(q=4+(Q-P)/r),q*=60,q<0&&(q+=360));return[q,n,l]},L.hsl2rgb=function(V,U,T){var S,R,Q,P,O,r,q,p,o,n;V!==void 0&&V.length===3&&(o=V,V=o[0],U=o[1],T=o[2]);if(U===0){O=Q=S=T*255}else{p=[0,0,0],R=[0,0,0],q=T<0.5?T*(1+U):T+U-T*U,r=2*T-q,V/=360,p[0]=V+1/3,p[1]=V,p[2]=V-1/3;for(P=0;P<=2;P++){p[P]<0&&(p[P]+=1),p[P]>1&&(p[P]-=1),6*p[P]<1?R[P]=r+(q-r)*6*p[P]:2*p[P]<1?R[P]=q:3*p[P]<2?R[P]=r+(q-r)*(2/3-p[P])*6:R[P]=r}n=[Math.round(R[0]*255),Math.round(R[1]*255),Math.round(R[2]*255)],O=n[0],Q=n[1],S=n[2]}return[O,Q,S]},L.rgb2hsl=function(O,r,q){var p,o,n,l,k,j;O!==void 0&&O.length===3&&(j=O,O=j[0],r=j[1],q=j[2]),O/=255,r/=255,q/=255,l=Math.min(O,r,q),n=Math.max(O,r,q),o=(n+l)/2,n===l?(k=0,p=void 0):k=o<0.5?(n-l)/(n+l):(n-l)/(2-n-l),O===n?p=(r-q)/(n-l):r===n?p=2+(q-O)/(n-l):q===n&&(p=4+(O-r)/(n-l)),p*=60,p<0&&(p+=360);return[p,k,o]},L.lab2xyz=function(Q,P,O){var r,q,p,o,n,l,k;C(Q)==="array"&&Q.length===3&&(k=Q,Q=k[0],P=k[1],O=k[2]),r=function(b){return b>6/29?b*b*b:3*(6/29)*(6/29)*(b-4/29)},p=(Q+0.16)/1.16,q=[0.96421,1,0.82519],n=q[1]*r(p),o=q[0]*r(p+P/5),l=q[2]*r(p-O/2);return[o,n,l]},L.xyz2rgb=function(V,U,T){var S,R,Q,P,O,r,q,p,o,k;C(V)==="array"&&V.length===3&&(o=V,V=o[0],U=o[1],T=o[2]),p=3.2406*V-1.5372*U-0.4986*T,r=-0.9689*V+1.8758*U+0.0415*T,R=0.0557*V-0.204*U+1.057*T,Q=Math.min(p,r,R)<-0.001||Math.max(p,r,R)>1.001,Q&&(p=p<0?0:p>1?1:p,r=r<0?0:r>1?1:r,R=R<0?0:R>1?1:R),Q&&(k=[void 0,void 0,void 0],p=k[0],r=k[1],R=k[2]),P=function(e){var d;d=0.055;return e<=0.0031308?12.92*e:(1+d)*Math.pow(e,1/2.4)-d},q=Math.round(255*P(p)),O=Math.round(255*P(r)),S=Math.round(255*P(R));return[q,O,S]},L.lab2rgb=function(P,O,r){var q,p,o,n,l,k;P!==void 0&&P.length===3&&(n=P,P=n[0],O=n[1],r=n[2]),P!==void 0&&P.length===3&&(l=P,P=l[0],O=l[1],r=l[2]),k=L.lab2xyz(P,O,r),q=k[0],p=k[1],o=k[2];return L.xyz2rgb(q,p,o)},L.hcl2lab=function(Q,P,O){var r,q,p,o,n,l,k;C(Q)==="array"&&Q.length===3&&(k=Q,Q=k[0],P=k[1],O=k[2]),Q/=360,q=6.283185307179586,r=O*0.61+0.09,o=q/6-Q*q,l=(O*0.311+0.125)*P,p=Math.sin(o)*l,n=Math.cos(o)*l;return[r,p,n]},L.hcl2rgb=function(j,i,p){var o,n,l,k;k=L.hcl2lab(j,i,p),o=k[0],n=k[1],l=k[2];return L.lab2rgb(o,n,l)},L.rgb2xyz=function(S,R,Q){var P,O,r,q,p,o,n,l;S!==void 0&&S.length===3&&(l=S,S=l[0],R=l[1],Q=l[2]),O=function(e){var d;d=0.055;return e<=0.04045?e/12.92:Math.pow((e+d)/(1+d),2.4)},q=O(S/255),r=O(R/255),P=O(Q/255),p=0.4124*q+0.3576*r+0.1805*P,o=0.2126*q+0.7152*r+0.0722*P,n=0.0193*q+0.1192*r+0.9505*P;return[p,o,n]},L.xyz2lab=function(O,r,q){var p,o,n,l,k,j;O!==void 0&&O.length===3&&(j=O,O=j[0],r=j[1],q=j[2]),l=[0.96421,1,0.82519],n=function(b){return b>Math.pow(6/29,3)?Math.pow(b,1/3):7.787037037037035*b+4/29},k=1.16*n(r/l[1])-0.16,p=5*(n(O/l[0])-n(r/l[1])),o=2*(n(r/l[1])-n(q/l[2]));return[k,p,o]},L.rgb2lab=function(k,j,r){var q,p,o,n,l;k!==void 0&&k.length===3&&(n=k,k=n[0],j=n[1],r=n[2]),l=L.rgb2xyz(k,j,r),q=l[0],p=l[1],o=l[2];return L.xyz2lab(q,p,o)},L.lab2hcl=function(Q,P,O){var r,q,p,o,n,l,k;C(Q)==="array"&&Q.length===3&&(k=Q,Q=k[0],P=k[1],O=k[2]),r=Q,Q=(Q-0.09)/0.61,n=Math.sqrt(P*P+O*O),l=n/(Q*0.311+0.125),q=6.283185307179586,p=Math.atan2(P,O),o=(q/6-p)/q,o*=360,o<0&&(o+=360);return[o,l,Q]},L.rgb2hcl=function(j,i,p){var o,n,l,k;C(j)==="array"&&j.length===3&&(l=j,j=l[0],i=l[1],p=l[2]),k=L.rgb2lab(j,i,p),n=k[0],o=k[1],p=k[2];return L.lab2hcl(n,o,p)},L.rgb2hsi=function(O,r,q){var p,o,n,l,k,j;C(O)==="array"&&O.length===3&&(j=O,O=j[0],r=j[1],q=j[2]),p=Math.PI*2,O/=255,r/=255,q/=255,l=Math.min(O,r,q),n=(O+r+q)/3,k=1-l/n,k===0?o=0:(o=(O-r+(O-q))/2,o/=Math.sqrt((O-r)*(O-r)+(O-q)*(r-q)),o=Math.acos(o),q>r&&(o=p-o),o/=p);return[o*360,k,n]},L.hsi2rgb=function(Q,P,O){var r,q,p,o,n,l,k;C(Q)==="array"&&Q.length===3&&(k=Q,Q=k[0],P=k[1],O=k[2]),q=Math.PI*2,r=Math.PI/3,o=Math.cos,Q<0&&(Q+=360),Q>360&&(Q-=360),Q/=360,Q<1/3?(p=(1-P)/3,l=(1+P*o(q*Q)/o(r-q*Q))/3,n=1-(p+l)):Q<2/3?(Q-=1/3,l=(1-P)/3,n=(1+P*o(q*Q)/o(r-q*Q))/3,p=1-(l+n)):(Q-=2/3,n=(1-P)/3,p=(1+P*o(q*Q)/o(r-q*Q))/3,l=1-(n+p)),l=O*l*3,n=O*n*3,p=O*p*3;return[l*255,n*255,p*255]},F.Color=L,F.hsl=function(f,e,g){return new L(f,e,g,"hsl")},F.hsv=function(f,e,g){return new L(f,e,g,"hsv")},F.rgb=function(f,e,g){return new L(f,e,g,"rgb")},F.hex=function(b){return new L(b)},F.lab=function(f,e,g){return new L(f,e,g,"lab")},F.hcl=function(f,e,g){return new L(f,e,g,"hcl")},F.hsi=function(f,e,g){return new L(f,e,g,"hsi")},F.interpolate=function(g,f,i,h){C(g)==="string"&&(g=new L(g)),C(f)==="string"&&(f=new L(f));return g.interpolate(i,f,h)},J=function(){function b(S){var R,Q,P,O,r,q,p,o,n,k;O=this,O.colors=P=(r=S.colors)!=null?r:["#ddd","#222"];for(R=0,q=P.length-1;0<=q?R<=q:R>=q;0<=q?R++:R--){Q=P[R],C(Q)==="string"&&(P[R]=new L(Q))}if(S.positions!=null){O.pos=S.positions}else{O.pos=[];for(R=0,p=P.length-1;0<=p?R<=p:R>=p;0<=p?R++:R--){O.pos.push(R/(P.length-1))}}O.mode=(o=S.mode)!=null?o:"hsv",O.nacol=(n=S.nacol)!=null?n:"#ccc",O.setClasses((k=S.limits)!=null?k:[0,1]),O}b.prototype.getColor=function(g){var f,j,i,h;h=this;if(isNaN(g)){return h.nacol}h.classLimits.length>2?(f=h.getClass(g),j=f/(h.numClasses-1)):(j=i=(g-h.min)/(h.max-h.min),j=Math.min(1,Math.max(0,j)));return h.fColor(j)},b.prototype.fColor=function(i){var h,o,n,l,k,j;l=this,o=l.colors;for(n=0,j=l.pos.length-1;0<=j?n<=j:n>=j;0<=j?n++:n--){k=l.pos[n];if(i<=k){h=o[n];break}if(i>=k&&n===l.pos.length-1){h=o[n];break}if(i>k&&i<l.pos[n+1]){i=(i-k)/(l.pos[n+1]-k),h=F.interpolate(o[n],o[n+1],i,l.mode);break}}return h},b.prototype.classifyValue=function(i){var h,o,n,l,k,j;j=this,o=j.classLimits,o.length>2&&(k=o.length-1,h=j.getClass(i),i=o[h]+(o[h+1]-o[h])*0.5,l=o[0],n=o[k-1],i=j.min+(i-l)/(n-l)*(j.max-j.min));return i},b.prototype.setClasses=function(e){var d;e==null&&(e=[]),d=this,d.classLimits=e,d.min=e[0],d.max=e[e.length-1];return e.length===2?d.numClasses=0:d.numClasses=e.length-1},b.prototype.getClass=function(g){var f,j,i,h;h=this,j=h.classLimits;if(j!=null){i=j.length-1,f=0;while(f<i&&g>=j[f]){f++}return f-1}},b.prototype.validValue=function(d){return !isNaN(d)};return b}(),F.ColorScale=J,H=function(){function b(a,f,e){a==null&&(a="#fe0000"),f==null&&(f="#feeeee"),e==null&&(e="hsl"),b.__super__.constructor.call(this,[a,f],[0,1],e)}t(b,J);return b}(),F.Ramp=H,I=function(){function b(a,l,k,j,i){var h;a==null&&(a="#d73027"),l==null&&(l="#ffffbf"),k==null&&(k="#1E6189"),j==null&&(j="mean"),i==null&&(i="hsl"),h=this,h.mode=i,h.center=j,b.__super__.constructor.call(this,[a,l,k],[0,0.5,1],i)}t(b,J),b.prototype.parseData=function(a,h){var g,f;b.__super__.parseData.call(this,a,h),f=this,g=f.center,g==="median"?g=f.median:g==="mean"&&(g=f.mean);return f.pos[1]=(g-f.min)/(f.max-f.min)};return b}(),F.Diverging=I,M=function(){function b(e){var d;d=this,d.colors=e}t(b,J),b.prototype.parseData=function(e,d){},b.prototype.getColor=function(e){var d;d=this;return d.colors.hasOwnProperty(e)?d.colors[e]:"#cccccc"},b.prototype.validValue=function(d){return this.colors.hasOwnProperty(d)};return b}(),F.Categories=M,N=function(){function b(e){var d;d=this,d.name=e,d.setClasses(7),d}t(b,J),b.prototype.getColor=function(e){var d,f;f=this,d=f.getClass(e);return f.name+" l"+f.numClasses+" c"+d};return b}(),F.CSSColors=N,(A=F.scales)==null&&(F.scales={}),F.scales.cool=function(){return new H(F.hsl(180,1,0.9),F.hsl(250,0.7,0.4))},F.scales.hot=function(){return new J({colors:["#000000","#ff0000","#ffff00","#ffffff"],positions:[0,0.25,0.75,1],mode:"rgb"})},F.scales.BlWhOr=function(){return new I(F.hsl(30,1,0.55),"#ffffff",new L(220,1,0.55))},F.scales.GrWhPu=function(){return new I(F.hsl(120,0.8,0.4),"#ffffff",new L(280,0.8,0.4))},F.limits=function(aY,aX,aW,aV){var aU,aT,aS,aR,aQ,aP,aO,aN,aM,aL,aK,aJ,aI,aH,aG,aF,aE,aD,aC,aB,aA,az,ay,ax,aw,av,au,at,ar,aq,ap,ao,an,am,al,ak,aj,ai,ah,ag,af,ae,ad,ac,ab,aa,k;aX==null&&(aX="equal"),aW==null&&(aW=7),aV==null&&(aV=null),aI=Number.MAX_VALUE,aJ=Number.MAX_VALUE*-1,ay=0,au=[];if(C(aY)==="array"){if(C(aY[0])!=="object"&&C(aY[0])!=="array"){for(at=0,ap=aY.length;at<ap;at++){aw=aY[at],isNaN(aw)||au.push(Number(aw))}}else{for(ar=0,ao=aY.length;ar<ao;ar++){az=aY[ar],au.push(Number(az[aV]))}}}else{if(C(aY)==="object"){for(aM in aY){aw=aY[aM],C(aw)==="object"&&C(aV)==="string"?isNaN(aw[aV])||au.push(Number(aw[aV])):C(aw)==="array"&&C(aV)==="number"?isNaN(aw[aV])||au.push(Number(aw[aV])):C(aw)==="number"&&(isNaN(aw)||au.push(Number(aw)))}}}for(aq=0,an=au.length;aq<an;aq++){aw=au[aq];if(!isNaN(aw)){aw<aI&&(aI=aw),aw>aJ&&(aJ=aw),ay+=aw}else{continue}}au=au.sort(function(e,d){return e-d}),aK=[],aX.substr(0,1)==="c"&&(aK.push(aI),aK.push(aJ));if(aX.substr(0,1)==="e"){aK.push(aI);for(aO=1,af=aW-1;1<=af?aO<=af:aO>=af;1<=af?aO++:aO--){aK.push(aI+aO/aW*(aJ-aI))}aK.push(aJ)}else{if(aX.substr(0,1)==="q"){aK.push(aI);for(aO=1,ae=aW-1;1<=ae?aO<=ae:aO>=ae;1<=ae?aO++:aO--){aD=au.length*aO/aW,aC=Math.floor(aD),aC===aD?aK.push(au[aC]):(aB=aD-aC,aK.push(au[aC]*aB+au[aC+1]*(1-aB)))}aK.push(aJ)}else{if(aX.substr(0,1)==="k"){aG=au.length,aU=Array(aG),aQ=Array(aW),aA=!0,aF=0,aS=null,aS=[],aS.push(aI);for(aO=1,ad=aW-1;1<=ad?aO<=ad:aO>=ad;1<=ad?aO++:aO--){aS.push(aI+aO/aW*(aJ-aI))}aS.push(aJ);while(aA){for(aN=0,ac=aW-1;0<=ac?aN<=ac:aN>=ac;0<=ac?aN++:aN--){aQ[aN]=0}for(aO=0,ab=aG-1;0<=ab?aO<=ab:aO>=ab;0<=ab?aO++:aO--){av=au[aO],aH=Number.MAX_VALUE;for(aN=0,aa=aW-1;0<=aa?aN<=aa:aN>=aa;0<=aa?aN++:aN--){aP=Math.abs(aS[aN]-av),aP<aH&&(aH=aP,aT=aN)}aQ[aT]++,aU[aO]=aT}aE=Array(aW);for(aN=0,k=aW-1;0<=k?aN<=k:aN>=k;0<=k?aN++:aN--){aE[aN]=null}for(aO=0,am=aG-1;0<=am?aO<=am:aO>=am;0<=am?aO++:aO--){aR=aU[aO],aE[aR]===null?aE[aR]=au[aO]:aE[aR]+=au[aO]}for(aN=0,al=aW-1;0<=al?aN<=al:aN>=al;0<=al?aN++:aN--){aE[aN]*=1/aQ[aN]}aA=!1;for(aN=0,ak=aW-1;0<=ak?aN<=ak:aN>=ak;0<=ak?aN++:aN--){if(aE[aN]!==aS[aO]){aA=!0;break}}aS=aE,aF++,aF>200&&(aA=!1)}aL={};for(aN=0,aj=aW-1;0<=aj?aN<=aj:aN>=aj;0<=aj?aN++:aN--){aL[aN]=[]}for(aO=0,ai=aG-1;0<=ai?aO<=ai:aO>=ai;0<=ai?aO++:aO--){aR=aU[aO],aL[aR].push(au[aO])}ax=[];for(aN=0,ah=aW-1;0<=ah?aN<=ah:aN>=ah;0<=ah?aN++:aN--){ax.push(aL[aN][0]),ax.push(aL[aN][aL[aN].length-1])}ax=ax.sort(function(e,d){return e-d}),aK.push(ax[0]);for(aO=1,ag=ax.length-1;aO<=ag;aO+=2){isNaN(ax[aO])||aK.push(ax[aO])}}}}return aK},D=typeof exports!="undefined"&&exports!==null?exports:this,C=function(){var g,f,j,i,h;g={},h="Boolean Number String Function Array Date RegExp Undefined Null".split(" ");for(j=0,i=h.length;j<i;j++){f=h[j],g["[object "+f+"]"]=f.toLowerCase()}return function(a){var d;d=Object.prototype.toString.call(a);return g[d]||"object"}}(),(z=D.type)==null&&(D.type=C),Array.max=function(b){return Math.max.apply(Math,b)},Array.min=function(b){return Math.min.apply(Math,b)},D=typeof exports!="undefined"&&exports!==null?exports:this,F=(w=D.chroma)!=null?w:D.chroma={},F.brewer=G={},G.OrRd=["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"],G.PuBu=["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"],G.BuPu=["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"],G.Oranges=["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"],G.BuGn=["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"],G.YlOrBr=["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"],G.YlGn=["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"],G.Reds=["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"],G.RdPu=["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"],G.Greens=["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"],G.YlGnBu=["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"],G.Purples=["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"],G.GnBu=["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"],G.Greys=["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"],G.YlOrRd=["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"],G.PuRd=["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"],G.Blues=["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"],G.PuBuGn=["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"],G.Spectral=["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],G.RdYlGn=["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],G.RdBu=["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],G.PiYG=["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],G.PRGn=["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],G.RdYlBu=["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],G.BrBG=["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],G.RdGy=["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],G.PuOr=["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],G.Set2=["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],G.Accent=["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"],G.Set1=["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"],G.Set3=["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"],G.Dark2=["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"],G.Paired=["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"],G.Pastel2=["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"],G.Pastel1=["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"],D=typeof exports!="undefined"&&exports!==null?exports:this,F=(v=D.chroma)!=null?v:D.chroma={},F.colors=E={},E.indigo="#4b0082",E.gold="#ffd700",E.hotpink="#ff69b4",E.firebrick="#b22222",E.indianred="#cd5c5c",E.yellow="#ffff00",E.mistyrose="#ffe4e1",E.darkolivegreen="#556b2f",E.olive="#808000",E.darkseagreen="#8fbc8f",E.pink="#ffc0cb",E.tomato="#ff6347",E.lightcoral="#f08080",E.orangered="#ff4500",E.navajowhite="#ffdead",E.lime="#00ff00",E.palegreen="#98fb98",E.darkslategrey="#2f4f4f",E.greenyellow="#adff2f",E.burlywood="#deb887",E.seashell="#fff5ee",E.mediumspringgreen="#00fa9a",E.fuchsia="#ff00ff",E.papayawhip="#ffefd5",E.blanchedalmond="#ffebcd",E.chartreuse="#7fff00",E.dimgray="#696969",E.black="#000000",E.peachpuff="#ffdab9",E.springgreen="#00ff7f",E.aquamarine="#7fffd4",E.white="#ffffff",E.orange="#ffa500",E.lightsalmon="#ffa07a",E.darkslategray="#2f4f4f",E.brown="#a52a2a",E.ivory="#fffff0",E.dodgerblue="#1e90ff",E.peru="#cd853f",E.lawngreen="#7cfc00",E.chocolate="#d2691e",E.crimson="#dc143c",E.forestgreen="#228b22",E.darkgrey="#a9a9a9",E.lightseagreen="#20b2aa",E.cyan="#00ffff",E.mintcream="#f5fffa",E.silver="#c0c0c0",E.antiquewhite="#faebd7",E.mediumorchid="#ba55d3",E.skyblue="#87ceeb",E.gray="#808080",E.darkturquoise="#00ced1",E.goldenrod="#daa520",E.darkgreen="#006400",E.floralwhite="#fffaf0",E.darkviolet="#9400d3",E.darkgray="#a9a9a9",E.moccasin="#ffe4b5",E.saddlebrown="#8b4513",E.grey="#808080",E.darkslateblue="#483d8b",E.lightskyblue="#87cefa",E.lightpink="#ffb6c1",E.mediumvioletred="#c71585",E.slategrey="#708090",E.red="#ff0000",E.deeppink="#ff1493",E.limegreen="#32cd32",E.darkmagenta="#8b008b",E.palegoldenrod="#eee8aa",E.plum="#dda0dd",E.turquoise="#40e0d0",E.lightgrey="#d3d3d3",E.lightgoldenrodyellow="#fafad2",E.darkgoldenrod="#b8860b",E.lavender="#e6e6fa",E.maroon="#800000",E.yellowgreen="#9acd32",E.sandybrown="#f4a460",E.thistle="#d8bfd8",E.violet="#ee82ee",E.navy="#000080",E.magenta="#ff00ff",E.dimgrey="#696969",E.tan="#d2b48c",E.rosybrown="#bc8f8f",E.olivedrab="#6b8e23",E.blue="#0000ff",E.lightblue="#add8e6",E.ghostwhite="#f8f8ff",E.honeydew="#f0fff0",E.cornflowerblue="#6495ed",E.slateblue="#6a5acd",E.linen="#faf0e6",E.darkblue="#00008b",E.powderblue="#b0e0e6",E.seagreen="#2e8b57",E.darkkhaki="#bdb76b",E.snow="#fffafa",E.sienna="#a0522d",E.mediumblue="#0000cd",E.royalblue="#4169e1",E.lightcyan="#e0ffff",E.green="#008000",E.mediumpurple="#9370db",E.midnightblue="#191970",E.cornsilk="#fff8dc",E.paleturquoise="#afeeee",E.bisque="#ffe4c4",E.slategray="#708090",E.darkcyan="#008b8b",E.khaki="#f0e68c",E.wheat="#f5deb3",E.teal="#008080",E.darkorchid="#9932cc",E.deepskyblue="#00bfff",E.salmon="#fa8072",E.darkred="#8b0000",E.steelblue="#4682b4",E.palevioletred="#db7093",E.lightslategray="#778899",E.aliceblue="#f0f8ff",E.lightslategrey="#778899",E.lightgreen="#90ee90",E.orchid="#da70d6",E.gainsboro="#dcdcdc",E.mediumseagreen="#3cb371",E.lightgray="#d3d3d3",E.mediumturquoise="#48d1cc",E.lemonchiffon="#fffacd",E.cadetblue="#5f9ea0",E.lightyellow="#ffffe0",E.lavenderblush="#fff0f5",E.coral="#ff7f50",E.purple="#800080",E.aqua="#00ffff",E.whitesmoke="#f5f5f5",E.mediumslateblue="#7b68ee",E.darkorange="#ff8c00",E.mediumaquamarine="#66cdaa",E.darksalmon="#e9967a",E.beige="#f5f5dc",E.blueviolet="#8a2be2",E.azure="#f0ffff",E.lightsteelblue="#b0c4de",E.oldlace="#fdf5e6"}).call(this);
/*!
 *
 *    kartograph - a svg mapping library 
 *    Copyright (C) 2011  Gregor Aisch
 *
 *    This program is free software: you can redistribute it and/or modify
 *    it under the terms of the GNU General Public License as published by
 *    the Free Software Foundation, either version 3 of the License, or
 *    (at your option) any later version.
 *
 *    This program is distributed in the hope that it will be useful,
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *    GNU General Public License for more details.
 *
 *    You should have received a copy of the GNU General Public License
 *    along with this program.  If not, see <http://www.gnu.org/licenses/>.
 *
 * 
 */
(function(){var aD,aB,az,ax,av,au,ar,ap,an,am,al,ak,aj,ai,ah,ag,af,ae,ad,ac,ab,aa,bZ,bY,bX,bW,bV,bU,bT,bS,bR,bQ,bP,bO,bN,a9,a7,a5,a3,a1,aZ,aX,aV,aT,aR,aP,aN,aG,a8,a6,a4,a2,a0,aY,aW,aU,aS,aQ,aO,aM,aL,aK,aJ,aI,aH,aF,aE,aC,aA,ay,aw,at,aq,ao,cc,cb,ca,b9,b8,b7,b6,b5,b4,b3,b2=Object.prototype.hasOwnProperty,b1=function(f,e){function g(){this.constructor=f}for(var h in e){b2.call(e,h)&&(f[h]=e[h])}g.prototype=e.prototype,f.prototype=new g,f.__super__=e.prototype;return f},b0=function(e,d){return function(){return e.apply(d,arguments)}};aJ=typeof exports!="undefined"&&exports!==null?exports:this,aU=(aA=aJ.kartograph)!=null?aA:aJ.kartograph={},az=function(){function b(g,f,j,i){var h;g==null&&(g=0),f==null&&(f=0),j==null&&(j=null),i==null&&(i=null),h=this,j===null?(h.xmin=Number.MAX_VALUE,h.xmax=Number.MAX_VALUE*-1):(h.xmin=h.left=g,h.xmax=h.right=g+j,h.width=j),i===null?(h.ymin=Number.MAX_VALUE,h.ymax=Number.MAX_VALUE*-1):(h.ymin=h.top=f,h.ymax=h.bottom=i+f,h.height=i);return}b.prototype.update=function(e,d){var f;d==null&&(d=e[1],e=e[0]),f=this,f.xmin=Math.min(f.xmin,e),f.ymin=Math.min(f.ymin,d),f.xmax=Math.max(f.xmax,e),f.ymax=Math.max(f.ymax,d),f.left=f.xmin,f.top=f.ymin,f.right=f.xmax,f.bottom=f.ymax,f.width=f.xmax-f.xmin,f.height=f.ymax-f.ymin;return this},b.prototype.intersects=function(d){return d.left<s.right&&d.right>s.left&&d.top<s.bottom&&d.bottom>s.top},b.prototype.inside=function(e,d){var f;f=this;return e>=f.left&&e<=f.right&&d>=f.top&&d<=f.bottom},b.prototype.join=function(e){var d;d=this,d.update(e.left,e.top),d.update(e.right,e.bottom);return this};return b}(),az.fromXML=function(g){var f,j,i,h;i=Number(g.getAttribute("x")),h=Number(g.getAttribute("y")),j=Number(g.getAttribute("w")),f=Number(g.getAttribute("h"));return new aU.BBox(i,h,j,f)},aU.BBox=az,"kartograph - a svg mapping library \nCopyright (C) 2011  Gregor Aisch\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.",aJ=typeof exports!="undefined"&&exports!==null?exports:this,aU=(ca=aJ.kartograph)!=null?ca:aJ.kartograph={},(b9=aU.geom)==null&&(aU.geom={}),(b8=(aE=aU.geom).clipping)==null&&(aE.clipping={}),al=function(){function i(){}var h,g,l,k,j;g=0,l=1,k=2,h=4,j=8,i.prototype.compute_out_code=function(n,f,q){var p,o;o=this,p=o.INSIDE,f<n.left?p|=o.LEFT:f>n.right&&(p|=o.RIGHT),q<n.top?p|=o.TOP:q>n.bottom&&(p|=o.BOTTOM);return p},i.prototype.clip=function(B,A,z,w,v){var u,t,r,q,p,o,n;p=this,t=p.compute_out_code(B,A,z),r=p.compute_out_code(B,w,v),u=False;while(True){if(!(t|r)){u=True;break}if(t&r){break}q=code===0?r:t,q&p.TOP?(o=A+(w-A)*(B.top-z)/(v-z),n=B.top):q&p.BOTTOM?(o=A+(w-A)*(B.bottom-z)/(v-z),n=B.bottom):q&p.RIGHT?(n=z+(v-z)*(B.right-A)/(w-A),o=B.right):q&p.LEFT&&(n=z+(v-z)*(B.left-A)/(w-A),o=B.left),q===t?(A=o,z=n,t=p.compute_out_code(B,A,z)):(w=o,v=n,r=p.compute_out_code(B,w,v))}return u?[A,z,w,v]:null};return i}(),aU.geom.clipping.CohenSutherland=al,aJ=typeof exports!="undefined"&&exports!==null?exports:this,aU=(b7=aJ.kartograph)!=null?b7:aJ.kartograph={},aW=(b6=aU.filter)!=null?b6:aU.filter={},af=function(){function b(d){this.params=d!=null?d:{}}b.prototype.getFilter=function(e){var d,f;f=this,d=f.SVG("filter",{id:e}),f.buildFilter(d);return d},b.prototype._getFilter=function(){throw"not implemented"},b.prototype.SVG=function(f,e){var h,g;typeof f=="string"&&(f=window.document.createElementNS("http://www.w3.org/2000/svg",f));if(e){for(h in e){g=e[h],f.setAttribute(h,g)}}return f};return b}(),au=function(){function b(){b.__super__.constructor.apply(this,arguments)}b1(b,af),b.prototype.buildFilter=function(f){var e,h,g;g=this,e=g.SVG,h=e("feGaussianBlur",{stdDeviation:g.params.size||4,result:"blur"});return f.appendChild(h)};return b}(),aW.blur=au,ad=function(){function b(){b.__super__.constructor.apply(this,arguments)}b1(b,af),b.prototype.buildFilter=function(G){var F,E,D,C,B,A,z,w,v,u,t,r,q,p;A=this,E=(r=A.params.blur)!=null?r:4,w=(q=A.params.strength)!=null?q:1,D=(p=A.params.color)!=null?p:"#D1BEB0",typeof D=="string"&&(D=chroma.hex(D)),z=D.rgb,C=(v=A.params.inner)!=null?v:!1,B=(u=A.params.knockout)!=null?u:!1,F=(t=A.params.alpha)!=null?t:1,C?A.innerGlow(G,E,w,z,F,B):A.outerGlow(G,E,w,z,F,B)},b.prototype.outerGlow=function(C,B,A,z,w,v){var u,t,r,q,p,o,n;p=this,u=p.SVG,q=u("feColorMatrix",{"in":"SourceGraphic",type:"matrix",values:"0 0 0 0 0   0 0 0 0 0   0 0 0 0 0   0 0 0 1 0",result:"mask"}),C.appendChild(q),A>0&&(n=u("feMorphology",{"in":"mask",radius:A,operator:"dilate",result:"mask"}),C.appendChild(n)),q=u("feColorMatrix",{"in":"mask",type:"matrix",values:"0 0 0 0 "+z[0]/255+" 0 0 0 0 "+z[1]/255+" 0 0 0 0 "+z[2]/255+"  0 0 0 1 0",result:"r0"}),C.appendChild(q),t=u("feGaussianBlur",{"in":"r0",stdDeviation:B,result:"r1"}),C.appendChild(t),r=u("feComposite",{operator:"out","in":"r1",in2:"mask",result:"comp"}),C.appendChild(r),o=u("feMerge"),v||o.appendChild(u("feMergeNode",{"in":"SourceGraphic"})),o.appendChild(u("feMergeNode",{"in":"r1"}));return C.appendChild(o)},b.prototype.innerGlow=function(C,B,A,z,w,v){var u,t,r,q,p,o,n;p=this,u=p.SVG,console.log("innerglow"),q=u("feColorMatrix",{"in":"SourceGraphic",type:"matrix",values:"0 0 0 0 0   0 0 0 0 0   0 0 0 0 0   0 0 0 500 0",result:"mask"}),C.appendChild(q),n=u("feMorphology",{"in":"mask",radius:A,operator:"erode",result:"r1"}),C.appendChild(n),t=u("feGaussianBlur",{"in":"r1",stdDeviation:B,result:"r2"}),C.appendChild(t),q=u("feColorMatrix",{type:"matrix","in":"r2",values:"1 0 0 0 "+z[0]/255+" 0 1 0 0 "+z[1]/255+" 0 0 1 0 "+z[2]/255+" 0 0 0 -1 "+w,result:"r3"}),C.appendChild(q),r=u("feComposite",{operator:"in","in":"r3",in2:"mask",result:"comp"}),C.appendChild(r),o=u("feMerge"),v||o.appendChild(u("feMergeNode",{"in":"SourceGraphic"})),o.appendChild(u("feMergeNode",{"in":"comp"}));return C.appendChild(o)};return b}(),aW.glow=ad,aJ=typeof exports!="undefined"&&exports!==null?exports:this,aU=aJ.$K=(b5=aJ.kartograph)!=null?b5:aJ.kartograph={},aU.version="0.4.4",aH=function(b){return console.warn("kartograph ("+aU.version+"): "+b)},aS=function(b){return console.log("kartograph ("+aU.version+"): "+b)},(b4=(aC=String.prototype).trim)==null&&(aC.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),Array.prototype.indexOf||(Array.prototype.indexOf=function(g){if(this==null){throw new TypeError}var f=Object(this),j=f.length>>>0;if(j===0){return -1}var i=0;arguments.length>0&&(i=Number(arguments[1]),i!=i?i=0:i!=0&&i!=Infinity&&i!=-Infinity&&(i=(i>0||-1)*Math.floor(Math.abs(i))));if(i>=j){return -1}var h=i>=0?i:Math.max(j-Math.abs(i),0);for(;h<j;h++){if(h in f&&f[h]===g){return h}}return -1}),bZ=function(){function b(g,f,j){var i,h;h=this,h.container=i=$(g),f==null&&(f=i.width()),j==null&&(j=i.height()),j===0&&(j=f*0.5),h.viewport=new aU.BBox(0,0,f,j),h.paper=h.createSVGLayer(),h.markers=[],h.pathById={},h.container.addClass("kartograph")}b.prototype.createSVGLayer=function(t){var r,q,p,o,n,l,k,j;o=this,(j=o._layerCnt)==null&&(o._layerCnt=0),p=o._layerCnt++,k=o.viewport,q=o.container,n=Raphael(q[0],k.width,k.height),l=$(n.canvas),l.css({position:"absolute",top:"0px",left:"0px","z-index":p+5}),q.css("position")==="static"&&q.css("position","relative"),l.addClass(t),r=$("desc",n.canvas).text(),$("desc",n.canvas).text(r.replace("with ","with kartograph "+aU.version+" and "));return n},b.prototype.createHTMLLayer=function(i){var h,o,n,l,k,j;l=this,k=l.viewport,h=l.container,(j=l._layerCnt)==null&&(l._layerCnt=0),n=l._layerCnt++,o=$('<div class="layer '+i+'" />'),o.css({position:"absolute",top:"0px",left:"0px",width:k.width+"px",height:k.height+"px","z-index":n+5}),h.append(o);return o},b.prototype.loadMap=function(h,g,l){var k,j,i;k=this,k.clear(),k.opts=l!=null?l:{},(i=(j=k.opts).zoom)==null&&(j.zoom=1),k.mapLoadCallback=g,$.ajax({url:h,dataType:$.browser.msie?"text":"xml",success:k.mapLoaded,context:k,error:function(e,d,f){return aH(e,d,f)}})},b.prototype.addLayer=function(C,B,A){var z,w,v,u,t,r,q,p,o,n;v=this,(n=v.layerIds)==null&&(v.layerIds=[]),(o=v.layers)==null&&(v.layers={}),type(C)==="object"?(u=C,C=u.id,B=u.className,A=u.key):u={},B==null&&(B=C),t=$("#"+C,v.svgSrc);if(t.length!==0){w=new bS(B,A,v,u.filter),z=$("*",t[0]);for(q=0,p=z.length;q<p;q++){r=z[q],w.addPath(r)}w.paths.length>0&&(v.layers[B]=w,v.layerIds.push(B))}},b.prototype.getLayerPath=function(e,d){var f;f=this;return f.layers[e]!=null&&f.layers[e].hasPath(d)?f.layers[e].getPath(d):null},b.prototype.onLayerEvent=function(z,w,v){var u,t,r,q,p,o,n,l;r=this,r,v==null&&(v=r.layerIds[r.layerIds.length-1]),u=function(){function d(f,e,g){this.type=f,this.cb=e,this.map=g,this.handle=b0(this.handle,this)}d.prototype.handle=function(f){var e;r=this,e=r.map.pathById[f.target.getAttribute("id")];return r.cb(e.data)};return d}(),t=new u(z,w,r);if(r.layers[v]!=null){p=r.layers[v].paths,l=[];for(o=0,n=p.length;o<n;o++){q=p[o],l.push($(q.svgPath.node).bind(z,t.handle))}return l}},b.prototype.addMarker=function(e){var d,f;d=this,d.markers.push(e),f=d.viewBC.project(d.viewAB.project(d.proj.project(e.lonlat.lon,e.lonlat.lat)));return e.render(f[0],f[1],d.container,d.paper)},b.prototype.clearMarkers=function(){var g,f,j,i,h;f=this,h=f.markers;for(j=0,i=h.length;j<i;j++){g=h[j],g.clear()}return f.markers=[]},b.prototype.choropleth=function(Y){var X,W,V,U,T,S,R,Q,P,O,N,M,L,J,I,H,G,F,E,D,C,B,A,z;N=this,O=(z=Y.layer)!=null?z:N.layerIds[N.layerIds.length-1];if(!N.layers.hasOwnProperty(O)){aH('choropleth error: layer "'+layer_ihad+'" not found')}else{U=Y.data,T=Y.value,S=Y.key,V=Y.colors,J={};if(S!=null&&type(U)==="array"){for(F=0,D=U.length;F<D;F++){G=U[F],P=G[S],J[P]=G}}else{for(P in U){G=U[P],J[P]=G}}B=N.layers[O].pathsById;for(P in B){I=B[P];for(E=0,C=I.length;E<C;E++){L=I[E],H=(A=J[P])!=null?A:null,W=V(H),Y.duration!=null?(type(Y.duration)==="function"?Q=Y.duration(H):Q=Y.duration,Y.delay!=null?type(Y.delay)==="function"?R=Y.delay(H):R=Y.delay:R=0,M=V(null),L.svgPath.attr("fill",M),X=Raphael.animation({fill:W},Q),L.svgPath.animate(X.delay(R))):L.svgPath.attr("fill",W)}}}},b.prototype.tooltips=function(B){var A,z,w,v,u,t,r,q,p,o,n;v=this,r=B.content,w=(o=B.layer)!=null?o:v.layerIds[v.layerIds.length-1];if(!v.layers.hasOwnProperty(w)){aH('tooltips error: layer "'+w+'" not found')}else{p=v.layers[w].pathsById,n=[];for(z in p){t=p[z],n.push(function(){var f,h,g;g=[];for(f=0,h=t.length;f<h;f++){u=t[f],$.isFunction(r)?q=r(z,u):q=r[z],q!=null?(A={position:{target:"mouse",viewport:$(window),adjust:{x:7,y:7}},show:{delay:20},content:{}},typeof q=="string"?A.content.text=q:$.isArray(q)&&(A.content.title=q[0],A.content.text=q[1]),g.push($(u.svgPath.node).qtip(A))):g.push(void 0)}return g}())}return n}},b.prototype.fadeIn=function(B){var A,z,w,v,u,t,r,q,p,o,n;B==null&&(B={}),u=this,v=(o=B.layer)!=null?o:u.layerIds[u.layerIds.length-1],z=(q=B.duration)!=null?q:500,p=u.layers[v].pathsById,n=[];for(w in p){r=p[w],n.push(function(){var f,h,g;g=[];for(f=0,h=r.length;f<h;f++){t=r[f],type(z)==="function"?A=z(t.data):A=z,t.svgPath.attr("opacity",0),g.push(t.svgPath.animate({opacity:1},A))}return g}())}return n},b.prototype.mapLoaded=function(z){var w,v,u,t,r,q,p,o,n,l;t=this,$.browser.msie&&(z=$(z)),t.svgSrc=z,p=t.viewport,w=$("view",z)[0],t.viewAB=v=aU.View.fromXML(w),r=(l=t.opts.padding)!=null?l:0,u=(o=t.opts.halign)!=null?o:"center",q=(n=t.opts.valign)!=null?n:"center",t.viewBC=new aU.View(v.asBBox(),p.width,p.height,r,u,q),t.proj=aU.Proj.fromXML($("proj",w)[0]);return t.mapLoadCallback(t)},b.prototype.loadCoastline=function(){var d;d=this;return $.ajax({url:"coastline.json",success:d.renderCoastline,context:d})},b.prototype.resize=function(){var E,D,C,B,A,z,w,v,u,t,r,q,p,o;A=this,E=A.container,A.viewport=v=new aU.BBox(0,0,E.width(),E.height()),A.paper.setSize(v.width,v.height),v=A.viewport,z=(p=A.opts.padding)!=null?p:0,D=(t=A.opts.halign)!=null?t:"center",w=(r=A.opts.valign)!=null?r:"center",u=A.opts.zoom,A.viewBC=new aU.View(A.viewAB.asBBox(),v.width*u,v.height*u,z,D,w),q=A.layers,o=[];for(C in q){B=q[C],o.push(B.setView(A.viewBC))}return o},b.prototype.addFilter=function(h,g,l){var k,j,i;l==null&&(l={}),i=this,k=window.document;if(aU.filter[g]!=null){j=(new aU.filter[g](l)).getFilter(h)}else{throw"unknown filter type "+g}return i.paper.defs.appendChild(j)},b.prototype.applyFilter=function(e,d){var f;f=this;return $(".polygon."+e,f.paper.canvas).attr({filter:"url(#"+d+")"})},b.prototype.lonlat2xy=function(e){var d,f;f=this,e.length===2&&(e=new aU.LonLat(e[0],e[1])),e.length===3&&(e=new aU.LonLat(e[0],e[1],e[2])),d=f.proj.project(e.lon,e.lat,e.alt);return f.viewBC.project(f.viewAB.project(d))},b.prototype.addGeoPath=function(z,w,v){var u,t,r,q,p,o,n,l;w==null&&(w=[]),v==null&&(v=""),r=this,w.length===0&&w.push("M"),p="";for(t in z){o=z[t],u=(l=w[t])!=null?l:"L",n=r.lonlat2xy(o),p+=u+n[0]+","+n[1]}q=r.paper.path(p),q.node.setAttribute("class",v)},b.prototype.showZoomControls=function(){var d;d=this,d.zc=new a9(d);return d},b.prototype.addSymbolGroup=function(e){var d,f;d=this,(f=d.symbolGroups)==null&&(d.symbolGroups=[]);return d.symbolGroups.push(e)},b.prototype.clear=function(){var h,g,l,k,j,i;g=this;if(g.layers!=null){for(h in g.layers){g.layers[h].remove()}g.layers={},g.layerIds=[]}if(g.symbolGroups!=null){i=g.symbolGroups;for(k=0,j=i.length;k<j;k++){l=i[k],l.remove()}return g.symbolGroups=[]}},b.prototype.loadStyles=function(e,d){var f;f=this;if($.browser.msie){return $.ajax({url:e,dataType:"text",success:function(g){f.styles=aU.parsecss(g);return d()},error:function(a,h,g){return aH("error while loading "+e,a,h,g)}})}$("body").append('<link rel="stylesheet" href="'+e+'" />');return d()},b.prototype.applyStyles=function(L){var J,I,H,G,F,E,D,C,B,A,z,w,v,u,t,r;G=this;if(G.styles==null){return L}(r=G._pathTypes)==null&&(G._pathTypes=["path","circle","rectangle","ellipse"]),(v=G._regardStyles)==null&&(G._regardStyles=["fill","stroke","fill-opacity","stroke-width","stroke-opacity"]),J=L.node.getAttribute("class");for(D in G.styles){F=D,u=F.split(",");for(B=0,z=u.length;B<z;B++){C=u[B],F=C.split(" "),F=F[F.length-1],F=F.split(":");if(F.length>1){continue}F=F[0].split("."),I=F.slice(1);if(I.length>0&&I.indexOf(J)<0){continue}F=F[0];if(G._pathTypes.indexOf(F)>=0&&F!==L.type){continue}E=G.styles[D],t=G._regardStyles;for(A=0,w=t.length;A<w;A++){H=t[A],E[H]!=null&&L.attr(H,E[H])}}}return L};return b}(),aU.Kartograph=bZ,aU.map=function(e,d,f){return new bZ(e,d,f)},bS=function(){function b(g,f,j,i){var h;h=this,h.id=g,h.path_id=f,h.paper=j.paper,h.view=j.viewBC,h.map=j,h.filter=i}b.prototype.addPath=function(j){var i,q,p,o,n,l,k;q=this,(k=q.paths)==null&&(q.paths=[]),i=new bR(j,q.id,q.map);if(type(q.filter)==="function"&&q.filter(i.data)===!1){i.remove()}else{q.paths.push(i);if(q.path_id!=null){(n=q.pathsById)==null&&(q.pathsById={}),(l=(p=q.pathsById)[o=i.data[q.path_id]])==null&&(p[o]=[]);return q.pathsById[i.data[q.path_id]].push(i)}}},b.prototype.hasPath=function(e){var d;d=this;return d.pathsById!=null&&d.pathsById[e]!=null},b.prototype.getPath=function(e){var d;d=this;if(d.hasPath(e)){return d.pathsById[e][0]}throw"path "+e+" not found"},b.prototype.setView=function(i){var h,o,n,l,k,j;h=this,k=h.paths,j=[];for(n=0,l=k.length;n<l;n++){o=k[n],j.push(o.setView(i))}return j},b.prototype.remove=function(){var h,g,l,k,j,i;h=this,j=h.paths,i=[];for(l=0,k=j.length;l<k;l++){g=j[l],i.push(g.remove())}return i};return b}(),aQ=0,bR=function(){function b(B,A,z){var w,v,u,t,r,q,p,o,n;t=this,r=z.paper,o=z.viewBC,t.path=q=aU.geom.Path.fromSVG(B),t.svgPath=o.projectPath(q).toSVG(r),t.svgPath.node.setAttribute("class",A),z.applyStyles(t.svgPath),p="path_"+aQ++,t.svgPath.node.setAttribute("id",p),z.pathById[p]=t,v={};for(u=0,n=B.attributes.length-1;0<=n?u<=n:u>=n;0<=n?u++:u--){w=B.attributes[u],w.name.substr(0,5)==="data-"&&(v[w.name.substr(5)]=w.value)}t.data=v}b.prototype.setView=function(f){var e,h,g;e=this,h=f.projectPath(e.path);if(e.path.type==="path"){g=h.svgString();return e.svgPath.attr({path:g})}if(e.path.type==="circle"){return e.svgPath.attr({cx:h.x,cy:h.y,r:h.r})}},b.prototype.remove=function(){var d;d=this;return d.svgPath.remove()};return b}(),an=function(){function b(g,f,j,i){var h;h=this,h.layer_id=g,h.canvas=f,h.view=j,h.renderCallback=i}b.prototype.addPath=function(f){var e,h,g;e=this,(g=e.paths)==null&&(e.paths=[]),h=aU.geom.Path.fromSVG(f);return e.paths.push(h)},b.prototype.render=function(){var h,g,l,k,j,i;h=this,l=[],i=h.paths;for(k=0,j=i.length;k<j;k++){g=i[k],l.push(h.view.projectPath(g))}return h.renderCallback(h,l)},b.prototype.drawPaths=function(){var t,r,q,p,o,n,l,k,j;q=this,t=q.canvas.getContext("2d"),k=q.paths,j=[];for(n=0,l=k.length;n<l;n++){p=k[n],p=q.view.projectPath(p),j.push(function(){var i,e,d,a;d=p.contours,a=[];for(i=0,e=d.length;i<e;i++){r=d[i],r.reverse(),a.push(function(){var u,h,g;g=[];for(u=0,h=r.length;u<h;u++){o=r[u],o===r[0]?g.push(t.moveTo(o[0],o[1])):g.push(t.lineTo(o[0],o[1]))}return g}())}return a}())}return j};return b}(),a9=function(){function b(t){this.zoomOut=b0(this.zoomOut,this),this.zoomIn=b0(this.zoomIn,this);var r,q,p,o,n,l,k,j;o=this,o.map=t,r=t.container,q=function(h,g){var w,v,u,i;g==null&&(g=[]),v=$('<div class="'+h+'" />');for(u=0,i=g.length;u<i;u++){w=g[u],v.append(w)}return v},p=function(d){return $(d.target).addClass("md")},n=function(d){return $(d.target).removeClass("md")},j=q("plus"),j.mousedown(p),j.mouseup(n),j.click(o.zoomIn),k=q("minus"),k.mousedown(p),k.mouseup(n),k.click(o.zoomOut),l=q("zoom-control",[j,k]),r.append(l)}b.prototype.zoomIn=function(e){var d;d=this,d.map.opts.zoom+=1;return d.map.resize()},b.prototype.zoomOut=function(e){var d;d=this,d.map.opts.zoom-=1,d.map.opts.zoom<1&&(d.map.opts.zoom=1);return d.map.resize()};return b}(),aJ=typeof exports!="undefined"&&exports!==null?exports:this,aU=(b3=aJ.kartograph)!=null?b3:aJ.kartograph={},bU=function(){function b(e,d,f){f==null&&(f=0),this.lon=Number(e),this.lat=Number(d),this.alt=Number(f)}b.prototype.distance=function(v){var u,t,r,q,p,o,n,l,k;k=this,u=6371,o=Math.PI/180,q=(v.lat-k.lat)*o,p=(v.lon-k.lon)*o,n=k.lat*o,l=v.lat*o,t=Math.sin(q/2)*Math.sin(q/2)+Math.sin(p/2)*Math.sin(p/2)*Math.cos(n)*Math.cos(l),r=2*Math.atan2(Math.sqrt(t),Math.sqrt(1-t));return u*r};return b}(),bW=function(){function b(a,f,e){e==null&&(e=0),b.__super__.constructor.call(this,f,a,e)}b1(b,bU);return b}(),aU.LonLat=bU,aU.LatLon=bW,aJ=typeof exports!="undefined"&&exports!==null?exports:this,aU=(ay=aJ.kartograph)!=null?ay:aJ.kartograph={},(aw=aU.marker)==null&&(aU.marker={}),a4=function(){function b(bq){var bp,bo,bn,bm,bl,bk,bj,bi,bh,bg,bf,be,bd,bc,ba,Y,W,U,S,Q,O,M,J,a,bb,Z,X,V,T,R,P,N,L=this;bj=this,be=["data","location","type","map"],bg=["filter","tooltip","layout","group","click"];for(bc=0,U=be.length;bc<U;bc++){bf=be[bc];if(bq[bf]!=null){bj[bf]=bq[bf]}else{throw"SymbolGroup: missing argument "+bf}}for(ba=0,S=bg.length;ba<S;ba++){bf=bg[ba],bq[bf]!=null&&(bj[bf]=bq[bf])}type(bj.type)==="string"?bp=K[bj.type]:bp=bj.type,V=bp.props;for(Y=0,Q=V.length;Y<Q;Y++){bf=V[Y],bq[bf]!=null&&(bj[bf]=bq[bf])}bj.layers={mapcanvas:bj.map.paper},T=bp.layers;for(W=0,O=T.length;W<O;W++){bl=T[W],bi=b._layerid++,bm="sl_"+bi,bl.type==="svg"?bk=bj.map.createSVGLayer(bm):bl.type==="html"&&(bk=bj.map.createHTMLLayer(bm)),bj.layers[bl.id]=bk}bj.symbols=[];for(bn in bj.data){bo=bj.data[bn],type(bj.filter)==="function"?bj.filter(bo)&&bj.addSymbol(bo):bj.addSymbol(bo)}bj.layoutSymbols(),R=bj.symbols;for(bb=0,M=R.length;bb<M;bb++){bd=R[bb],bd.render()}type(bj.tooltip)==="function"&&bj.initTooltips();if(type(bj.click)==="function"){P=bj.symbols;for(Z=0,J=P.length;Z<J;Z++){bd=P[Z],N=bd.nodes();for(X=0,a=N.length;X<a;X++){bh=N[X],bh.symbol=bd,$(bh).click(function(d){d.stopPropagation();return bj.click(d.target.symbol.data)})}}}bj.map.addSymbolGroup(bj)}b.prototype.addSymbol=function(v){var u,t,r,q,p,o,n,l,k;r=this,u=r.type,t=r.evaluate(r.location,v),type(t)==="array"&&(t=new aU.LonLat(t[0],t[1])),p={layers:r.layers,location:t,data:v,map:r.map},k=u.props;for(n=0,l=k.length;n<l;n++){q=k[n],r[q]!=null&&(p[q]=r.evaluate(r[q],v))}o=new u(p),r.symbols.push(o);return o},b.prototype.evaluate=function(e,d){var f;return type(e)==="function"?f=e(d):f=e},b.prototype.layoutSymbols=function(){var z,w,v,u,t,r,q,p,o,n,l;v=this,n=v.symbols;for(p=0,o=n.length;p<o;p++){r=n[p],w=r.location;if(type(w)==="string"){l=w.split("."),z=l[0],t=l[1],u=v.map.getLayerPath(z,t);if(u!=null){q=v.map.viewBC.project(u.path.centroid())}else{continue}}else{q=v.map.lonlat2xy(w)}r.x=q[0],r.y=q[1]}if(v.layout==="group"){return v.groupLayout()}},b.prototype.groupLayout=function(){var e,d,f;e=this,(f=e.gsymbols)==null&&(e.gsymbols=[]);return d=!0},b.prototype.initTooltips=function(){var B,A,z,w,v,u,t,r,q,p,o,n;A=this,v=A.tooltip,o=A.symbols;for(t=0,q=o.length;t<q;t++){w=o[t],B={position:{target:"mouse",viewport:$(window),adjust:{x:7,y:7}},show:{delay:20},content:{}},u=v(w.data),type(u)==="string"?B.content.text=u:type(u)==="array"&&(B.content.title=u[0],B.content.text=u[1]),n=w.nodes();for(r=0,p=n.length;r<p;r++){z=n[r],$(z).qtip(B)}}},b.prototype.remove=function(){var t,r,q,p,o,n,l,k,j;q=this,l=q.symbols;for(o=0,n=l.length;o<n;o++){p=l[o],p.clear()}k=q.layers,j=[];for(t in k){r=k[t],t!=="mapcanvas"?j.push(r.remove()):j.push(void 0)}return j};return b}(),a4._layerid=0,aU.SymbolGroup=a4,a6=function(){function b(e){var d;d=this,d.location=e.location,d.data=e.data,d.map=e.map,d.layers=e.layers,d.x=e.x,d.y=e.y}b.prototype.init=function(){},b.prototype.overlaps=function(d){return !1},b.prototype.nodes=function(){return[]},b.prototype.clear=function(){};return b}(),ar=function(){function b(a){var j,i,h,g;j=this,b.__super__.constructor.call(this,a),j.radius=(i=a.radius)!=null?i:4,j.style=(h=a.style)!=null?h:"",j["class"]=(g=a["class"])!=null?g:""}b1(b,a6),b.prototype.overlaps=function(B){var A,z,w,v,u,t,r,q,p,o,n;w=this,o=[w.x,w.y,w.radius],t=o[0],q=o[1],v=o[2],n=[B.x,B.y,B.radius],r=n[0],p=n[1],u=n[2];if(t-v>r+u||t+v<r-u||q-v>p+u||q+v<p-u){return !1}A=t-r,z=q-p;return A*A+z*z>(v+u)*(v+u)?!1:!0},b.prototype.render=function(e){var d;d=this,d.path=d.layers.a.circle(d.x,d.y,d.radius),d.update(),d.map.applyStyles(d.path);return d},b.prototype.update=function(){var e,d;e=this,e.path.attr({x:e.x,y:e.y,r:e.radius}),d=e.path,d.node.setAttribute("style",e.style),d.node.setAttribute("class",e["class"]);return e},b.prototype.clear=function(){var d;d=this,d.path.remove();return d},b.prototype.nodes=function(){var d;d=this;return[d.path.node]};return b}(),ar.props=["radius","style","class"],ar.layers=[{id:"a",type:"svg"}],aU.Bubble=ar,ab=function(){function b(a){var j,i,h,g;j=this,b.__super__.constructor.call(this,a),j.text=(i=a.text)!=null?i:"",j.style=(h=a.style)!=null?h:"",j["class"]=(g=a["class"])!=null?g:""}b1(b,a6),b.prototype.render=function(f){var e,h,g;g=this,e=$("<div>"+g.text+"</div>"),e.css({width:"50px",position:"absolute",left:"-25px","text-align":"center"}),g.lbl=h=$('<div class="label" />'),h.append(e),g.layers.lbl.append(h),e.css({height:e.height()+"px",top:e.height()*-0.4+"px"}),g.update();return g},b.prototype.update=function(){var d;d=this;return d.lbl.css({position:"absolute",left:d.x+"px",top:d.y+"px"})},b.prototype.clear=function(){var d;d=this,d.lbl.remove();return d},b.prototype.nodes=function(){var d;d=this;return[d.lbl[0]]};return b}(),ab.props=["text","style","class"],ab.layers=[{id:"lbl",type:"html"}],aU.HtmlLabel=ab,a8=function(){function b(a){var j,i,h,g;j=this,b.__super__.constructor.call(this,a),j.text=(i=a.text)!=null?i:"",j.style=(h=a.style)!=null?h:"",j["class"]=(g=a["class"])!=null?g:""}b1(b,a6),b.prototype.render=function(e){var d,f;f=this,f.lbl=d=f.layers.mapcanvas.text(f.x,f.y,f.text),f.update();return f},b.prototype.update=function(){var d;d=this,d.lbl.attr({x:d.x,y:d.y}),d.lbl.node.setAttribute("style",d.style);return d.lbl.node.setAttribute("class",d["class"])},b.prototype.clear=function(){var d;d=this,d.lbl.remove();return d},b.prototype.nodes=function(){var d;d=this;return[d.lbl.node]};return b}(),a8.props=["text","style","class"],a8.layers=[],aU.Label=a8,aa=function(){function b(a){var l,k,j,i,h;l=this,b.__super__.constructor.call(this,a),l.icon=(k=a.icon)!=null?k:"",l.offset=(j=a.offset)!=null?j:[0,0],l["class"]=(i=a["class"])!=null?i:"",l.title=(h=a.title)!=null?h:""}b1(b,a6),b.prototype.render=function(e){var d,f;f=this,d=f.map.container,f.img=$('<img src="'+f.icon+'" title="'+f.title+'" alt="'+f.title+'" class="'+f["class"]+'" />'),f.img.css({position:"absolute","z-index":1000,cursor:"pointer"}),f.img[0].symbol=f,d.append(f.img);return f.update()},b.prototype.update=function(){var d;d=this;return d.img.css({left:d.x+d.offset[0]+"px",top:d.y+d.offset[1]+"px"})},b.prototype.clear=function(){var d;d=this,d.img.remove();return d},b.prototype.nodes=function(){var d;d=this;return[d.img]};return b}(),aa.props=["icon","offset","class","title"],aa.layers=[],aU.Icon=aa,aJ=typeof exports!="undefined"&&exports!==null?exports:this,aU=(at=aJ.kartograph)!=null?at:aJ.kartograph={},aU.parsecss=function(v,u){var t,r,q,p,o,n,l,k;p={},v=aO(v),k=v.split("`b%");for(n=0,l=k.length;n<l;n++){t=k[n],t=t.split("%b`");if(t.length<2){continue}t[0]=aK(t[0]),q=aL(t[1]);if(p[t[0]]!=null){for(r in q){o=q[r],p[t[0]][r]=o}}else{p[t[0]]=q}}if(type(u)==="function"){u(p)}else{return p}},aM={},aL=function(i){var h,o,n,l,k,j;n=aM[i].replace(/^{|}$/g,""),n=aO(n),o={},j=n.split(";");for(l=0,k=j.length;l<k;l++){h=j[l],h=h.split(":");if(h.length<2){continue}o[aK(h[0])]=aK(h.slice(1).join(":"))}return o},aZ=/{[^{}]*}/,aV=/\[[^\[\]]*\]|{[^{}]*}|\([^()]*\)|function(\s+\w+)?(\s*%b`\d+`b%){2}/,aX=/(?:\/\*(?:[^\*]|\*[^\/])*\*\/)|(\\.|"(?:[^\\\"]|\\.|\\\n)*"|'(?:[^\\\']|\\.|\\\n)*')/g,aT=/%\w`(\d+)`\w%/,aI=0,aO=function(g,f){var j,i,h;g=g.replace(aX,function(e,d){var k;if(!d){return""}k="%s`"+ ++aI+"`s%",aM[aI]=d.replace(/^\\/,"");return k}),j=f?aV:aZ;while(i=j.exec(g)){h="%b`"+ ++aI+"`b%",aM[aI]=i[0],g=g.replace(j,h)}return g},aK=function(e){var d;if(e==null){return e}while(d=aT.exec(e)){e=e.replace(aT,aM[d[1]])}return e.trim()},aJ=typeof exports!="undefined"&&exports!==null?exports:this,aU=(aq=aJ.kartograph)!=null?aq:aJ.kartograph={},(ao=aU.geom)==null&&(aU.geom={}),a7=function(){function b(f,e,h){var g;h==null&&(h=!0),g=this,g.type=f,g.contours=e,g.closed=h}b.prototype.clipToBBox=function(d){throw"path clipping is not implemented yet"},b.prototype.toSVG=function(e){var d;d=this.svgString();return e.path(d)},b.prototype.svgString=function(){var C,B,A,z,w,v,u,t,r,q,p,o,n;z=this,w="",A=z.closed?"Z M":"M",o=z.contours;for(t=0,q=o.length;t<q;t++){C=o[t],B=!0,w+=w===""?"M":A;for(r=0,p=C.length;r<p;r++){n=C[r],v=n[0],u=n[1],B||(w+="L"),w+=v+","+u,B=!1}}z.closed&&(w+="Z");return w},b.prototype.area=function(){var j,i,q,p,o,n,l,k;p=this;if(p.areas!=null){return p._area}p.areas=[],p._area=0,l=p.contours;for(o=0,n=l.length;o<n;o++){i=l[o],j=0;for(q=0,k=i.length-2;0<=k?q<=k:q>=k;0<=k?q++:q--){j+=i[q][0]*i[q+1][1]-i[q+1][0]*i[q][1]}j*=0.5,j=j,p.areas.push(j),p._area+=j}return p._area},b.prototype.centroid=function(){var C,B,A,z,w,v,u,t,r,q,p,o,n;r=this;if(r._centroid!=null){return r._centroid}B=r.area(),z=w=0;for(v=0,o=r.contours.length-1;0<=o?v<=o:v>=o;0<=o?v++:v--){A=r.contours[v],C=r.areas[v],q=p=0;for(u=0,n=A.length-2;0<=n?u<=n:u>=n;0<=n?u++:u--){t=A[u][0]*A[u+1][1]-A[u+1][0]*A[u][1],q+=(A[u][0]+A[u+1][0])*t,p+=(A[u][1]+A[u+1][1])*t}t=1/(6*C),q*=t,p*=t,t=C/B,z+=q*t,w+=p*t}r._centroid=[z,w];return r._centroid};return b}(),aU.geom.Path=a7,am=function(){function b(a,f,e){this.x=a,this.y=f,this.r=e,b.__super__.constructor.call(this,"circle",null,!0)}b1(b,a7),b.prototype.toSVG=function(e){var d;d=this;return e.circle(d.x,d.y,d.r)},b.prototype.centroid=function(){var d;d=this;return[d.x,d.y]},b.prototype.area=function(){var d;d=this;return Math.PI*d.r*m.r};return b}(),aU.geom.Circle=am,a7.fromSVG=function(U){var T,S,R,Q,P,O,N,M,L,J,I,H,G,F,E,D,C,B,A,z,w;Q=[],H=U.nodeName,J=null;if(H==="path"){N=U.getAttribute("d").trim(),T=N[N.length-1]==="Z",I=T?"Z M":"M",N=N.substring(1,N.length-(T?1:0)),A=N.split(I);for(E=0,C=A.length;E<C;E++){R=A[E],S=[];if(R!==""){z=R.split("L");for(D=0,B=z.length;D<B;D++){M=z[D],w=M.split(","),G=w[0],F=w[1],S.push([Number(G),Number(F)])}Q.push(S)}}J=new aU.geom.Path(H,Q,T)}else{H==="circle"&&(P=U.getAttribute("cx"),O=U.getAttribute("cy"),L=U.getAttribute("r"),J=new aU.geom.Circle(P,O,L))}return J},bV=function(){function b(d){this.points=d}b.prototype.clipToBBox=function(Q){var P,O,N,M,L,J,I,H,G,F,E,D,C,B,A,z,w,v;F=this,P=(new aU.geom.clipping.CohenSutherland).clip,G=[],M=[],N=!1;for(O=0,A=F.points.length-2;0<=A?O<=A:O>=A;0<=A?O++:O--){z=F.points[O],L=z[0],J=z[1],w=F.points[O+1],I=w[0],H=w[1];try{v=P(Q,L,J,I,H),E=v[0],C=v[1],D=v[2],B=v[3],N=!0,G.push([E,C]),(I!==D||H!==C||O===len(F.points)-2)&&G.push([D,B])}catch(a){N&&G.length>1&&(M.push(new b(G)),G=[]),N=!1}}G.length>1&&M.push(new b(G));return M},b.prototype.toSVG=function(){var j,i,q,p,o,n,l,k;i=this,j=[],l=i.points;for(o=0,n=l.length;o<n;o++){k=l[o],q=k[0],p=k[1],j.push(q+","+p)}return"M"+j.join("L")};return b}(),aU.geom.Line=bV,aJ=typeof exports!="undefined"&&exports!==null?exports:this,aU=(cc=aJ.kartograph)!=null?cc:aJ.kartograph={},aF=aU.proj={},Function.prototype.bind=function(e){var d;d=this;return function(){return d.apply(e,arguments)}},a5=function(){function b(f){var e,h,g;e=this,e.lon0=(h=f.lon0)!=null?h:0,e.lat0=(g=f.lat0)!=null?g:0,e.PI=Math.PI,e.HALFPI=e.PI*0.5,e.QUARTERPI=e.PI*0.25,e.RAD=e.PI/180,e.DEG=180/e.PI,e.lam0=e.rad(this.lon0),e.phi0=e.rad(this.lat0),e.minLat=-90,e.maxLat=90}b.prototype.rad=function(d){return d*this.RAD},b.prototype.deg=function(d){return d*this.DEG},b.prototype.plot=function(C,B){var A,z,w,v,u,t,r,q,p,o,n;B==null&&(B=!0),v=[],A=!0;for(q=0,p=C.length;q<p;q++){o=C[q],w=o[0],z=o[1],u=this._visible(w,z),u&&(A=!1),n=this.project(w,z),t=n[0],r=n[1],!u&&B?v.push(this._truncate(t,r)):v.push([t,r])}return A?null:[v]},b.prototype.sea=function(){var v,u,t,r,q,p,o,n,l,k;p=this,q=p.project.bind(this),r=[],v=p.lon0,p.lon0=0;for(t=-180;t<=180;t++){r.push(q(t,p.maxLat))}for(u=o=p.maxLat,n=p.minLat;o<=n?u<=n:u>=n;o<=n?u++:u--){r.push(q(180,u))}for(t=180;t>=-180;t--){r.push(q(t,p.minLat))}for(u=l=p.minLat,k=p.maxLat;l<=k?u<=k:u>=k;l<=k?u++:u--){r.push(q(-180,u))}p.lon0=v;return r},b.prototype.world_bbox=function(){var h,g,l,k,j,i;g=this.project.bind(this),k=this.sea(),h=new aU.BBox;for(j=0,i=k.length;j<i;j++){l=k[j],h.update(l[0],l[1])}return h},b.prototype.toString=function(){var d;d=this;return"[Proj: "+d.name+"]"};return b}(),a5.fromXML=function(i){var h,o,n,l,k,j;n=i.getAttribute("id"),l={};for(o=0,j=i.attributes.length-1;0<=j?o<=j:o>=j;0<=j?o++:o--){h=i.attributes[o],h.name!=="id"&&(l[h.name]=h.value)}k=new aU.proj[n](l),k.name=n;return k},aU.Proj=a5,aj=function(){function b(a){var f,e;f=this,f.flip=Number(a.flip)||0,f.flip===1&&(a.lon0=(e=-a.lon0)!=null?e:0),b.__super__.constructor.call(this,a)}b1(b,a5),b.prototype._visible=function(e,d){return !0},b.prototype.clon=function(d){d-=this.lon0,d<-180?d+=360:d>180&&(d-=360);return d},b.prototype.ll=function(e,d){return this.flip===1?[-e,-d]:[e,d]};return b}(),ag=function(){function b(){b.__super__.constructor.apply(this,arguments)}b1(b,aj),b.prototype.project=function(e,d){var f;f=this.ll(e,d),e=f[0],d=f[1],e=this.clon(e);return[e*Math.cos(this.phi0)*1000,d*-1*1000]};return b}(),aF.lonlat=ag,ap=function(){function b(a){var d;b.__super__.constructor.call(this,a),this.lat1=(d=a.lat1)!=null?d:0,this.phi1=this.rad(this.lat1)}b1(b,aj),b.prototype.project=function(i,h){var o,n,l,k,j;j=this.ll(i,h),i=j[0],h=j[1],o=this.rad(this.clon(i)),n=this.rad(h*-1),l=o*Math.cos(this.phi1),k=Math.sin(n)/Math.cos(this.phi1);return[l*1000,k*1000]};return b}(),aF.cea=ap,ae=function(){function b(a,d){b.__super__.constructor.call(this,a,45)}b1(b,ap);return b}(),aF.gallpeters=ae,ac=function(){function b(a){a.lat0=37.7,b.__super__.constructor.call(this,a)}b1(b,ap);return b}(),aF.hobodyer=ac,av=function(){function b(a){a.lat0=30,b.__super__.constructor.call(this,a)}b1(b,ap);return b}(),aF.behrmann=av,ax=function(){function b(a){a.lat0=50,b.__super__.constructor.call(this,a)}b1(b,ap);return b}(),aF.balthasart=ax,bQ=function(){function b(a){b.__super__.constructor.call(this,a),this.minLat=-85,this.maxLat=85}b1(b,aj),b.prototype.project=function(t,r){var q,p,o,n,l,k,j;n=this,j=n.ll(t,r),t=j[0],r=j[1],p=Math,q=n.rad(n.clon(t)),o=n.rad(r*-1),l=q*1000,k=p.log((1+p.sin(o))/p.cos(o))*1000;return[l,k]};return b}(),aF.mercator=bQ,a1=function(){function b(){b.__super__.constructor.apply(this,arguments)}b1(b,aj);return b}(),bO=function(){function b(a){var d;b.__super__.constructor.call(this,a),d=this,d.A0=0.8707,d.A1=-0.131979,d.A2=-0.013791,d.A3=0.003971,d.A4=-0.001529,d.B0=1.007226,d.B1=0.015085,d.B2=-0.044475,d.B3=0.028874,d.B4=-0.005916,d.C0=d.B0,d.C1=3*d.B1,d.C2=7*d.B2,d.C3=9*d.B3,d.C4=11*d.B4,d.EPS=1e-11,d.MAX_Y=0.8707*0.52*Math.PI;return}b1(b,a1),b.prototype.project=function(v,u){var t,r,q,p,o,n,l,k;o=this,k=o.ll(v,u),v=k[0],u=k[1],t=o.rad(o.clon(v)),r=o.rad(u*-1),q=r*r,p=q*q,n=t*(o.A0+q*(o.A1+q*(o.A2+p*q*(o.A3+q*o.A4))))*180+500,l=r*(o.B0+q*(o.B1+p*(o.B2+o.B3*q+o.B4*p)))*180+270;return[n,l]};return b}(),aF.naturalearth=bO,aR=function(){function b(a){var d;b.__super__.constructor.call(this,a),d=this,d.X=[1,-5.67239e-12,-0.0000715511,0.00000311028,0.9986,-0.000482241,-0.000024897,-0.00000133094,0.9954,-0.000831031,-0.000044861,-9.86588e-7,0.99,-0.00135363,-0.0000596598,0.00000367749,0.9822,-0.00167442,-0.0000044975,-0.00000572394,0.973,-0.00214869,-0.0000903565,1.88767e-8,0.96,-0.00305084,-0.0000900732,0.00000164869,0.9427,-0.00382792,-0.0000653428,-0.00000261493,0.9216,-0.00467747,-0.000104566,0.0000048122,0.8962,-0.00536222,-0.0000323834,-0.00000543445,0.8679,-0.00609364,-0.0001139,0.00000332521,0.835,-0.00698325,-0.0000640219,9.34582e-7,0.7986,-0.00755337,-0.0000500038,9.35532e-7,0.7597,-0.00798325,-0.0000359716,-0.00000227604,0.7186,-0.00851366,-0.000070112,-0.00000863072,0.6732,-0.00986209,-0.000199572,0.0000191978,0.6213,-0.010418,0.0000883948,0.00000624031,0.5722,-0.00906601,0.000181999,0.00000624033,0.5322,0,0,0],d.Y=[0,0.0124,3.72529e-10,1.15484e-9,0.062,0.0124001,1.76951e-8,-5.92321e-9,0.124,0.0123998,-7.09668e-8,2.25753e-8,0.186,0.0124008,2.66917e-7,-8.44523e-8,0.248,0.0123971,-9.99682e-7,3.15569e-7,0.31,0.0124108,0.00000373349,-0.0000011779,0.372,0.0123598,-0.000013935,0.00000439588,0.434,0.0125501,0.0000520034,-0.0000100051,0.4968,0.0123198,-0.0000980735,0.00000922397,0.5571,0.0120308,0.0000402857,-0.0000052901,0.6176,0.0120369,-0.0000390662,7.36117e-7,0.6769,0.0117015,-0.0000280246,-8.54283e-7,0.7346,0.0113572,-0.0000408389,-5.18524e-7,0.7903,0.0109099,-0.0000486169,-0.0000010718,0.8435,0.0103433,-0.0000646934,5.36384e-9,0.8936,0.00969679,-0.0000646129,-0.00000854894,0.9394,0.00840949,-0.000192847,-0.00000421023,0.9761,0.00616525,-0.000256001,-0.00000421021,1,0,0,0],d.NODES=18,d.FXC=0.8487,d.FYC=1.3523,d.C1=11.459155902616464,d.RC1=0.08726646259971647,d.ONEEPS=1.000001,d.EPS=1e-8;return}b1(b,a1),b.prototype._poly=function(e,d,f){return e[d]+f*(e[d+1]+f*(e[d+2]+f*e[d+3]))},b.prototype.project=function(v,u){var t,r,q,p,o,n,l,k;o=this,k=o.ll(v,u),v=k[0],u=k[1],v=o.clon(v),r=o.rad(v),q=o.rad(u*-1),p=Math.abs(q),t=Math.floor(p*o.C1),t>=o.NODES&&(t=o.NODES-1),p=o.deg(p-o.RC1*t),t*=4,n=o._poly(o.X,t,p)*o.FXC*r,l=o._poly(o.Y,t,p)*o.FYC,q<0&&(l=-l);return[n,l]};return b}(),aF.robinson=aR,ai=function(){function b(a){var d;b.__super__.constructor.call(this,a),d=this,d.C_x=0.4222382003157712,d.C_y=1.3265004281770023,d.RC_y=0.7538633073600218,d.C_p=3.5707963267948966,d.RC_p=0.2800495767557787,d.EPS=1e-7,d.NITER=6}b1(b,a1),b.prototype.project=function(C,B){var A,z,w,v,u,t,r,q,p,o,n;t=this,n=t.ll(C,B),C=n[0],B=n[1],v=t.rad(t.clon(C)),u=t.rad(B*-1),r=t.C_p*Math.sin(u),A=u*u,u*=0.895168+A*(0.0218849+A*0.00826809),w=t.NITER;while(w>0){z=Math.cos(u),q=Math.sin(u),A=(u+q*(z+2)-r)/(1+z*(z+2)-q*q),u-=A;if(Math.abs(A)<t.EPS){break}w-=1}w===0?(p=t.C_x*v,o=u<0?-t.C_y:t.C_y):(p=t.C_x*v*(1+Math.cos(u)),o=t.C_y*Math.sin(u));return[p,o]};return b}(),aF.eckert4=ai,aN=function(){function b(){b.__super__.constructor.apply(this,arguments)}b1(b,a1),b.prototype.project=function(j,i){var q,p,o,n,l,k;p=this,k=p.ll(j,i),j=k[0],i=k[1],q=p.rad(p.clon(j)),o=p.rad(i*-1),n=q*Math.cos(o),l=o;return[n,l]};return b}(),aF.sinusoidal=aN,bP=function(){function b(t,r,q,p,o){var n,l,k,a;r==null&&(r=1.5707963267948966),q==null&&(q=null),p==null&&(p=null),o==null&&(o=null),b.__super__.constructor.call(this,t),n=this,n.MAX_ITER=10,n.TOLERANCE=1e-7,r!=null?(l=r+r,a=Math.sin(r),k=Math.sqrt(Math.PI*2*a/(l+Math.sin(l))),n.cx=2*k/Math.PI,n.cy=k/a,n.cp=l+Math.sin(l)):q!=null&&p!=null&&typeof cz!="undefined"&&cz!==null?(n.cx=q,n.cy=p,n.cp=o):console.error("kartograph.proj.Mollweide: either p or cx,cy,cp must be defined")}b1(b,a1),b.prototype.project=function(C,B){var A,z,w,v,u,t,r,q,p,o,n;t=this,n=t.ll(C,B),C=n[0],B=n[1],u=Math,A=u.abs,v=t.rad(t.clon(C)),r=t.rad(B),w=t.cp*u.sin(r),z=t.MAX_ITER;while(z!==0){q=(r+u.sin(r)-w)/(1+u.cos(r)),r-=q;if(A(q)<t.TOLERANCE){break}z-=1}z===0?r=r>=0?t.HALFPI:-t.HALFPI:r*=0.5,p=1000*t.cx*v*u.cos(r),o=1000*t.cy*u.sin(r);return[p,o*-1]};return b}(),aF.mollweide=bP,a0=function(){function b(a){b.__super__.constructor.call(this,a,1.0471975511965976)}b1(b,bP);return b}(),aF.wagner4=a0,aY=function(){function b(a){b.__super__.constructor.call(this,a,null,0.90977,1.65014,3.00896)}b1(b,bP);return b}(),aF.wagner5=aY,bT=function(){function f(){f.__super__.constructor.apply(this,arguments)}var e,d;b1(f,a1),d=-89,e=89,f.prototype.project=function(t,r){var q,p,o,n,l,k,j;o=this,j=o.ll(t,r),t=j[0],r=j[1],p=Math,q=o.rad(o.clon(t)),n=o.rad(r),n===o.phi0?l=q*p.cos(o.phi0):l=q*(n-o.phi0)/(p.log(p.tan(o.QUARTERPI+n*0.5))-p.log(p.tan(o.QUARTERPI+o.phi0*0.5))),l*=1000,k=1000*(n-o.phi0);return[l,k*-1]};return f}(),aF.loximuthal=bT,aB=function(){function b(a,f){var e;f==null&&(f=1000),b.__super__.constructor.call(this,a),e=this,e.r=f,e.elevation0=e.to_elevation(e.lat0),e.azimuth0=e.to_azimuth(e.lon0)}b1(b,a5),b.prototype.to_elevation=function(e){var d;d=this;return(e+90)/180*d.PI-d.HALFPI},b.prototype.to_azimuth=function(e){var d;d=this;return(e+180)/360*d.PI*2-d.PI},b.prototype._visible=function(i,h){var o,n,l,k,j;j=this,k=Math,l=j.to_elevation(h),o=j.to_azimuth(i),n=k.sin(l)*k.sin(j.elevation0)+k.cos(j.elevation0)*k.cos(l)*k.cos(o-j.azimuth0);return n>=0},b.prototype._truncate=function(i,h){var o,n,l,k,j;o=Math,n=this.r,l=o.atan2(h-n,i-n),k=n+n*o.cos(l),j=n+n*o.sin(l);return[k,j]},b.prototype.sea=function(){var f,e,h,g;e=[],g=this.r,f=Math;for(h=0;h<=360;h++){e.push([g+f.cos(this.rad(h))*g,g+f.sin(this.rad(h))*g])}return e},b.prototype.world_bbox=function(){var d;d=this.r;return new aU.BBox(0,0,d*2,d*2)};return b}(),bN=function(){function b(){b.__super__.constructor.apply(this,arguments)}b1(b,aB),b.prototype.project=function(v,u){var t,r,q,p,o,n,l,k;p=this,q=Math,r=p.to_elevation(u),t=p.to_azimuth(v),n=p.r*q.cos(r)*q.sin(t-p.azimuth0),k=-p.r*(q.cos(p.elevation0)*q.sin(r)-q.sin(p.elevation0)*q.cos(r)*q.cos(t-p.azimuth0)),o=p.r+n,l=p.r+k;return[o,l]};return b}(),aF.ortho=bN,bY=function(){function b(a){b.__super__.constructor.call(this,a),this.scale=Math.sqrt(2)*0.5}b1(b,aB),b.prototype.project=function(B,A){var z,w,v,u,t,r,q,p,o,n;t=this.rad(A),v=this.rad(B),u=Math,r=u.sin,z=u.cos,w=u.pow(2/(1+r(this.phi0)*r(t)+z(this.phi0)*z(t)*z(v-this.lam0)),0.5),w*=this.scale,p=this.r*w*z(t)*r(v-this.lam0),n=-this.r*w*(z(this.phi0)*r(t)-r(this.phi0)*z(t)*z(v-this.lam0)),q=this.r+p,o=this.r+n;return[q,o]};return b}(),aF.laea=bY,aG=function(){function b(){b.__super__.constructor.apply(this,arguments)}b1(b,aB),b.prototype.project=function(C,B){var A,z,w,v,u,t,r,q,p,o,n;t=this.rad(B),v=this.rad(C),u=Math,r=u.sin,A=u.cos,w=0.5,z=2*w/(1+r(this.phi0)*r(t)+A(this.phi0)*A(t)*A(v-this.lam0)),p=this.r*z*A(t)*r(v-this.lam0),n=-this.r*z*(A(this.phi0)*r(t)-r(this.phi0)*A(t)*A(v-this.lam0)),q=this.r+p,o=this.r+n;return[q,o]};return b}(),aF.stereo=aG,aP=function(){function b(t){var r,q,p,o,n,l,k,a;b.__super__.constructor.call(this,{lon0:0,lat0:0}),this.dist=(l=t.dist)!=null?l:3,this.up=this.rad((k=t.up)!=null?k:0),this.tilt=this.rad((a=t.tilt)!=null?a:0),this.scale=1,o=Number.MAX_VALUE,p=Number.MAX_VALUE*-1;for(r=0;r<=179;r++){for(q=0;q<=360;q++){n=this.project(q-180,r-90),o=Math.min(n[0],o),p=Math.max(n[0],p)}}this.scale=this.r*2/(p-o),b.__super__.constructor.call(this,t);return}b1(b,aB),b.prototype.project=function(X,W,V){var U,T,S,R,Q,P,O,N,M,L,J,I,H,G,F,E,D,C,B,A,z;V==null&&(V=0),L=this.rad(W),N=this.rad(X),M=Math,H=M.sin,S=M.cos,J=this.r,I=J*(V+6371)/3671,R=H(this.phi0)*H(L)+S(this.phi0)*S(L)*S(N-this.lam0),O=(this.dist-1)/(this.dist-R),O=(this.dist-1)/(this.dist-R),O*=this.scale,D=I*O*S(L)*H(N-this.lam0),A=-I*O*(S(this.phi0)*H(L)-H(this.phi0)*S(L)*S(N-this.lam0)),P=S(this.up),F=H(this.up),Q=S(this.tilt),G=H(this.tilt),T=I*(this.dist-1),U=(A*P+D*F)*H(this.tilt/T)+Q,C=(D*P-A*F)*S(this.tilt/U),z=(A*P+D*F)/U,E=J+C,B=J+z;return[E,B]},b.prototype._visible=function(h,g){var l,k,j,i;j=this.to_elevation(g),l=this.to_azimuth(h),i=Math,k=i.sin(j)*i.sin(this.elevation0)+i.cos(this.elevation0)*i.cos(j)*i.cos(l-this.azimuth0);return k>=1/this.dist},b.prototype.sea=function(){var f,e,h,g;e=[],g=this.r,f=Math;for(h=0;h<=360;h++){e.push([g+f.cos(this.rad(h))*g,g+f.sin(this.rad(h))*g])}return e};return b}(),aF.satellite=aP,ah=function(){function b(){b.__super__.constructor.apply(this,arguments)}b1(b,aB),b.prototype.project=function(E,D){var C,B,A,z,w,v,u,t,r,q,p,o;u=this.rad(D),w=this.rad(E),v=Math,t=v.sin,B=v.cos,A=t(this.phi0)*t(u)+B(this.phi0)*B(u)*B(w-this.lam0),C=v.acos(A),z=0.325*C/t(C),q=this.r*z*B(u)*t(w-this.lam0),o=-this.r*z*(B(this.phi0)*t(u)-t(this.phi0)*B(u)*B(w-this.lam0)),r=this.r+q,p=this.r+o;return[r,p]},b.prototype._visible=function(e,d){return !0};return b}(),aF.equi=ah,aD=function(){function b(){b.__super__.constructor.apply(this,arguments)}b1(b,ah),b.prototype.project=function(e,d){return[x,y]},b.prototype._visible=function(e,d){return !0};return b}(),aF.aitoff=aD,ak=function(){function b(a){var h,g,f;h=this,b.__super__.constructor.call(this,a),h.lat1=(g=a.lat1)!=null?g:30,h.phi1=h.rad(h.lat1),h.lat2=(f=a.lat2)!=null?f:50,h.phi2=h.rad(h.lat2)}b1(b,a5),b.prototype._visible=function(e,d){return !0},b.prototype._truncate=function(e,d){return[e,d]},b.prototype.clon=function(d){d-=this.lon0,d<-180?d+=360:d>180&&(d-=360);return d};return b}(),bX=function(){function b(E){var D,C,B,A,z,w,v,u,t,r,q,p,a;t=this,b.__super__.constructor.call(this,E),z=Math,a=[z.sin,z.cos,z.abs,z.log,z.tan,z.pow],r=a[0],B=a[1],D=a[2],aS=a[3],p=a[4],v=a[5],t.n=w=q=r(t.phi1),A=B(t.phi1),u=D(t.phi1-t.phi2)>=1e-10,u&&(w=aS(A/B(t.phi2))/aS(p(t.QUARTERPI+0.5*t.phi2)/p(t.QUARTERPI+0.5*t.phi1))),t.c=C=A*v(p(t.QUARTERPI+0.5*t.phi1),w)/w,D(D(t.phi0)-t.HALFPI)<1e-10?t.rho0=0:t.rho0=C*v(p(t.QUARTERPI+0.5*t.phi0),-w),t.minLat=-60,t.maxLat=85}b1(b,ak),"Lambert Conformal Conic Projection (spherical)",b.prototype.project=function(L,J){var I,H,G,F,E,D,C,B,A,z,w,v,u,t,r;z=this,C=z.rad(J),G=z.rad(z.clon(L)),E=Math,r=[E.sin,E.cos,E.abs,E.log,E.tan,E.pow],w=r[0],H=r[1],I=r[2],aS=r[3],v=r[4],B=r[5],D=z.n,I(I(C)-z.HALFPI)<1e-10?A=0:A=z.c*B(v(z.QUARTERPI+0.5*C),-D),F=G*D,u=1000*A*w(F),t=1000*z.rho0-A*H(F);return[u,t*-1]};return b}(),aF.lcc=bX,a3=function(){function b(){b.__super__.constructor.apply(this,arguments)}b1(b,ak);return b}(),a2=function(){function b(i,h,o,n,l,k){var j;j=this,j.bbox=i,j.width=h,j.padding=n!=null?n:0,j.halign=l!=null?l:"center",j.valign=k!=null?k:"center",j.height=o,j.scale=Math.min((h-n*2)/i.width,(o-n*2)/i.height)}b.prototype.project=function(t,r){var q,p,o,n,l,k,j;r==null&&(r=t[1],t=t[0]),o=this,n=o.scale,q=o.bbox,p=o.height,l=o.width,k=o.halign==="center"?(l-q.width*n)*0.5:o.halign==="left"?o.padding*n:l-(q.width-o.padding)*n,j=o.valign==="center"?(p-q.height*n)*0.5:o.valign==="top"?o.padding*n:0,t=(t-q.left)*n+k,r=(r-q.top)*n+j;return[t,r]},b.prototype.projectPath=function(I){var H,G,F,E,D,C,B,A,z,w,v,u,t,r,q;F=this;if(I.type==="path"){G=[],u=I.contours;for(A=0,w=u.length;A<w;A++){E=u[A],H=[];for(z=0,v=E.length;z<v;z++){t=E[z],C=t[0],B=t[1],r=F.project(C,B),C=r[0],B=r[1],H.push([C,B])}G.push(H)}return new aU.geom.Path(I.type,G,I.closed)}if(I.type==="circle"){q=F.project(I.x,I.y),C=q[0],B=q[1],D=I.r*F.scale;return new aU.geom.Circle(C,B,D)}},b.prototype.asBBox=function(){var d;d=this;return new aU.BBox(0,0,d.width,d.height)};return b}(),a2.fromXML=function(i){var h,n,l,k,j;j=Number(i.getAttribute("w")),l=Number(i.getAttribute("h")),k=Number(i.getAttribute("padding")),n=i.getElementsByTagName("bbox")[0],h=az.fromXML(n);return new aU.View(h,j,l,k)},aJ=typeof exports!="undefined"&&exports!==null?exports:this,(cb=aJ.kartograph)==null&&(aJ.kartograph={}),aJ.kartograph.View=a2}).call(this);(function(){var z=this;var u=z._;var b={};var j=Array.prototype,G=Object.prototype,J=Function.prototype;var v=j.slice,B=j.unshift,A=G.toString,q=G.hasOwnProperty;var o=j.forEach,i=j.map,E=j.reduce,f=j.reduceRight,n=j.filter,a=j.every,D=j.some,w=j.indexOf,g=j.lastIndexOf,d=Array.isArray,F=Object.keys,k=J.bind;var I=function(L){return new h(L)};if(typeof module!=="undefined"&&module.exports){module.exports=I;I._=I}else{z._=I}I.VERSION="1.2.0";var e=I.each=I.forEach=function(Q,P,O){if(Q==null){return}if(o&&Q.forEach===o){Q.forEach(P,O)}else{if(Q.length===+Q.length){for(var N=0,L=Q.length;N<L;N++){if(N in Q&&P.call(O,Q[N],N,Q)===b){return}}}else{for(var M in Q){if(q.call(Q,M)){if(P.call(O,Q[M],M,Q)===b){return}}}}}};I.map=function(O,N,M){var L=[];if(O==null){return L}if(i&&O.map===i){return O.map(N,M)}e(O,function(R,P,Q){L[L.length]=N.call(M,R,P,Q)});return L};I.reduce=I.foldl=I.inject=function(P,O,L,N){var M=L!==void 0;if(P==null){P=[]}if(E&&P.reduce===E){if(N){O=I.bind(O,N)}return M?P.reduce(O,L):P.reduce(O)}e(P,function(S,Q,R){if(!M){L=S;M=true}else{L=O.call(N,L,S,Q,R)}});if(!M){throw new TypeError("Reduce of empty array with no initial value")}return L};I.reduceRight=I.foldr=function(O,N,L,M){if(O==null){O=[]}if(f&&O.reduceRight===f){if(M){N=I.bind(N,M)}return L!==void 0?O.reduceRight(N,L):O.reduceRight(N)}var P=(I.isArray(O)?O.slice():I.toArray(O)).reverse();return I.reduce(P,N,L,M)};I.find=I.detect=function(O,N,M){var L;r(O,function(R,P,Q){if(N.call(M,R,P,Q)){L=R;return true}});return L};I.filter=I.select=function(O,N,M){var L=[];if(O==null){return L}if(n&&O.filter===n){return O.filter(N,M)}e(O,function(R,P,Q){if(N.call(M,R,P,Q)){L[L.length]=R}});return L};I.reject=function(O,N,M){var L=[];if(O==null){return L}e(O,function(R,P,Q){if(!N.call(M,R,P,Q)){L[L.length]=R}});return L};I.every=I.all=function(O,N,M){var L=true;if(O==null){return L}if(a&&O.every===a){return O.every(N,M)}e(O,function(R,P,Q){if(!(L=L&&N.call(M,R,P,Q))){return b}});return L};var r=I.some=I.any=function(O,N,M){N=N||I.identity;var L=false;if(O==null){return L}if(D&&O.some===D){return O.some(N,M)}e(O,function(R,P,Q){if(L|=N.call(M,R,P,Q)){return b}});return !!L};I.include=I.contains=function(N,M){var L=false;if(N==null){return L}if(w&&N.indexOf===w){return N.indexOf(M)!=-1}r(N,function(O){if(L=O===M){return true}});return L};I.invoke=function(M,N){var L=v.call(arguments,2);return I.map(M,function(O){return(N.call?N||O:O[N]).apply(O,L)})};I.pluck=function(M,L){return I.map(M,function(N){return N[L]})};I.max=function(O,N,M){if(!N&&I.isArray(O)){return Math.max.apply(Math,O)}if(!N&&I.isEmpty(O)){return -Infinity}var L={computed:-Infinity};e(O,function(S,P,R){var Q=N?N.call(M,S,P,R):S;Q>=L.computed&&(L={value:S,computed:Q})});return L.value};I.min=function(O,N,M){if(!N&&I.isArray(O)){return Math.min.apply(Math,O)}if(!N&&I.isEmpty(O)){return Infinity}var L={computed:Infinity};e(O,function(S,P,R){var Q=N?N.call(M,S,P,R):S;Q<L.computed&&(L={value:S,computed:Q})});return L.value};I.shuffle=function(N){var L=[],M;e(N,function(Q,O,P){if(O==0){L[0]=Q}else{M=Math.floor(Math.random()*(O+1));L[O]=L[M];L[M]=Q}});return L};I.sortBy=function(N,M,L){return I.pluck(I.map(N,function(Q,O,P){return{value:Q,criteria:M.call(L,Q,O,P)}}).sort(function(R,Q){var P=R.criteria,O=Q.criteria;return P<O?-1:P>O?1:0}),"value")};I.groupBy=function(N,M){var L={};e(N,function(Q,O){var P=M(Q,O);(L[P]||(L[P]=[])).push(Q)});return L};I.sortedIndex=function(Q,P,N){N||(N=I.identity);var L=0,O=Q.length;while(L<O){var M=(L+O)>>1;N(Q[M])<N(P)?L=M+1:O=M}return L};I.toArray=function(L){if(!L){return[]}if(L.toArray){return L.toArray()}if(I.isArray(L)){return v.call(L)}if(I.isArguments(L)){return v.call(L)}return I.values(L)};I.size=function(L){return I.toArray(L).length};I.first=I.head=function(N,M,L){return(M!=null)&&!L?v.call(N,0,M):N[0]};I.initial=function(N,M,L){return v.call(N,0,N.length-((M==null)||L?1:M))};I.last=function(N,M,L){return(M!=null)&&!L?v.call(N,N.length-M):N[N.length-1]};I.rest=I.tail=function(N,L,M){return v.call(N,(L==null)||M?1:L)};I.compact=function(L){return I.filter(L,function(M){return !!M})};I.flatten=function(L){return I.reduce(L,function(M,N){if(I.isArray(N)){return M.concat(I.flatten(N))}M[M.length]=N;return M},[])};I.without=function(L){return I.difference(L,v.call(arguments,1))};I.uniq=I.unique=function(P,O,N){var M=N?I.map(P,N):P;var L=[];I.reduce(M,function(Q,S,R){if(0==R||(O===true?I.last(Q)!=S:!I.include(Q,S))){Q[Q.length]=S;L[L.length]=P[R]}return Q},[]);return L};I.union=function(){return I.uniq(I.flatten(arguments))};I.intersection=I.intersect=function(M){var L=v.call(arguments,1);return I.filter(I.uniq(M),function(N){return I.every(L,function(O){return I.indexOf(O,N)>=0})})};I.difference=function(M,L){return I.filter(M,function(N){return !I.include(L,N)})};I.zip=function(){var L=v.call(arguments);var O=I.max(I.pluck(L,"length"));var N=new Array(O);for(var M=0;M<O;M++){N[M]=I.pluck(L,""+M)}return N};I.indexOf=function(P,N,O){if(P==null){return -1}var M,L;if(O){M=I.sortedIndex(P,N);return P[M]===N?M:-1}if(w&&P.indexOf===w){return P.indexOf(N)}for(M=0,L=P.length;M<L;M++){if(P[M]===N){return M}}return -1};I.lastIndexOf=function(N,M){if(N==null){return -1}if(g&&N.lastIndexOf===g){return N.lastIndexOf(M)}var L=N.length;while(L--){if(N[L]===M){return L}}return -1};I.range=function(Q,O,P){if(arguments.length<=1){O=Q||0;Q=0}P=arguments[2]||1;var M=Math.max(Math.ceil((O-Q)/P),0);var L=0;var N=new Array(M);while(L<M){N[L++]=Q;Q+=P}return N};I.bind=function(M,N){if(M.bind===k&&k){return k.apply(M,v.call(arguments,1))}var L=v.call(arguments,2);return function(){return M.apply(N,L.concat(v.call(arguments)))}};I.bindAll=function(M){var L=v.call(arguments,1);if(L.length==0){L=I.functions(M)}e(L,function(N){M[N]=I.bind(M[N],M)});return M};I.memoize=function(N,M){var L={};M||(M=I.identity);return function(){var O=M.apply(this,arguments);return q.call(L,O)?L[O]:(L[O]=N.apply(this,arguments))}};I.delay=function(M,N){var L=v.call(arguments,2);return setTimeout(function(){return M.apply(M,L)},N)};I.defer=function(L){return I.delay.apply(I,[L,1].concat(v.call(arguments,1)))};var C=function(M,O,L){var N;return function(){var Q=this,P=arguments;var R=function(){N=null;M.apply(Q,P)};if(L){clearTimeout(N)}if(L||!N){N=setTimeout(R,O)}}};I.throttle=function(L,M){return C(L,M,false)};I.debounce=function(L,M){return C(L,M,true)};I.once=function(N){var L=false,M;return function(){if(L){return M}L=true;return M=N.apply(this,arguments)}};I.wrap=function(L,M){return function(){var N=[L].concat(v.call(arguments));return M.apply(this,N)}};I.compose=function(){var L=v.call(arguments);return function(){var M=v.call(arguments);for(var N=L.length-1;N>=0;N--){M=[L[N].apply(this,M)]}return M[0]}};I.after=function(M,L){return function(){if(--M<1){return L.apply(this,arguments)}}};I.keys=F||function(N){if(N!==Object(N)){throw new TypeError("Invalid object")}var M=[];for(var L in N){if(q.call(N,L)){M[M.length]=L}}return M};I.values=function(L){return I.map(L,I.identity)};I.functions=I.methods=function(N){var M=[];for(var L in N){if(I.isFunction(N[L])){M.push(L)}}return M.sort()};I.extend=function(L){e(v.call(arguments,1),function(M){for(var N in M){if(M[N]!==void 0){L[N]=M[N]}}});return L};I.defaults=function(L){e(v.call(arguments,1),function(M){for(var N in M){if(L[N]==null){L[N]=M[N]}}});return L};I.clone=function(L){return I.isArray(L)?L.slice():I.extend({},L)};I.tap=function(M,L){L(M);return M};function H(aa,Y,O){if(aa===Y){return aa!==0||1/aa==1/Y}if(aa==null){return aa===Y}var U=typeof aa;if(U!=typeof Y){return false}if(!aa!=!Y){return false}if(I.isNaN(aa)){return I.isNaN(Y)}var X=I.isString(aa),W=I.isString(Y);if(X||W){return X&&W&&String(aa)==String(Y)}var ab=I.isNumber(aa),Z=I.isNumber(Y);if(ab||Z){return ab&&Z&&+aa==+Y}var M=I.isBoolean(aa),L=I.isBoolean(Y);if(M||L){return M&&L&&+aa==+Y}var S=I.isDate(aa),R=I.isDate(Y);if(S||R){return S&&R&&aa.getTime()==Y.getTime()}var Q=I.isRegExp(aa),P=I.isRegExp(Y);if(Q||P){return Q&&P&&aa.source==Y.source&&aa.global==Y.global&&aa.multiline==Y.multiline&&aa.ignoreCase==Y.ignoreCase}if(U!="object"){return false}if(aa._chain){aa=aa._wrapped}if(Y._chain){Y=Y._wrapped}if(I.isFunction(aa.isEqual)){return aa.isEqual(Y)}var N=O.length;while(N--){if(O[N]==aa){return true}}O.push(aa);var V=0,T=true;if(aa.length===+aa.length||Y.length===+Y.length){V=aa.length;T=V==Y.length;if(T){while(V--){if(!(T=V in aa==V in Y&&H(aa[V],Y[V],O))){break}}}}else{for(var ac in aa){if(q.call(aa,ac)){V++;if(!(T=q.call(Y,ac)&&H(aa[ac],Y[ac],O))){break}}}if(T){for(ac in Y){if(q.call(Y,ac)&&!V--){break}}T=!V}}O.pop();return T}I.isEqual=function(M,L){return H(M,L,[])};I.isEmpty=function(M){if(I.isArray(M)||I.isString(M)){return M.length===0}for(var L in M){if(q.call(M,L)){return false}}return true};I.isElement=function(L){return !!(L&&L.nodeType==1)};I.isArray=d||function(L){return A.call(L)==="[object Array]"};I.isObject=function(L){return L===Object(L)};I.isArguments=function(L){return !!(L&&q.call(L,"callee"))};I.isFunction=function(L){return !!(L&&L.constructor&&L.call&&L.apply)};I.isString=function(L){return !!(L===""||(L&&L.charCodeAt&&L.substr))};I.isNumber=function(L){return !!(L===0||(L&&L.toExponential&&L.toFixed))};I.isNaN=function(L){return L!==L};I.isBoolean=function(L){return L===true||L===false||A.call(L)=="[object Boolean]"};I.isDate=function(L){return !!(L&&L.getTimezoneOffset&&L.setUTCFullYear)};I.isRegExp=function(L){return !!(L&&L.test&&L.exec&&(L.ignoreCase||L.ignoreCase===false))};I.isNull=function(L){return L===null};I.isUndefined=function(L){return L===void 0};I.noConflict=function(){z._=u;return this};I.identity=function(L){return L};I.times=function(O,N,M){for(var L=0;L<O;L++){N.call(M,L)}};I.escape=function(L){return(""+L).replace(/&(?!\w+;|#\d+;|#x[\da-f]+;)/gi,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};I.mixin=function(L){e(I.functions(L),function(M){t(M,I[M]=L[M])})};var l=0;I.uniqueId=function(L){var M=l++;return L?L+M:M};I.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};I.template=function(O,N){var P=I.templateSettings;var L="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+O.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(P.escape,function(Q,R){return"',_.escape("+R.replace(/\\'/g,"'")+"),'"}).replace(P.interpolate,function(Q,R){return"',"+R.replace(/\\'/g,"'")+",'"}).replace(P.evaluate||null,function(Q,R){return"');"+R.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+"__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');";var M=new Function("obj",L);return N?M(N):M};var h=function(L){this._wrapped=L};I.prototype=h.prototype;var p=function(M,L){return L?I(M).chain():M};var t=function(L,M){h.prototype[L]=function(){var N=v.call(arguments);B.call(N,this._wrapped);return p(M.apply(I,N),this._chain)}};I.mixin(I);e(["pop","push","reverse","shift","sort","splice","unshift"],function(L){var M=j[L];h.prototype[L]=function(){M.apply(this._wrapped,arguments);return p(this._wrapped,this._chain)}});e(["concat","join","slice"],function(L){var M=j[L];h.prototype[L]=function(){return p(M.apply(this._wrapped,arguments),this._chain)}});h.prototype.chain=function(){this._chain=true;return this};h.prototype.value=function(){return this._wrapped}})();
/*!
 * accounting.js v0.3.2
 * Copyright 2011, Joss Crowcroft
 *
 * Freely distributable under the MIT license.
 * Portions of accounting.js are inspired or borrowed from underscore.js
 *
 * Full details and documentation:
 * http://josscrowcroft.github.com/accounting.js/
 */
(function(q,h){var p={};p.version="0.3.2";p.settings={currency:{symbol:"$",format:"%s%v",decimal:".",thousand:",",precision:2,grouping:3},number:{precision:0,grouping:3,thousand:",",decimal:"."}};var r=Array.prototype.map,k=Array.isArray,g=Object.prototype.toString;function d(u){return !!(u===""||(u&&u.charCodeAt&&u.substr))}function l(u){return k?k(u):g.call(u)==="[object Array]"}function t(u){return g.call(u)==="[object Object]"}function i(v,u){var w;v=v||{};u=u||{};for(w in u){if(u.hasOwnProperty(w)){if(v[w]==null){v[w]=u[w]}}}return v}function a(B,A,z){var w=[],v,u;if(!B){return w}if(r&&B.map===r){return B.map(A,z)}for(v=0,u=B.length;v<u;v++){w[v]=A.call(z,B[v],v,B)}return w}function n(v,u){v=Math.round(Math.abs(v));return isNaN(v)?u:v}function f(v){var u=p.settings.currency.format;if(typeof v==="function"){v=v()}if(d(v)&&v.match("%v")){return{pos:v,neg:v.replace("-","").replace("%v","-%v"),zero:v}}else{if(!v||!v.pos||!v.pos.match("%v")){return(!d(u))?u:p.settings.currency.format={pos:u,neg:u.replace("%v","-%v"),zero:u}}}return v}var j=p.unformat=p.parse=function(z,u){if(l(z)){return a(z,function(A){return j(A,u)})}z=z||0;if(typeof z==="number"){return z}u=u||".";var w=new RegExp("[^0-9-"+u+"]",["g"]),v=parseFloat((""+z).replace(/\((.*)\)/,"-$1").replace(w,"").replace(u,"."));return !isNaN(v)?v:0};var b=p.toFixed=function(w,u){u=n(u,p.settings.number.precision);var v=Math.pow(10,u);return(Math.round(p.unformat(w)*v)/v).toFixed(u)};var e=p.formatNumber=function(w,B,E,A){if(l(w)){return a(w,function(F){return e(F,B,E,A)})}w=j(w);var u=i((t(B)?B:{precision:B,thousand:E,decimal:A}),p.settings.number),C=n(u.precision),z=w<0?"-":"",v=parseInt(b(Math.abs(w||0),C),10)+"",D=v.length>3?v.length%3:0;return z+(D?v.substr(0,D)+u.thousand:"")+v.substr(D).replace(/(\d{3})(?=\d)/g,"$1"+u.thousand)+(C?u.decimal+b(Math.abs(w),C).split(".")[1]:"")};var o=p.formatMoney=function(w,v,A,E,z,D){if(l(w)){return a(w,function(F){return o(F,v,A,E,z,D)})}w=j(w);var u=i((t(v)?v:{symbol:v,precision:A,thousand:E,decimal:z,format:D}),p.settings.currency),C=f(u.format),B=w>0?C.pos:w<0?C.neg:C.zero;return B.replace("%s",u.symbol).replace("%v",e(Math.abs(w),n(u.precision),u.thousand,u.decimal))};p.formatColumn=function(D,w,B,G,A,F){if(!D){return[]}var u=i((t(w)?w:{symbol:w,precision:B,thousand:G,decimal:A,format:F}),p.settings.currency),E=f(u.format),C=E.pos.indexOf("%s")<E.pos.indexOf("%v")?true:false,v=0,z=a(D,function(L,I){if(l(L)){return p.formatColumn(L,u)}else{L=j(L);var H=L>0?E.pos:L<0?E.neg:E.zero,J=H.replace("%s",u.symbol).replace("%v",e(Math.abs(L),n(u.precision),u.thousand,u.decimal));if(J.length>v){v=J.length}return J}});return a(z,function(I,H){if(d(I)&&I.length<v){return C?I.replace(u.symbol,u.symbol+(new Array(v-I.length+1).join(" "))):(new Array(v-I.length+1).join(" "))+I}return I})};if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){exports=module.exports=p}exports.accounting=p}else{if(typeof define==="function"&&define.amd){define([],function(){return p})}else{p.noConflict=(function(u){return function(){q.accounting=u;p.noConflict=h;return p}})(q.accounting);q.accounting=p}}}(this));(function(){this.$jit=function(B){B=B||window;for(var C in $jit){if($jit[C].$extend){B[C]=$jit[C]}}};$jit.version="2.0.1";var d=function(B){return document.getElementById(B)};d.empty=function(){};d.extend=function(D,B){for(var C in (B||{})){D[C]=B[C]}return D};d.lambda=function(B){return(typeof B=="function")?B:function(){return B}};d.time=Date.now||function(){return +new Date};d.splat=function(C){var B=d.type(C);return B?((B!="array")?[C]:C):[]};d.type=function(C){var B=d.type.s.call(C).match(/^\[object\s(.*)\]$/)[1].toLowerCase();if(B!="object"){return B}if(C&&C.$$family){return C.$$family}if(C&&C.nodeType==9){return"htmldocument"}return(C&&C.nodeName&&C.nodeType==1)?"element":B};d.type.s=Object.prototype.toString;d.each=function(G,F){var E=d.type(G);if(E=="object"){for(var D in G){F(G[D],D)}}else{for(var C=0,B=G.length;C<B;C++){F(G[C],C)}}};d.indexOf=function(E,D){if(E.indexOf){return E.indexOf(D)}for(var C=0,B=E.length;C<B;C++){if(E[C]===D){return C}}return -1};d.map=function(D,C){var B=[];d.each(D,function(F,E){B.push(C(F,E))});return B};d.reduce=function(F,D,C){var B=F.length;if(B==0){return C}var E=arguments.length==3?C:F[--B];while(B--){E=D(E,F[B])}return E};d.merge=function(){var F={};for(var E=0,B=arguments.length;E<B;E++){var C=arguments[E];if(d.type(C)!="object"){continue}for(var D in C){var H=C[D],G=F[D];F[D]=(G&&d.type(H)=="object"&&d.type(G)=="object")?d.merge(G,H):d.unlink(H)}}return F};d.unlink=function(D){var C;switch(d.type(D)){case"object":C={};for(var F in D){C[F]=d.unlink(D[F])}break;case"array":C=[];for(var E=0,B=D.length;E<B;E++){C[E]=d.unlink(D[E])}break;default:return D}return C};d.zip=function(){if(arguments.length===0){return[]}for(var D=0,C=[],B=arguments.length,G=arguments[0].length;D<G;D++){for(var E=0,F=[];E<B;E++){F.push(arguments[E][D])}C.push(F)}return C};d.rgbToHex=function(F,E){if(F.length<3){return null}if(F.length==4&&F[3]==0&&!E){return"transparent"}var C=[];for(var B=0;B<3;B++){var D=(F[B]-0).toString(16);C.push(D.length==1?"0"+D:D)}return E?C:"#"+C.join("")};d.hexToRgb=function(D){if(D.length!=7){D=D.match(/^#?(\w{1,2})(\w{1,2})(\w{1,2})$/);D.shift();if(D.length!=3){return null}var B=[];for(var C=0;C<3;C++){var E=D[C];if(E.length==1){E+=E}B.push(parseInt(E,16))}return B}else{D=parseInt(D.slice(1),16);return[D>>16,D>>8&255,D&255]}};d.destroy=function(B){d.clean(B);if(B.parentNode){B.parentNode.removeChild(B)}if(B.clearAttributes){B.clearAttributes()}};d.clean=function(E){for(var D=E.childNodes,C=0,B=D.length;C<B;C++){d.destroy(D[C])}};d.addEvent=function(D,C,B){if(D.addEventListener){D.addEventListener(C,B,false)}else{D.attachEvent("on"+C,B)}};d.addEvents=function(C,D){for(var B in D){d.addEvent(C,B,D[B])}};d.hasClass=function(C,B){return(" "+C.className+" ").indexOf(" "+B+" ")>-1};d.addClass=function(C,B){if(!d.hasClass(C,B)){C.className=(C.className+" "+B)}};d.removeClass=function(C,B){C.className=C.className.replace(new RegExp("(^|\\s)"+B+"(?:\\s|$)"),"$1")};d.getPos=function(D){var G=F(D);var B=E(D);return{x:G.x-B.x,y:G.y-B.y};function F(I){var H={x:0,y:0};while(I&&!C(I)){H.x+=I.offsetLeft;H.y+=I.offsetTop;I=I.offsetParent}return H}function E(I){var H={x:0,y:0};while(I&&!C(I)){H.x+=I.scrollLeft;H.y+=I.scrollTop;I=I.parentNode}return H}function C(H){return(/^(?:body|html)$/i).test(H.tagName)}};d.getDir=function(D){var C=document.getElementById(D)||document.body;if(C.currentStyle){var B=C.currentStyle.direction}else{if(window.getComputedStyle){var B=document.defaultView.getComputedStyle(C,null).getPropertyValue("direction")}}return B};d.event={get:function(C,B){B=B||window;return C||B.event},getWheel:function(B){return B.wheelDelta?B.wheelDelta/120:-(B.detail||0)/3},isRightClick:function(B){return(B.which==3||B.button==2)},getPos:function(E,D){D=D||window;E=E||D.event;var C=D.document;C=C.documentElement||C.body;if(E.touches&&E.touches.length){E=E.touches[0]}var B={x:E.pageX||(E.clientX+C.scrollLeft),y:E.pageY||(E.clientY+C.scrollTop)};return B},stop:function(B){if(B.stopPropagation){B.stopPropagation()}B.cancelBubble=true;if(B.preventDefault){B.preventDefault()}else{B.returnValue=false}}};$jit.util=$jit.id=d;var t=function(C){C=C||{};var B=function(){for(var F in this){if(typeof this[F]!="function"){this[F]=d.unlink(this[F])}}this.constructor=B;if(t.prototyping){return this}var E=this.initialize?this.initialize.apply(this,arguments):this;this.$$family="class";return E};for(var D in t.Mutators){if(!C[D]){continue}C=t.Mutators[D](C,C[D]);delete C[D]}d.extend(B,this);B.constructor=t;B.prototype=C;return B};t.Mutators={Implements:function(B,C){d.each(d.splat(C),function(E){t.prototyping=E;var D=(typeof E=="function")?new E:E;for(var F in D){if(!(F in B)){B[F]=D[F]}}delete t.prototyping});return B}};d.extend(t,{inherit:function(B,E){for(var D in E){var C=E[D];var G=B[D];var F=d.type(C);if(G&&F=="function"){if(C!=G){t.override(B,D,C)}}else{if(F=="object"){B[D]=d.merge(G,C)}else{B[D]=C}}}return B},override:function(C,B,F){var E=t.prototyping;if(E&&C[B]!=E[B]){E=null}var D=function(){var G=this.parent;this.parent=E?E[B]:C[B];var H=F.apply(this,arguments);this.parent=G;return H};C[B]=D}});t.prototype.implement=function(){var B=this.prototype;d.each(Array.prototype.slice.call(arguments||[]),function(C){t.inherit(B,C)});return this};$jit.Class=t;$jit.json={prune:function(C,B){this.each(C,function(E,D){if(D==B&&E.children){delete E.children;E.children=[]}})},getParent:function(B,F){if(B.id==F){return false}var E=B.children;if(E&&E.length>0){for(var D=0;D<E.length;D++){if(E[D].id==F){return B}else{var C=this.getParent(E[D],F);if(C){return C}}}}return false},getSubtree:function(B,F){if(B.id==F){return B}for(var D=0,E=B.children;E&&D<E.length;D++){var C=this.getSubtree(E[D],F);if(C!=null){return C}}return null},eachLevel:function(B,G,D,F){if(G<=D){F(B,G);if(!B.children){return}for(var C=0,E=B.children;C<E.length;C++){this.eachLevel(E[C],G+1,D,F)}}},each:function(B,C){this.eachLevel(B,0,Number.MAX_VALUE,C)}};$jit.Trans={$extend:true,linear:function(B){return B}};var j=$jit.Trans;(function(){var B=function(E,D){D=d.splat(D);return d.extend(E,{easeIn:function(F){return E(F,D)},easeOut:function(F){return 1-E(1-F,D)},easeInOut:function(F){return(F<=0.5)?E(2*F,D)/2:(2-E(2*(1-F),D))/2}})};var C={Pow:function(E,D){return Math.pow(E,D[0]||6)},Expo:function(D){return Math.pow(2,8*(D-1))},Circ:function(D){return 1-Math.sin(Math.acos(D))},Sine:function(D){return 1-Math.sin((1-D)*Math.PI/2)},Back:function(E,D){D=D[0]||1.618;return Math.pow(E,2)*((D+1)*E-D)},Bounce:function(G){var F;for(var E=0,D=1;1;E+=D,D/=2){if(G>=(7-4*E)/11){F=D*D-Math.pow((11-6*E-11*G)/4,2);break}}return F},Elastic:function(E,D){return Math.pow(2,10*--E)*Math.cos(20*E*Math.PI*(D[0]||1)/3)}};d.each(C,function(E,D){j[D]=B(E)});d.each(["Quad","Cubic","Quart","Quint"],function(E,D){j[E]=B(function(F){return Math.pow(F,[D+2])})})})();var z=new t({initialize:function(B){this.setOptions(B)},setOptions:function(B){var C={duration:2500,fps:40,transition:j.Quart.easeInOut,compute:d.empty,complete:d.empty,link:"ignore"};this.opt=d.merge(C,B||{});return this},step:function(){var C=d.time(),B=this.opt;if(C<this.time+B.duration){var D=B.transition((C-this.time)/B.duration);B.compute(D)}else{this.timer=clearInterval(this.timer);B.compute(1);B.complete()}},start:function(){if(!this.check()){return this}this.time=0;this.startTimer();return this},startTimer:function(){var B=this,C=this.opt.fps;if(this.timer){return false}this.time=d.time()-this.time;this.timer=setInterval((function(){B.step()}),Math.round(1000/C));return true},pause:function(){this.stopTimer();return this},resume:function(){this.startTimer();return this},stopTimer:function(){if(!this.timer){return false}this.time=d.time()-this.time;this.timer=clearInterval(this.timer);return true},check:function(){if(!this.timer){return true}if(this.opt.link=="cancel"){this.stopTimer();return true}return false}});var p=function(){var D=arguments;for(var F=0,B=D.length,C={};F<B;F++){var E=p[D[F]];if(E.$extend){d.extend(C,E)}else{C[D[F]]=E}}return C};p.AreaChart={$extend:true,animate:true,labelOffset:3,type:"stacked",Tips:{enable:false,onShow:d.empty,onHide:d.empty},Events:{enable:false,onClick:d.empty},selectOnHover:true,showAggregates:true,showLabels:true,filterOnClick:false,restoreOnRightClick:false};p.Margin={$extend:false,top:0,left:0,right:0,bottom:0};p.Canvas={$extend:true,injectInto:"id",type:"2D",width:false,height:false,useCanvas:false,withLabels:true,background:false,Scene:{Lighting:{enable:false,ambient:[1,1,1],directional:{direction:{x:-100,y:-100,z:-100},color:[0.5,0.3,0.1]}}}};p.Tree={$extend:true,orientation:"left",subtreeOffset:8,siblingOffset:5,indent:10,multitree:false,align:"center",levelSpacing:"even"};p.Node={$extend:false,overridable:false,type:"circle",color:"#ccb",alpha:1,dim:3,height:20,width:90,autoHeight:false,autoWidth:false,lineWidth:1,transform:true,align:"center",angularWidth:1,span:1,CanvasStyles:{}};p.Edge={$extend:false,overridable:false,type:"line",color:"#ccb",lineWidth:1,dim:15,alpha:1,epsilon:7,CanvasStyles:{}};p.Fx={$extend:true,fps:40,duration:2500,transition:$jit.Trans.Quart.easeInOut,clearCanvas:true};p.Label={$extend:false,overridable:false,type:"HTML",style:" ",size:10,family:"sans-serif",textAlign:"center",textBaseline:"alphabetic",color:"#fff"};p.Tips={$extend:false,enable:false,type:"auto",offsetX:20,offsetY:20,force:false,onShow:d.empty,onHide:d.empty};p.NodeStyles={$extend:false,enable:false,type:"auto",stylesHover:false,stylesClick:false};p.Events={$extend:false,enable:false,enableForEdges:false,type:"auto",onClick:d.empty,onRightClick:d.empty,onMouseMove:d.empty,onMouseEnter:d.empty,onMouseLeave:d.empty,onDragStart:d.empty,onDragMove:d.empty,onDragCancel:d.empty,onDragEnd:d.empty,onTouchStart:d.empty,onTouchMove:d.empty,onTouchEnd:d.empty,onTouchCancel:d.empty,onMouseWheel:d.empty};p.Navigation={$extend:false,enable:false,type:"auto",panning:false,zooming:false};p.Controller={$extend:true,onBeforeCompute:d.empty,onAfterCompute:d.empty,onCreateLabel:d.empty,onPlaceLabel:d.empty,onComplete:d.empty,onBeforePlotLine:d.empty,onAfterPlotLine:d.empty,onBeforePlotNode:d.empty,onAfterPlotNode:d.empty,onBeforeRemoveNode:d.empty,request:false};var w={initialize:function(D,B){this.viz=B;this.canvas=B.canvas;this.config=B.config[D];this.nodeTypes=B.fx.nodeTypes;var C=this.config.type;this.dom=C=="auto"?(B.config.Label.type!="Native"):(C!="Native");this.labelContainer=this.dom&&B.labels.getLabelContainer();this.isEnabled()&&this.initializePost()},initializePost:d.empty,setAsProperty:d.lambda(false),isEnabled:function(){return this.config.enable},isLabel:function(G,F,E){G=d.event.get(G,F);var B=this.labelContainer,D=G.target||G.srcElement,C=G.relatedTarget;if(E){return C&&C==this.viz.canvas.getCtx().canvas&&!!D&&this.isDescendantOf(D,B)}else{return this.isDescendantOf(D,B)}},isDescendantOf:function(C,B){while(C&&C.parentNode){if(C.parentNode==B){return C}C=C.parentNode}return false}};var i={onMouseUp:d.empty,onMouseDown:d.empty,onMouseMove:d.empty,onMouseOver:d.empty,onMouseOut:d.empty,onMouseWheel:d.empty,onTouchStart:d.empty,onTouchMove:d.empty,onTouchEnd:d.empty,onTouchCancel:d.empty};var v=new t({initialize:function(B){this.viz=B;this.canvas=B.canvas;this.node=false;this.edge=false;this.registeredObjects=[];this.attachEvents()},attachEvents:function(){var D=this.canvas.getElement(),C=this;D.oncontextmenu=d.lambda(false);d.addEvents(D,{mouseup:function(G,F){var E=d.event.get(G,F);C.handleEvent("MouseUp",G,F,C.makeEventObject(G,F),d.event.isRightClick(E))},mousedown:function(G,F){var E=d.event.get(G,F);C.handleEvent("MouseDown",G,F,C.makeEventObject(G,F),d.event.isRightClick(E))},mousemove:function(F,E){C.handleEvent("MouseMove",F,E,C.makeEventObject(F,E))},mouseover:function(F,E){C.handleEvent("MouseOver",F,E,C.makeEventObject(F,E))},mouseout:function(F,E){C.handleEvent("MouseOut",F,E,C.makeEventObject(F,E))},touchstart:function(F,E){C.handleEvent("TouchStart",F,E,C.makeEventObject(F,E))},touchmove:function(F,E){C.handleEvent("TouchMove",F,E,C.makeEventObject(F,E))},touchend:function(F,E){C.handleEvent("TouchEnd",F,E,C.makeEventObject(F,E))}});var B=function(H,G){var F=d.event.get(H,G);var E=d.event.getWheel(F);C.handleEvent("MouseWheel",H,G,E)};if(!document.getBoxObjectFor&&window.mozInnerScreenX==null){d.addEvent(D,"mousewheel",B)}else{D.addEventListener("DOMMouseScroll",B,false)}},register:function(B){this.registeredObjects.push(B)},handleEvent:function(){var C=Array.prototype.slice.call(arguments),F=C.shift();for(var E=0,D=this.registeredObjects,B=D.length;E<B;E++){D[E]["on"+F].apply(D[E],C)}},makeEventObject:function(H,G){var E=this,F=this.viz.graph,D=this.viz.fx,C=D.nodeTypes,B=D.edgeTypes;return{pos:false,node:false,edge:false,contains:false,getNodeCalled:false,getEdgeCalled:false,getPos:function(){var L=E.viz.canvas,M=L.getSize(),N=L.getPos(),J=L.translateOffsetX,I=L.translateOffsetY,Q=L.scaleOffsetX,O=L.scaleOffsetY,P=d.event.getPos(H,G);this.pos={x:(P.x-N.x-M.width/2-J)*1/Q,y:(P.y-N.y-M.height/2-I)*1/O};return this.pos},getNode:function(){if(this.getNodeCalled){return this.node}this.getNodeCalled=true;for(var M in F.nodes){var L=F.nodes[M],J=L&&C[L.getData("type")],I=J&&J.contains&&J.contains.call(D,L,this.getPos());if(I){this.contains=I;return E.node=this.node=L}}return E.node=this.node=false},getEdge:function(){if(this.getEdgeCalled){return this.edge}this.getEdgeCalled=true;var L={};for(var P in F.edges){var N=F.edges[P];L[P]=true;for(var O in N){if(O in L){continue}var M=N[O],J=M&&B[M.getData("type")],I=J&&J.contains&&J.contains.call(D,M,this.getPos());if(I){this.contains=I;return E.edge=this.edge=M}}}return E.edge=this.edge=false},getContains:function(){if(this.getNodeCalled){return this.contains}this.getNode();return this.contains}}}});var q={initializeExtras:function(){var C=new v(this),B=this;d.each(["NodeStyles","Tips","Navigation","Events"],function(D){var E=new q.Classes[D](D,B);if(E.isEnabled()){C.register(E)}if(E.setAsProperty()){B[D.toLowerCase()]=E}})}};q.Classes={};q.Classes.Events=new t({Implements:[w,i],initializePost:function(){this.fx=this.viz.fx;this.ntypes=this.viz.fx.nodeTypes;this.etypes=this.viz.fx.edgeTypes;this.hovered=false;this.pressed=false;this.touched=false;this.touchMoved=false;this.moved=false},setAsProperty:d.lambda(true),onMouseUp:function(F,E,C,D){var B=d.event.get(F,E);if(!this.moved){if(D){this.config.onRightClick(this.hovered,C,B)}else{this.config.onClick(this.pressed,C,B)}}if(this.pressed){if(this.moved){this.config.onDragEnd(this.pressed,C,B)}else{this.config.onDragCancel(this.pressed,C,B)}this.pressed=this.moved=false}},onMouseOut:function(G,F,E){var C=d.event.get(G,F),D;if(this.dom&&(D=this.isLabel(G,F,true))){this.config.onMouseLeave(this.viz.graph.getNode(D.id),E,C);this.hovered=false;return}var B=C.relatedTarget,H=this.canvas.getElement();while(B&&B.parentNode){if(H==B.parentNode){return}B=B.parentNode}if(this.hovered){this.config.onMouseLeave(this.hovered,E,C);this.hovered=false}},onMouseOver:function(F,E,D){var B=d.event.get(F,E),C;if(this.dom&&(C=this.isLabel(F,E,true))){this.hovered=this.viz.graph.getNode(C.id);this.config.onMouseEnter(this.hovered,D,B)}},onMouseMove:function(H,G,F){var C,B=d.event.get(H,G);if(this.pressed){this.moved=true;this.config.onDragMove(this.pressed,F,B);return}if(this.dom){this.config.onMouseMove(this.hovered,F,B)}else{if(this.hovered){var I=this.hovered;var E=I.nodeFrom?this.etypes[I.getData("type")]:this.ntypes[I.getData("type")];var D=E&&E.contains&&E.contains.call(this.fx,I,F.getPos());if(D){this.config.onMouseMove(I,F,B);return}else{this.config.onMouseLeave(I,F,B);this.hovered=false}}if(this.hovered=(F.getNode()||(this.config.enableForEdges&&F.getEdge()))){this.config.onMouseEnter(this.hovered,F,B)}else{this.config.onMouseMove(false,F,B)}}},onMouseWheel:function(C,B,D){this.config.onMouseWheel(D,d.event.get(C,B))},onMouseDown:function(F,E,D){var B=d.event.get(F,E),C;if(this.dom){if(C=this.isLabel(F,E)){this.pressed=this.viz.graph.getNode(C.id)}}else{this.pressed=D.getNode()||(this.config.enableForEdges&&D.getEdge())}this.pressed&&this.config.onDragStart(this.pressed,D,B)},onTouchStart:function(F,E,D){var B=d.event.get(F,E),C;if(this.dom&&(C=this.isLabel(F,E))){this.touched=this.viz.graph.getNode(C.id)}else{this.touched=D.getNode()||(this.config.enableForEdges&&D.getEdge())}this.touched&&this.config.onTouchStart(this.touched,D,B)},onTouchMove:function(E,D,C){var B=d.event.get(E,D);if(this.touched){this.touchMoved=true;this.config.onTouchMove(this.touched,C,B)}},onTouchEnd:function(E,D,C){var B=d.event.get(E,D);if(this.touched){if(this.touchMoved){this.config.onTouchEnd(this.touched,C,B)}else{this.config.onTouchCancel(this.touched,C,B)}this.touched=this.touchMoved=false}}});q.Classes.Tips=new t({Implements:[w,i],initializePost:function(){if(document.body){var B=d("_tooltip")||document.createElement("div");B.id="_tooltip";B.className="tip";d.extend(B.style,{position:"absolute",display:"none",zIndex:13000});document.body.appendChild(B);this.tip=B;this.node=false}},setAsProperty:d.lambda(true),onMouseOut:function(E,D){var C=d.event.get(E,D);if(this.dom&&this.isLabel(E,D,true)){this.hide(true);return}var B=E.relatedTarget,F=this.canvas.getElement();while(B&&B.parentNode){if(F==B.parentNode){return}B=B.parentNode}this.hide(false)},onMouseOver:function(D,C){var B;if(this.dom&&(B=this.isLabel(D,C,false))){this.node=this.viz.graph.getNode(B.id);this.config.onShow(this.tip,this.node,B)}},onMouseMove:function(E,D,B){if(this.dom&&this.isLabel(E,D)){this.setTooltipPosition(d.event.getPos(E,D))}if(!this.dom){var C=B.getNode();if(!C){this.hide(true);return}if(this.config.force||!this.node||this.node.id!=C.id){this.node=C;this.config.onShow(this.tip,C,B.getContains())}this.setTooltipPosition(d.event.getPos(E,D))}},setTooltipPosition:function(F){var I=this.tip,B=I.style,J=this.config;B.display="";var C=document.compatMode==="CSS1Compat"&&document.documentElement||document.body||document.documentElement;var G={width:C.clientWidth,height:C.clientHeight,x:window.pageXOffset||document.documentElement&&document.documentElement.scrollLeft||document.body&&document.body.scrollLeft||0,y:window.pageYOffset||document.documentElement&&document.documentElement.scrollTop||document.body&&document.body.scrollTop||0};var D={width:I.offsetWidth,height:I.offsetHeight};var H=J.offsetX,E=J.offsetY;B.top=((F.y+D.height+E>G.height+G.y)?(F.y-D.height-E):F.y+E)+"px";B.left=((F.x+D.width+H>G.width+G.x)?(F.x-D.width-H):F.x+H)+"px"},hide:function(B){this.tip.style.display="none";B&&this.config.onHide()}});q.Classes.NodeStyles=new t({Implements:[w,i],initializePost:function(){this.fx=this.viz.fx;this.types=this.viz.fx.nodeTypes;this.nStyles=this.config;this.nodeStylesOnHover=this.nStyles.stylesHover;this.nodeStylesOnClick=this.nStyles.stylesClick;this.hoveredNode=false;this.fx.nodeFxAnimation=new z();this.down=false;this.move=false},onMouseOut:function(D,C){this.down=this.move=false;if(!this.hoveredNode){return}if(this.dom&&this.isLabel(D,C,true)){this.toggleStylesOnHover(this.hoveredNode,false)}var B=D.relatedTarget,E=this.canvas.getElement();while(B&&B.parentNode){if(E==B.parentNode){return}B=B.parentNode}this.toggleStylesOnHover(this.hoveredNode,false);this.hoveredNode=false},onMouseOver:function(E,D){var B;if(this.dom&&(B=this.isLabel(E,D,true))){var C=this.viz.graph.getNode(B.id);if(C.selected){return}this.hoveredNode=C;this.toggleStylesOnHover(this.hoveredNode,true)}},onMouseDown:function(F,E,C,D){if(D){return}var B;if(this.dom&&(B=this.isLabel(F,E))){this.down=this.viz.graph.getNode(B.id)}else{if(!this.dom){this.down=C.getNode()}}this.move=false},onMouseUp:function(E,D,B,C){if(C){return}if(!this.move){this.onClick(B.getNode())}this.down=this.move=false},getRestoredStyles:function(C,B){var E={},D=this["nodeStylesOn"+B];for(var F in D){E[F]=C.styles["$"+F]}return E},toggleStylesOnHover:function(B,C){if(this.nodeStylesOnHover){this.toggleStylesOn("Hover",B,C)}},toggleStylesOnClick:function(B,C){if(this.nodeStylesOnClick){this.toggleStylesOn("Click",B,C)}},toggleStylesOn:function(F,B,H){var I=this.viz;var G=this.nStyles;if(H){var E=this;if(!B.styles){B.styles=d.merge(B.data,{})}for(var J in this["nodeStylesOn"+F]){var C="$"+J;if(!(C in B.styles)){B.styles[C]=B.getData(J)}}I.fx.nodeFx(d.extend({elements:{id:B.id,properties:E["nodeStylesOn"+F]},transition:j.Quart.easeOut,duration:300,fps:40},this.config))}else{var D=this.getRestoredStyles(B,F);I.fx.nodeFx(d.extend({elements:{id:B.id,properties:D},transition:j.Quart.easeOut,duration:300,fps:40},this.config))}},onClick:function(B){if(!B){return}var C=this.nodeStylesOnClick;if(!C){return}if(B.selected){this.toggleStylesOnClick(B,false);delete B.selected}else{this.viz.graph.eachNode(function(E){if(E.selected){for(var D in C){E.setData(D,E.styles["$"+D],"end")}delete E.selected}});this.toggleStylesOnClick(B,true);B.selected=true;delete B.hovered;this.hoveredNode=false}},onMouseMove:function(H,G,E){if(this.down){this.move=true}if(this.dom&&this.isLabel(H,G)){return}var F=this.nodeStylesOnHover;if(!F){return}if(!this.dom){if(this.hoveredNode){var C=this.types[this.hoveredNode.getData("type")];var B=C&&C.contains&&C.contains.call(this.fx,this.hoveredNode,E.getPos());if(B){return}}var D=E.getNode();if(!this.hoveredNode&&!D){return}if(D.hovered){return}if(D&&!D.selected){this.fx.nodeFxAnimation.stopTimer();this.viz.graph.eachNode(function(J){if(J.hovered&&!J.selected){for(var I in F){J.setData(I,J.styles["$"+I],"end")}delete J.hovered}});D.hovered=true;this.hoveredNode=D;this.toggleStylesOnHover(D,true)}else{if(this.hoveredNode&&!this.hoveredNode.selected){this.fx.nodeFxAnimation.stopTimer();this.toggleStylesOnHover(this.hoveredNode,false);delete this.hoveredNode.hovered;this.hoveredNode=false}}}}});q.Classes.Navigation=new t({Implements:[w,i],initializePost:function(){this.pos=false;this.pressed=false},onMouseWheel:function(E,D,B){if(!this.config.zooming){return}d.event.stop(d.event.get(E,D));var F=this.config.zooming/1000,C=1+B*F;this.canvas.scale(C,C)},onMouseDown:function(G,F,E){if(!this.config.panning){return}G.preventDefault?G.preventDefault():G.returnValue=false;d.addClass(this.canvas.getElement(),"grabbing");if(this.config.panning=="avoid nodes"&&(this.dom?this.isLabel(G,F):(E.getNode()||E.getEdge()))){return}this.pressed=true;this.pos=E.getPos();var D=this.canvas,C=D.translateOffsetX,B=D.translateOffsetY,I=D.scaleOffsetX,H=D.scaleOffsetY;this.pos.x*=I;this.pos.x+=C;this.pos.y*=H;this.pos.y+=B},onMouseMove:function(G,F,I){if(!this.config.panning){return}if(!this.pressed){return}if(this.config.panning=="avoid nodes"&&(this.dom?this.isLabel(G,F):I.getNode())){return}var E=this.pos,H=I.getPos(),C=this.canvas,D=C.translateOffsetX,B=C.translateOffsetY,N=C.scaleOffsetX,L=C.scaleOffsetY;H.x*=N;H.y*=L;H.x+=D;H.y+=B;var M=H.x-E.x,J=H.y-E.y;this.pos=H;this.canvas.translate(M*1/N,J*1/L)},onMouseUp:function(E,D,C,B){if(!this.config.panning){return}d.removeClass(this.canvas.getElement(),"grabbing");this.pressed=false}});var n;(function(){var B=typeof HTMLCanvasElement,D=(B=="object"||B=="function");function C(E,F){var G=document.createElement(E);for(var H in F){if(typeof F[H]=="object"){d.extend(G[H],F[H])}else{G[H]=F[H]}}if(E=="canvas"&&!D&&G_vmlCanvasManager){G=G_vmlCanvasManager.initElement(document.body.appendChild(G))}return G}$jit.Canvas=n=new t({canvases:[],pos:false,element:false,labelContainer:false,translateOffsetX:0,translateOffsetY:0,scaleOffsetX:1,scaleOffsetY:1,initialize:function(R,J){this.viz=R;this.opt=this.config=J;var G=d.type(J.injectInto)=="string"?J.injectInto:J.injectInto.id,Q=J.type,H=G+"-label",E=d(G),I=J.width||E.offsetWidth,S=J.height||E.offsetHeight;this.id=G;var L={injectInto:G,width:I,height:S};this.element=C("div",{id:G+"-canvaswidget",style:{position:"relative",width:I+"px",height:S+"px"}});this.labelContainer=this.createLabelContainer(J.Label.type,H,L);this.canvases.push(new n.Base[Q]({config:d.extend({idSuffix:"-canvas"},L),plot:function(T){R.fx.plot()},resize:function(){R.refresh()}}));var M=J.background;if(M){var P=new n.Background[M.type](R,d.extend(M,L));this.canvases.push(new n.Base[Q](P))}var O=this.canvases.length;while(O--){this.element.appendChild(this.canvases[O].canvas);if(O>0){this.canvases[O].plot()}}this.element.appendChild(this.labelContainer);E.appendChild(this.element);var F=null,N=this;d.addEvent(window,"scroll",function(){clearTimeout(F);F=setTimeout(function(){N.getPos(true)},500)})},getCtx:function(E){return this.canvases[E||0].getCtx()},getConfig:function(){return this.opt},getElement:function(){return this.element},getSize:function(E){return this.canvases[E||0].getSize()},resize:function(I,E){this.getPos(true);this.translateOffsetX=this.translateOffsetY=0;this.scaleOffsetX=this.scaleOffsetY=1;for(var G=0,F=this.canvases.length;G<F;G++){this.canvases[G].resize(I,E)}var H=this.element.style;H.width=I+"px";H.height=E+"px";if(this.labelContainer){this.labelContainer.style.width=I+"px"}},translate:function(E,I,H){this.translateOffsetX+=E*this.scaleOffsetX;this.translateOffsetY+=I*this.scaleOffsetY;for(var G=0,F=this.canvases.length;G<F;G++){this.canvases[G].translate(E,I,H)}},scale:function(J,G,H){var L=this.scaleOffsetX*J,I=this.scaleOffsetY*G;var N=this.translateOffsetX*(J-1)/L,M=this.translateOffsetY*(G-1)/I;this.scaleOffsetX=L;this.scaleOffsetY=I;for(var F=0,E=this.canvases.length;F<E;F++){this.canvases[F].scale(J,G,true)}this.translate(N,M,false)},getZoom:function(){return new r(this.scaleOffsetX,this.scaleOffsetY)},setZoom:function(E,J,H){var I=this.getZoom(),G=E/I.x,F=J/I.y;this.scale(G,F,H)},getPos:function(E){if(E||!this.pos){return this.pos=d.getPos(this.getElement())}return this.pos},clear:function(E){this.canvases[E||0].clear()},path:function(F,G){var E=this.canvases[0].getCtx();E.beginPath();G(E);E[F]();E.closePath()},createLabelContainer:function(G,L,J){var I="http://www.w3.org/2000/svg";if(G=="HTML"||G=="Native"){return C("div",{id:L,style:{overflow:"visible",position:"absolute",top:0,left:0,width:J.width+"px",height:0}})}else{if(G=="SVG"){var H=document.createElementNS(I,"svg:svg");H.setAttribute("width",J.width);H.setAttribute("height",J.height);var F=H.style;F.position="absolute";F.left=F.top="0px";var E=document.createElementNS(I,"svg:g");E.setAttribute("width",J.width);E.setAttribute("height",J.height);E.setAttribute("x",0);E.setAttribute("y",0);E.setAttribute("id",L);H.appendChild(E);return H}}}});n.Base={};n.Base["2D"]=new t({translateOffsetX:0,translateOffsetY:0,scaleOffsetX:1,scaleOffsetY:1,initialize:function(E){this.viz=E;this.opt=E.config;this.size=false;this.createCanvas();this.translateToCenter()},createCanvas:function(){var F=this.opt,G=F.width,E=F.height;this.canvas=C("canvas",{id:F.injectInto+F.idSuffix,width:G,height:E,style:{position:"absolute",top:0,left:0,width:G+"px",height:E+"px"}})},getCtx:function(){if(!this.ctx){return this.ctx=this.canvas.getContext("2d")}return this.ctx},getSize:function(){if(this.size){return this.size}var E=this.canvas;return this.size={width:E.width,height:E.height}},translateToCenter:function(H){var F=this.getSize(),G=H?(F.width-H.width-this.translateOffsetX*2):F.width;height=H?(F.height-H.height-this.translateOffsetY*2):F.height;var E=this.getCtx();H&&E.scale(1/this.scaleOffsetX,1/this.scaleOffsetY);E.translate(G/2,height/2)},resize:function(H,E){var G=this.getSize(),F=this.canvas,I=F.style;this.size=false;F.width=H;F.height=E;I.width=H+"px";I.height=E+"px";if(!D){this.translateToCenter(G)}else{this.translateToCenter()}this.translateOffsetX=this.translateOffsetY=0;this.scaleOffsetX=this.scaleOffsetY=1;this.clear();this.viz.resize(H,E,this)},translate:function(E,I,F){var H=this.scaleOffsetX,G=this.scaleOffsetY;this.translateOffsetX+=E*H;this.translateOffsetY+=I*G;this.getCtx().translate(E,I);!F&&this.plot()},scale:function(E,G,F){this.scaleOffsetX*=E;this.scaleOffsetY*=G;this.getCtx().scale(E,G);!F&&this.plot()},clear:function(){var G=this.getSize(),F=this.translateOffsetX,E=this.translateOffsetY,I=this.scaleOffsetX,H=this.scaleOffsetY;this.getCtx().clearRect((-G.width/2-F)*1/I,(-G.height/2-E)*1/H,G.width*1/I,G.height*1/H)},plot:function(){this.clear();this.viz.plot(this)}});n.Background={};n.Background.Circles=new t({initialize:function(E,F){this.viz=E;this.config=d.merge({idSuffix:"-bkcanvas",levelDistance:100,numberOfCircles:6,CanvasStyles:{},offset:0},F)},resize:function(F,E,G){this.plot(G)},plot:function(E){var F=E.canvas,M=E.getCtx(),I=this.config,L=I.CanvasStyles;for(var N in L){M[N]=L[N]}var G=I.numberOfCircles,J=I.levelDistance;for(var H=1;H<=G;H++){M.beginPath();M.arc(0,0,J*H,0,2*Math.PI,false);M.stroke();M.closePath()}}})})();var b=function(C,B){this.theta=C||0;this.rho=B||0};$jit.Polar=b;b.prototype={getc:function(B){return this.toComplex(B)},getp:function(){return this},set:function(B){B=B.getp();this.theta=B.theta;this.rho=B.rho},setc:function(B,C){this.rho=Math.sqrt(B*B+C*C);this.theta=Math.atan2(C,B);if(this.theta<0){this.theta+=Math.PI*2}},setp:function(C,B){this.theta=C;this.rho=B},clone:function(){return new b(this.theta,this.rho)},toComplex:function(D){var B=Math.cos(this.theta)*this.rho;var C=Math.sin(this.theta)*this.rho;if(D){return{x:B,y:C}}return new r(B,C)},add:function(B){return new b(this.theta+B.theta,this.rho+B.rho)},scale:function(B){return new b(this.theta,this.rho*B)},equals:function(B){return this.theta==B.theta&&this.rho==B.rho},$add:function(B){this.theta=this.theta+B.theta;this.rho+=B.rho;return this},$madd:function(B){this.theta=(this.theta+B.theta)%(Math.PI*2);this.rho+=B.rho;return this},$scale:function(B){this.rho*=B;return this},isZero:function(){var C=0.0001,B=Math.abs;return B(this.theta)<C&&B(this.rho)<C},interpolate:function(D,L){var E=Math.PI,H=E*2;var C=function(N){var M=(N<0)?(N%H)+H:N%H;return M};var G=this.theta,J=D.theta;var F,I=Math.abs(G-J);if(I==E){if(G>J){F=C((J+((G-H)-J)*L))}else{F=C((J-H+(G-(J))*L))}}else{if(I>=E){if(G>J){F=C((J+((G-H)-J)*L))}else{F=C((J-H+(G-(J-H))*L))}}else{F=C((J+(G-J)*L))}}var B=(this.rho-D.rho)*L+D.rho;return{theta:F,rho:B}}};var l=function(C,B){return new b(C,B)};b.KER=l(0,0);var r=function(B,C){this.x=B||0;this.y=C||0};$jit.Complex=r;r.prototype={getc:function(){return this},getp:function(B){return this.toPolar(B)},set:function(B){B=B.getc(true);this.x=B.x;this.y=B.y},setc:function(B,C){this.x=B;this.y=C},setp:function(C,B){this.x=Math.cos(C)*B;this.y=Math.sin(C)*B},clone:function(){return new r(this.x,this.y)},toPolar:function(D){var B=this.norm();var C=Math.atan2(this.y,this.x);if(C<0){C+=Math.PI*2}if(D){return{theta:C,rho:B}}return new b(C,B)},norm:function(){return Math.sqrt(this.squaredNorm())},squaredNorm:function(){return this.x*this.x+this.y*this.y},add:function(B){return new r(this.x+B.x,this.y+B.y)},prod:function(B){return new r(this.x*B.x-this.y*B.y,this.y*B.x+this.x*B.y)},conjugate:function(){return new r(this.x,-this.y)},scale:function(B){return new r(this.x*B,this.y*B)},equals:function(B){return this.x==B.x&&this.y==B.y},$add:function(B){this.x+=B.x;this.y+=B.y;return this},$prod:function(D){var B=this.x,C=this.y;this.x=B*D.x-C*D.y;this.y=C*D.x+B*D.y;return this},$conjugate:function(){this.y=-this.y;return this},$scale:function(B){this.x*=B;this.y*=B;return this},$div:function(E){var B=this.x,D=this.y;var C=E.squaredNorm();this.x=B*E.x+D*E.y;this.y=D*E.x-B*E.y;return this.$scale(1/C)},isZero:function(){var C=0.0001,B=Math.abs;return B(this.x)<C&&B(this.y)<C}};var u=function(C,B){return new r(C,B)};r.KER=u(0,0);r.IM=u(0,1);$jit.Graph=new t({initialize:function(D,C,B,H){var F={klass:r,Node:{}};this.Node=C;this.Edge=B;this.Label=H;this.opt=d.merge(F,D||{});this.nodes={};this.edges={};var E=this;this.nodeList={};for(var G in k){E.nodeList[G]=(function(I){return function(){var J=Array.prototype.slice.call(arguments);E.eachNode(function(L){L[I].apply(L,J)})}})(G)}},getNode:function(B){if(this.hasNode(B)){return this.nodes[B]}return false},get:function(B){return this.getNode(B)},getByName:function(B){for(var D in this.nodes){var C=this.nodes[D];if(C.name==B){return C}}return false},getAdjacence:function(C,B){if(C in this.edges){return this.edges[C][B]}return false},addNode:function(C){if(!this.nodes[C.id]){var B=this.edges[C.id]={};this.nodes[C.id]=new f.Node(d.extend({id:C.id,name:C.name,data:d.merge(C.data||{},{}),adjacencies:B},this.opt.Node),this.opt.klass,this.Node,this.Edge,this.Label)}return this.nodes[C.id]},addAdjacence:function(E,D,C){if(!this.hasNode(E.id)){this.addNode(E)}if(!this.hasNode(D.id)){this.addNode(D)}E=this.nodes[E.id];D=this.nodes[D.id];if(!E.adjacentTo(D)){var F=this.edges[E.id]=this.edges[E.id]||{};var B=this.edges[D.id]=this.edges[D.id]||{};F[D.id]=B[E.id]=new f.Adjacence(E,D,C,this.Edge,this.Label);return F[D.id]}return this.edges[E.id][D.id]},removeNode:function(D){if(this.hasNode(D)){delete this.nodes[D];var C=this.edges[D];for(var B in C){delete this.edges[B][D]}delete this.edges[D]}},removeAdjacence:function(C,B){delete this.edges[C][B];delete this.edges[B][C]},hasNode:function(B){return B in this.nodes},empty:function(){this.nodes={};this.edges={}}});var f=$jit.Graph;var k;(function(){var B=function(I,L,F,H,J){var G;F=F||"current";I="$"+(I?I+"-":"");if(F=="current"){G=this.data}else{if(F=="start"){G=this.startData}else{if(F=="end"){G=this.endData}}}var E=I+L;if(H){return G[E]}if(!this.Config.overridable){return J[L]||0}return(E in G)?G[E]:((E in this.data)?this.data[E]:(J[L]||0))};var D=function(H,I,G,E){E=E||"current";H="$"+(H?H+"-":"");var F;if(E=="current"){F=this.data}else{if(E=="start"){F=this.startData}else{if(E=="end"){F=this.endData}}}F[H+I]=G};var C=function(G,E){G="$"+(G?G+"-":"");var F=this;d.each(E,function(I){var H=G+I;delete F.data[H];delete F.endData[H];delete F.startData[H]})};k={getData:function(G,E,F){return B.call(this,"",G,E,F,this.Config)},setData:function(G,F,E){D.call(this,"",G,F,E)},setDataset:function(H,I){H=d.splat(H);for(var E in I){for(var G=0,J=d.splat(I[E]),F=H.length;G<F;G++){this.setData(E,J[G],H[G])}}},removeData:function(){C.call(this,"",Array.prototype.slice.call(arguments))},getCanvasStyle:function(G,E,F){return B.call(this,"canvas",G,E,F,this.Config.CanvasStyles)},setCanvasStyle:function(G,F,E){D.call(this,"canvas",G,F,E)},setCanvasStyles:function(H,I){H=d.splat(H);for(var E in I){for(var G=0,J=d.splat(I[E]),F=H.length;G<F;G++){this.setCanvasStyle(E,J[G],H[G])}}},removeCanvasStyle:function(){C.call(this,"canvas",Array.prototype.slice.call(arguments))},getLabelData:function(G,E,F){return B.call(this,"label",G,E,F,this.Label)},setLabelData:function(G,F,E){D.call(this,"label",G,F,E)},setLabelDataset:function(H,I){H=d.splat(H);for(var E in I){for(var G=0,J=d.splat(I[E]),F=H.length;G<F;G++){this.setLabelData(E,J[G],H[G])}}},removeLabelData:function(){C.call(this,"label",Array.prototype.slice.call(arguments))}}})();f.Node=new t({initialize:function(E,B,D,C,G){var F={id:"",name:"",data:{},startData:{},endData:{},adjacencies:{},selected:false,drawn:false,exist:false,angleSpan:{begin:0,end:0},pos:new B,startPos:new B,endPos:new B};d.extend(this,d.extend(F,E));this.Config=this.Node=D;this.Edge=C;this.Label=G},adjacentTo:function(B){return B.id in this.adjacencies},adjacentWithDirectionTo:function(B){var C=B.id in this.adjacencies;if(!C){return false}var D=this.adjacencies[B.id].data.$direction;return D[0]===this.id},getAdjacency:function(B){return this.adjacencies[B]},getPos:function(B){B=B||"current";if(B=="current"){return this.pos}else{if(B=="end"){return this.endPos}else{if(B=="start"){return this.startPos}}}},setPos:function(C,B){B=B||"current";var D;if(B=="current"){D=this.pos}else{if(B=="end"){D=this.endPos}else{if(B=="start"){D=this.startPos}}}D.set(C)}});f.Node.implement(k);f.Adjacence=new t({initialize:function(C,F,D,B,E){this.nodeFrom=C;this.nodeTo=F;this.data=D||{};this.startData={};this.endData={};this.Config=this.Edge=B;this.Label=E}});f.Adjacence.implement(k);f.Util={filter:function(C){if(!C||!(d.type(C)=="string")){return function(){return true}}var B=C.split(" ");return function(E){for(var D=0;D<B.length;D++){if(E[B[D]]){return false}}return true}},getNode:function(B,C){return B.nodes[C]},eachNode:function(F,E,B){var D=this.filter(B);for(var C in F.nodes){if(D(F.nodes[C])){E(F.nodes[C])}}},each:function(D,C,B){this.eachNode(D,C,B)},eachAdjacency:function(G,H,C){var D=G.adjacencies,F=this.filter(C);for(var I in D){var B=D[I];if(F(B)){if(B.nodeFrom!=G){var E=B.nodeFrom;B.nodeFrom=B.nodeTo;B.nodeTo=E}H(B,I)}}},computeLevels:function(H,I,E,D){E=E||0;var F=this.filter(D);this.eachNode(H,function(J){J._flag=false;J._depth=-1},D);var C=H.getNode(I);C._depth=E;var B=[C];while(B.length!=0){var G=B.pop();G._flag=true;this.eachAdjacency(G,function(J){var L=J.nodeTo;if(L._flag==false&&F(L)&&!J._hiding){if(L._depth<0){L._depth=G._depth+1+E}B.unshift(L)}},D)}},eachBFS:function(G,H,F,C){var D=this.filter(C);this.clean(G);var B=[G.getNode(H)];while(B.length!=0){var E=B.pop();if(!E){return}E._flag=true;F(E,E._depth);this.eachAdjacency(E,function(I){var J=I.nodeTo;if(J._flag==false&&D(J)&&!I._hiding){J._flag=true;B.unshift(J)}},C)}},eachLevel:function(F,L,C,G,E){var J=F._depth,B=this.filter(E),H=this,I=true;C=C===false?Number.MAX_VALUE-J:C;(function D(P,M,N){if(!I){return}var Q=P._depth,O;if(Q>=M&&Q<=N&&B(P)){O=G(P,Q)}if(typeof O!=="undefined"){I=O}if(I&&Q<N){H.eachAdjacency(P,function(R){var S=R.nodeTo;if(S._depth>Q){D(S,M,N)}})}})(F,L+J,C+J)},eachSubgraph:function(C,D,B){this.eachLevel(C,0,false,D,B)},eachSubnode:function(C,D,B){this.eachLevel(C,1,1,D,B)},anySubnode:function(E,D,C){var B=false;D=D||d.lambda(true);var F=d.type(D)=="string"?function(G){return G[D]}:D;this.eachSubnode(E,function(G){if(F(G)){B=true}},C);return B},getSubnodes:function(G,H,B){var D=[],F=this;H=H||0;var E,C;if(d.type(H)=="array"){E=H[0];C=H[1]}else{E=H;C=Number.MAX_VALUE-G._depth}this.eachLevel(G,E,C,function(I){D.push(I)},B);return D},getParents:function(C){var B=[];this.eachAdjacency(C,function(D){var E=D.nodeTo;if(E._depth<C._depth){B.push(E)}});return B},isDescendantOf:function(E,F){if(E.id==F){return true}var D=this.getParents(E),B=false;for(var C=0;!B&&C<D.length;C++){B=B||this.isDescendantOf(D[C],F)}return B},clean:function(B){this.eachNode(B,function(C){C._flag=false})},getClosestNodeToOrigin:function(C,D,B){return this.getClosestNodeToPos(C,b.KER,D,B)},getClosestNodeToPos:function(D,G,F,B){var C=null;F=F||"current";G=G&&G.getc(true)||r.KER;var E=function(I,H){var L=I.x-H.x,J=I.y-H.y;return L*L+J*J};this.eachNode(D,function(H){C=(C==null||E(H.getPos(F).getc(true),G)<E(C.getPos(F).getc(true),G))?H:C},B);return C}};d.each(["get","getNode","each","eachNode","computeLevels","eachBFS","clean","getClosestNodeToPos","getClosestNodeToOrigin"],function(B){f.prototype[B]=function(){return f.Util[B].apply(f.Util,[this].concat(Array.prototype.slice.call(arguments)))}});d.each(["eachAdjacency","eachLevel","eachSubgraph","eachSubnode","anySubnode","getSubnodes","getParents","isDescendantOf"],function(B){f.Node.prototype[B]=function(){return f.Util[B].apply(f.Util,[this].concat(Array.prototype.slice.call(arguments)))}});f.Op={options:{type:"nothing",duration:2000,hideLabels:true,fps:30},initialize:function(B){this.viz=B},removeNode:function(G,E){var B=this.viz;var C=d.merge(this.options,B.controller,E);var I=d.splat(G);var D,F,H;switch(C.type){case"nothing":for(D=0;D<I.length;D++){C.onBeforeRemoveNode(B.graph.getNode(I[D]));B.graph.removeNode(I[D])}break;case"replot":this.removeNode(I,{type:"nothing"});B.labels.clearLabels();B.refresh(true);break;case"fade:seq":case"fade":F=this;for(D=0;D<I.length;D++){H=B.graph.getNode(I[D]);H.setData("alpha",0,"end")}B.fx.animate(d.merge(C,{modes:["node-property:alpha"],onComplete:function(){F.removeNode(I,{type:"nothing"});B.labels.clearLabels();B.reposition();B.fx.animate(d.merge(C,{modes:["linear"]}))}}));break;case"fade:con":F=this;for(D=0;D<I.length;D++){H=B.graph.getNode(I[D]);H.setData("alpha",0,"end");H.ignore=true}B.reposition();B.fx.animate(d.merge(C,{modes:["node-property:alpha","linear"],onComplete:function(){F.removeNode(I,{type:"nothing"});C.onComplete&&C.onComplete()}}));break;case"iter":F=this;B.fx.sequence({condition:function(){return I.length!=0},step:function(){F.removeNode(I.shift(),{type:"nothing"});B.labels.clearLabels()},onComplete:function(){C.onComplete&&C.onComplete()},duration:Math.ceil(C.duration/I.length)});break;default:this.doError()}},removeEdge:function(I,G){var B=this.viz;var E=d.merge(this.options,B.controller,G);var D=(d.type(I[0])=="string")?[I]:I;var F,H,C;switch(E.type){case"nothing":for(F=0;F<D.length;F++){B.graph.removeAdjacence(D[F][0],D[F][1])}break;case"replot":this.removeEdge(D,{type:"nothing"});B.refresh(true);break;case"fade:seq":case"fade":H=this;for(F=0;F<D.length;F++){C=B.graph.getAdjacence(D[F][0],D[F][1]);if(C){C.setData("alpha",0,"end")}}B.fx.animate(d.merge(E,{modes:["edge-property:alpha"],onComplete:function(){H.removeEdge(D,{type:"nothing"});B.reposition();B.fx.animate(d.merge(E,{modes:["linear"]}))}}));break;case"fade:con":H=this;for(F=0;F<D.length;F++){C=B.graph.getAdjacence(D[F][0],D[F][1]);if(C){C.setData("alpha",0,"end");C.ignore=true}}B.reposition();B.fx.animate(d.merge(E,{modes:["edge-property:alpha","linear"],onComplete:function(){H.removeEdge(D,{type:"nothing"});E.onComplete&&E.onComplete()}}));break;case"iter":H=this;B.fx.sequence({condition:function(){return D.length!=0},step:function(){H.removeEdge(D.shift(),{type:"nothing"});B.labels.clearLabels()},onComplete:function(){E.onComplete()},duration:Math.ceil(E.duration/D.length)});break;default:this.doError()}},sum:function(F,E){var B=this.viz;var D=d.merge(this.options,B.controller,E),C=B.root;var H;B.root=E.id||B.root;switch(D.type){case"nothing":H=B.construct(F);H.eachNode(function(J){J.eachAdjacency(function(L){B.graph.addAdjacence(L.nodeFrom,L.nodeTo,L.data)})});break;case"replot":B.refresh(true);this.sum(F,{type:"nothing"});B.refresh(true);break;case"fade:seq":case"fade":case"fade:con":that=this;H=B.construct(F);var I=this.preprocessSum(H);var G=!I?["node-property:alpha"]:["node-property:alpha","edge-property:alpha"];B.reposition();if(D.type!="fade:con"){B.fx.animate(d.merge(D,{modes:["linear"],onComplete:function(){B.fx.animate(d.merge(D,{modes:G,onComplete:function(){D.onComplete()}}))}}))}else{B.graph.eachNode(function(J){if(J.id!=C&&J.pos.isZero()){J.pos.set(J.endPos);J.startPos.set(J.endPos)}});B.fx.animate(d.merge(D,{modes:["linear"].concat(G)}))}break;default:this.doError()}},morph:function(J,C,E){E=E||{};var G=this.viz;var L=d.merge(this.options,G.controller,C),F=G.root;var H;G.root=C.id||G.root;switch(L.type){case"nothing":H=G.construct(J);H.eachNode(function(O){var N=G.graph.hasNode(O.id);O.eachAdjacency(function(S){var R=!!G.graph.getAdjacence(S.nodeFrom.id,S.nodeTo.id);G.graph.addAdjacence(S.nodeFrom,S.nodeTo,S.data);if(R){var Q=G.graph.getAdjacence(S.nodeFrom.id,S.nodeTo.id);for(var T in (S.data||{})){Q.data[T]=S.data[T]}}});if(N){var M=G.graph.getNode(O.id);for(var P in (O.data||{})){M.data[P]=O.data[P]}}});G.graph.eachNode(function(M){M.eachAdjacency(function(N){if(!H.getAdjacence(N.nodeFrom.id,N.nodeTo.id)){G.graph.removeAdjacence(N.nodeFrom.id,N.nodeTo.id)}});if(!H.hasNode(M.id)){G.graph.removeNode(M.id)}});break;case"replot":G.labels.clearLabels(true);this.morph(J,{type:"nothing"});G.refresh(true);G.refresh(true);break;case"fade:seq":case"fade":case"fade:con":that=this;H=G.construct(J);var I=("node-property" in E)&&d.map(d.splat(E["node-property"]),function(M){return"$"+M});G.graph.eachNode(function(N){var O=H.getNode(N.id);if(!O){N.setData("alpha",1);N.setData("alpha",1,"start");N.setData("alpha",0,"end");N.ignore=true}else{var M=O.data;for(var P in M){if(I&&(d.indexOf(I,P)>-1)){N.endData[P]=M[P]}else{N.data[P]=M[P]}}}});G.graph.eachNode(function(M){if(M.ignore){return}M.eachAdjacency(function(N){if(N.nodeFrom.ignore||N.nodeTo.ignore){return}var O=H.getNode(N.nodeFrom.id);var P=H.getNode(N.nodeTo.id);if(!O.adjacentTo(P)){var N=G.graph.getAdjacence(O.id,P.id);B=true;N.setData("alpha",1);N.setData("alpha",1,"start");N.setData("alpha",0,"end");N._hiding=true}else{if(N.data.$direction&&N.data.$direction[0]===O.id){if(!O.adjacentWithDirectionTo(P)){N._reversing=true}}}})});var B=this.preprocessSum(H);var D=!B?["node-property:alpha"]:["node-property:alpha","edge-property:alpha"];D[0]=D[0]+(("node-property" in E)?(":"+d.splat(E["node-property"]).join(":")):"");D[1]=(D[1]||"edge-property:alpha")+(("edge-property" in E)?(":"+d.splat(E["edge-property"]).join(":")):"");if("label-property" in E){D.push("label-property:"+d.splat(E["label-property"]).join(":"))}if(G.reposition){G.reposition()}else{G.compute("end")}this._updateDirectedEdges();G.graph.eachNode(function(M){if(M.id!=F&&M.pos.getp().equals(b.KER)){M.pos.set(M.endPos);M.startPos.set(M.endPos)}});G.fx.animate(d.merge(L,{modes:[E.position||"polar"].concat(D),onComplete:function(){G.graph.eachNode(function(M){if(M.ignore){G.graph.removeNode(M.id)}});G.graph.eachNode(function(M){M.eachAdjacency(function(N){if(N.ignore){G.graph.removeAdjacence(N.nodeFrom.id,N.nodeTo.id)}})});L.onComplete()}}));break;default:}},_updateDirectedEdges:function(){var B=this.viz.graph;B.eachNode(function(C){C.eachAdjacency(function(F){var G=F.data.$direction;if(G&&F.nodeFrom.id!==F.data.$direction[0]){return}if(F._hiding){B.removeAdjacence(F.nodeFrom.id,F.nodeTo.id)}if(F._reversing){var I=F.nodeFrom.id;var H=F.nodeTo.id;var E=B.edges[I][H];var D=B.edges[H][I];E.data.$direction=[H,I];D.data.$direction=[H,I];F._reversing=undefined}})})},contract:function(D,C){var B=this.viz;if(D.collapsed||!D.anySubnode(d.lambda(true))){return}C=d.merge(this.options,B.config,C||{},{modes:["node-property:alpha:span","linear"]});D.collapsed=true;(function E(F){F.eachSubnode(function(G){G.ignore=true;G.setData("alpha",0,C.type=="animate"?"end":"current");E(G)})})(D);if(C.type=="animate"){B.compute("end");if(B.rotated){B.rotate(B.rotated,"none",{property:"end"})}(function E(F){F.eachSubnode(function(G){G.setPos(D.getPos("end"),"end");E(G)})})(D);B.fx.animate(C)}else{if(C.type=="replot"){B.refresh()}}},expand:function(D,C){if(!("collapsed" in D)){return}var B=this.viz;C=d.merge(this.options,B.config,C||{},{modes:["node-property:alpha:span","linear"]});delete D.collapsed;(function E(F){F.eachSubnode(function(G){delete G.ignore;G.setData("alpha",1,C.type=="animate"?"end":"current");E(G)})})(D);if(C.type=="animate"){B.compute("end");if(B.rotated){B.rotate(B.rotated,"none",{property:"end"})}B.fx.animate(C)}else{if(C.type=="replot"){B.refresh()}}},preprocessSum:function(C){var B=this.viz;C.eachNode(function(E){if(!B.graph.hasNode(E.id)){B.graph.addNode(E);var F=B.graph.getNode(E.id);F.setData("alpha",0);F.setData("alpha",0,"start");F.setData("alpha",1,"end")}});var D=false;C.eachNode(function(E){E.eachAdjacency(function(F){var G=B.graph.getNode(F.nodeFrom.id);var H=B.graph.getNode(F.nodeTo.id);if(!G.adjacentTo(H)){var F=B.graph.addAdjacence(G,H,F.data);if(G.startAlpha==G.endAlpha&&H.startAlpha==H.endAlpha){D=true;F.setData("alpha",0);F.setData("alpha",0,"start");F.setData("alpha",1,"end")}}})});return D}};var a={none:{render:d.empty,contains:d.lambda(false)},circle:{render:function(E,F,B,D){var C=D.getCtx();C.beginPath();C.arc(F.x,F.y,B,0,Math.PI*2,true);C.closePath();C[E]()},contains:function(G,F,B){var D=G.x-F.x,C=G.y-F.y,E=D*D+C*C;return E<=B*B}},ellipse:{render:function(H,J,B,L,C){var M=C.getCtx(),E=1,D=1,I=1,G=1,F=0;if(B>L){F=B/2;D=L/B;G=B/L}else{F=L/2;E=B/L;I=L/B}M.save();M.scale(E,D);M.beginPath();M.arc(J.x*I,J.y*G,F,0,Math.PI*2,true);M.closePath();M[H]();M.restore()},contains:function(B,I,C,L){var H=0,G=1,F=1,E=0,D=0,J=0;if(C>L){H=C/2;F=L/C}else{H=L/2;G=C/L}E=(B.x-I.x)*(1/G);D=(B.y-I.y)*(1/F);J=E*E+D*D;return J<=H*H}},square:{render:function(C,E,D,B){B.getCtx()[C+"Rect"](E.x-D,E.y-D,2*D,2*D)},contains:function(D,C,B){return Math.abs(C.x-D.x)<=B&&Math.abs(C.y-D.y)<=B}},rectangle:{render:function(E,F,D,B,C){C.getCtx()[E+"Rect"](F.x-D/2,F.y-B/2,D,B)},contains:function(E,D,C,B){return Math.abs(D.x-E.x)<=C/2&&Math.abs(D.y-E.y)<=B/2}},triangle:{render:function(H,I,E,B){var M=B.getCtx(),D=I.x,C=I.y-E,L=D-E,J=I.y+E,G=D+E,F=J;M.beginPath();M.moveTo(D,C);M.lineTo(L,J);M.lineTo(G,F);M.closePath();M[H]()},contains:function(D,C,B){return a.circle.contains(D,C,B)}},star:{render:function(F,H,G,C){var B=C.getCtx(),E=Math.PI/5;B.save();B.translate(H.x,H.y);B.beginPath();B.moveTo(G,0);for(var D=0;D<9;D++){B.rotate(E);if(D%2==0){B.lineTo((G/0.525731)*0.200811,0)}else{B.lineTo(G,0)}}B.closePath();B[F]();B.restore()},contains:function(D,C,B){return a.circle.contains(D,C,B)}}};var o={line:{render:function(E,D,C){var B=C.getCtx();B.beginPath();B.moveTo(E.x,E.y);B.lineTo(D.x,D.y);B.stroke()},contains:function(M,D,G,J){var E=Math.min,H=Math.max,C=E(M.x,D.x)-J,L=H(M.x,D.x)+J,B=E(M.y,D.y)-J,I=H(M.y,D.y)+J;if(G.x>=C&&G.x<=L&&G.y>=B&&G.y<=I){if(Math.abs(D.x-M.x)<=J){return true}var F=(D.y-M.y)/(D.x-M.x)*(G.x-M.x)+M.y;return Math.abs(F-G.y)<=J}return false}},arrow:{render:function(O,P,F,C,B,D){var Q=B.getCtx();if(C){var E=O;O=P;P=E}var I=new r(P.x-O.x,P.y-O.y);I.$scale(F/I.norm());var M;switch(D){case"end":M=I;break;case"center":M=new r((P.x-O.x)/2,(P.y-O.y)/2);break}var G=new r(P.x-M.x,P.y-M.y),H=new r(-I.y/2,I.x/2),J=G.add(I),N=G.add(H),L=G.$add(H.$scale(-1));Q.beginPath();Q.moveTo(O.x,O.y);Q.lineTo(P.x,P.y);Q.stroke();Q.beginPath();Q.moveTo(N.x,N.y);Q.moveTo(N.x,N.y);Q.lineTo(L.x,L.y);Q.lineTo(J.x,J.y);Q.closePath();Q.fill()},contains:function(C,B,E,D){return o.line.contains(C,B,E,D)}},hyperline:{render:function(I,J,B,D){var L=D.getCtx();var E=F(I,J);if(E.a>1000||E.b>1000||E.ratio<0){L.beginPath();L.moveTo(I.x*B,I.y*B);L.lineTo(J.x*B,J.y*B);L.stroke()}else{var H=Math.atan2(J.y-E.y,J.x-E.x);var G=Math.atan2(I.y-E.y,I.x-E.x);var C=C(H,G);L.beginPath();L.arc(E.x*B,E.y*B,E.ratio*B,H,G,C);L.stroke()}function F(Y,X){var Q=(Y.x*X.y-Y.y*X.x),M=Q;var P=Y.squaredNorm(),O=X.squaredNorm();if(Q==0){return{x:0,y:0,ratio:-1}}var W=(Y.y*O-X.y*P+Y.y-X.y)/Q;var U=(X.x*P-Y.x*O+X.x-Y.x)/M;var V=-W/2;var T=-U/2;var S=(W*W+U*U)/4-1;if(S<0){return{x:0,y:0,ratio:-1}}var R=Math.sqrt(S);var N={x:V,y:T,ratio:R>1000?-1:R,a:W,b:U};return N}function C(M,N){return(M<N)?((M+Math.PI>N)?false:true):((N+Math.PI>M)?true:false)}},contains:d.lambda(false)}};f.Plot={initialize:function(C,B){this.viz=C;this.config=C.config;this.node=C.config.Node;this.edge=C.config.Edge;this.animation=new z;this.nodeTypes=new B.Plot.NodeTypes;this.edgeTypes=new B.Plot.EdgeTypes;this.labels=C.labels},nodeHelper:a,edgeHelper:o,Interpolator:{map:{border:"color",color:"color",width:"number",height:"number",dim:"number",alpha:"number",lineWidth:"number",angularWidth:"number",span:"number",valueArray:"array-number",dimArray:"array-number",vertices:"polygon"},canvas:{globalAlpha:"number",fillStyle:"color",strokeStyle:"color",lineWidth:"number",shadowBlur:"number",shadowColor:"color",shadowOffsetX:"number",shadowOffsetY:"number",miterLimit:"number"},label:{size:"number",color:"color"},compute:function(D,C,B){return D+(C-D)*B},moebius:function(G,F,I,C){var E=C.scale(-I);if(E.norm()<1){var B=E.x,H=E.y;var D=G.startPos.getc().moebiusTransformation(E);G.pos.setc(D.x,D.y);E.x=B;E.y=H}},linear:function(C,B,F){var E=C.startPos.getc(true);var D=C.endPos.getc(true);C.pos.setc(this.compute(E.x,D.x,F),this.compute(E.y,D.y,F))},polar:function(D,C,G){var F=D.startPos.getp(true);var E=D.endPos.getp();var B=E.interpolate(F,G);D.pos.setp(B.theta,B.rho)},number:function(C,H,G,B,F){var E=C[B](H,"start");var D=C[B](H,"end");C[F](H,this.compute(E,D,G))},color:function(D,B,J,G,E){var H=d.hexToRgb(D[G](B,"start"));var I=d.hexToRgb(D[G](B,"end"));var F=this.compute;var C=d.rgbToHex([parseInt(F(H[0],I[0],J)),parseInt(F(H[1],I[1],J)),parseInt(F(H[2],I[2],J))]);D[E](B,C)},"array-number":function(E,D,P,M,G){var N=E[M](D,"start"),O=E[M](D,"end"),Q=[];for(var J=0,F=N.length;J<F;J++){var C=N[J],B=O[J];if(C.length){for(var I=0,L=C.length,H=[];I<L;I++){H.push(this.compute(C[I],B[I],P))}Q.push(H)}else{Q.push(this.compute(C,B,P))}}E[G](D,Q)},node:function(C,H,J,B,I,D){B=this[B];if(H){var G=H.length;for(var E=0;E<G;E++){var F=H[E];this[B[F]](C,F,J,I,D)}}else{for(var F in B){this[B[F]](C,F,J,I,D)}}},edge:function(D,C,I,E,B,H){var G=D.adjacencies;for(var F in G){this["node"](G[F],C,I,E,B,H)}},"node-property":function(C,B,D){this["node"](C,B,D,"map","getData","setData")},"edge-property":function(C,B,D){this["edge"](C,B,D,"map","getData","setData")},"label-property":function(C,B,D){this["node"](C,B,D,"label","getLabelData","setLabelData")},"node-style":function(C,B,D){this["node"](C,B,D,"canvas","getCanvasStyle","setCanvasStyle")},"edge-style":function(C,B,D){this["edge"](C,B,D,"canvas","getCanvasStyle","setCanvasStyle")},polygon:function(E,D,P,L,G){var N=E[L](D,"start"),O=E[L](D,"end"),Q=[];if(typeof N.offset=="undefined"){if(N===0){N=d.map(O,function(){return new $jit.Complex(0,0)});N.offset=0}else{if(N.length==0){N.push(new $jit.Complex(0,0))}while(N.length<O.length){N.push(N[0])}while(N.length>O.length){O.push(O[0]||new $jit.Complex(0,0))}if(N.length==0){return}var F=N.length;var M=1e+300;for(var H=0;H<F;H++){var J=0;for(var I=0;I<F;I++){J+=Geometry.dist2(N[(H+I)%F],O[I])}if(J<M){N.offset=H;M=J}}}}for(var I=0,F=N.length;I<F;I++){var C=N[(I+N.offset)%F],B=O[I];Q.push(new $jit.Complex(this.compute(C.x,B.x,P),this.compute(C.y,B.y,P)))}E[G](D,Q)}},sequence:function(C){var D=this;C=d.merge({condition:d.lambda(false),step:d.empty,onComplete:d.empty,duration:200},C||{});var B=setInterval(function(){if(C.condition()){C.step()}else{clearInterval(B);C.onComplete()}D.viz.refresh(true)},C.duration)},prepare:function(H){var G=this.viz.graph,E={"node-property":{getter:"getData",setter:"setData"},"edge-property":{getter:"getData",setter:"setData"},"node-style":{getter:"getCanvasStyle",setter:"setCanvasStyle"},"edge-style":{getter:"getCanvasStyle",setter:"setCanvasStyle"}};var C={};if(d.type(H)=="array"){for(var F=0,B=H.length;F<B;F++){var D=H[F].split(":");C[D.shift()]=D}}else{for(var I in H){if(I=="position"){C[H.position]=[]}else{C[I]=d.splat(H[I])}}}G.eachNode(function(J){J.startPos.set(J.pos);d.each(["node-property","node-style"],function(N){if(N in C){var O=C[N];for(var M=0,L=O.length;M<L;M++){J[E[N].setter](O[M],J[E[N].getter](O[M]),"start")}}});d.each(["edge-property","edge-style"],function(L){if(L in C){var M=C[L];J.eachAdjacency(function(O){for(var P=0,N=M.length;P<N;P++){O[E[L].setter](M[P],O[E[L].getter](M[P]),"start")}})}})});return C},animate:function(E,D){E=d.merge(this.viz.config,E||{});var F=this,C=this.viz,H=C.graph,I=this.Interpolator,G=E.type==="nodefx"?this.nodeFxAnimation:this.animation;var B=this.prepare(E.modes);if(E.hideLabels){this.labels.hideLabels(true)}G.setOptions(d.extend(E,{$animating:false,compute:function(J){H.eachNode(function(L){for(var M in B){I[M](L,B[M],J,D)}});F.plot(E,this.$animating,J);this.$animating=true},complete:function(){if(E.hideLabels){F.labels.hideLabels(false)}F.plot(E);E.onComplete()}})).start()},nodeFx:function(D){if(this.nodeFxAnimation==undefined){this.nodeFxAnimation=new z()}var I=this.viz,J=I.graph,G=this.nodeFxAnimation,L=d.merge(this.viz.config,{elements:{id:false,properties:{}},reposition:false});D=d.merge(L,D||{},{onBeforeCompute:d.empty,onAfterCompute:d.empty});G.stopTimer();var H=D.elements.properties;if(!D.elements.id){J.eachNode(function(N){for(var M in H){N.setData(M,H[M],"end")}})}else{var B=d.splat(D.elements.id);d.each(B,function(O){var N=J.getNode(O);if(N){for(var M in H){N.setData(M,H[M],"end")}}})}var F=[];for(var C in H){F.push(C)}var E=["node-property:"+F.join(":")];if(D.reposition){E.push("linear");I.compute("end")}this.animate(d.merge(D,{modes:E,type:"nodefx"}))},plot:function(C,M){var J=this.viz,G=J.graph,D=J.canvas,B=J.root,H=this,L=D.getCtx(),F=Math.min,C=C||this.viz.controller;C.clearCanvas&&D.clear();var I=G.getNode(B);if(!I){return}var E=!!I.visited;G.eachNode(function(O){var N=O.getData("alpha");O.eachAdjacency(function(P){var Q=P.nodeTo;if(!!Q.visited===E&&O.drawn&&Q.drawn){!M&&C.onBeforePlotLine(P);H.plotLine(P,D,M);!M&&C.onAfterPlotLine(P)}});if(O.drawn){!M&&C.onBeforePlotNode(O);H.plotNode(O,D,M);!M&&C.onAfterPlotNode(O)}if(!H.labelsHidden&&C.withLabels){if(O.drawn&&N>=0.95){H.labels.plotLabel(D,O,C)}else{H.labels.hideLabel(O,false)}}O.visited=!E})},plotTree:function(F,C,J){var G=this,H=this.viz,D=H.canvas,E=this.config,I=D.getCtx();var B=F.getData("alpha");F.eachSubnode(function(M){if(C.plotSubtree(F,M)&&M.exist&&M.drawn){var L=F.getAdjacency(M.id);!J&&C.onBeforePlotLine(L);G.plotLine(L,D,J);!J&&C.onAfterPlotLine(L);G.plotTree(M,C,J)}});if(F.drawn){!J&&C.onBeforePlotNode(F);this.plotNode(F,D,J);!J&&C.onAfterPlotNode(F);if(!C.hideLabels&&C.withLabels&&B>=0.95){this.labels.plotLabel(D,F,C)}else{this.labels.hideLabel(F,false)}}else{this.labels.hideLabel(F,true)}},plotNode:function(D,C,L){var H=D.getData("type"),G=this.node.CanvasStyles;if(H!="none"){var B=D.getData("lineWidth"),F=D.getData("color"),E=D.getData("alpha"),I=C.getCtx();I.save();I.lineWidth=B;I.fillStyle=I.strokeStyle=F;I.globalAlpha=E;for(var J in G){I[J]=D.getCanvasStyle(J)}this.nodeTypes[H].render.call(this,D,C,L);I.restore()}},plotLine:function(H,C,M){var G=H.getData("type"),E=this.edge.CanvasStyles;if(G!="none"){var B=H.getData("lineWidth"),D=H.getData("color"),J=C.getCtx(),F=H.nodeFrom,I=H.nodeTo;J.save();J.lineWidth=B;J.fillStyle=J.strokeStyle=D;J.globalAlpha=Math.min(F.getData("alpha"),I.getData("alpha"),H.getData("alpha"));for(var L in E){J[L]=H.getCanvasStyle(L)}this.edgeTypes[G].render.call(this,H,C,M);J.restore()}}};f.Plot3D=d.merge(f.Plot,{Interpolator:{linear:function(C,B,F){var E=C.startPos.getc(true);var D=C.endPos.getc(true);C.pos.setc(this.compute(E.x,D.x,F),this.compute(E.y,D.y,F),this.compute(E.z,D.z,F))}},plotNode:function(C,B){if(C.getData("type")=="none"){return}this.plotElement(C,B,{getAlpha:function(){return C.getData("alpha")}})},plotLine:function(B,C){if(B.getData("type")=="none"){return}this.plotElement(B,C,{getAlpha:function(){return Math.min(B.nodeFrom.getData("alpha"),B.nodeTo.getData("alpha"),B.getData("alpha"))}})},plotElement:function(ae,J,E){var ab=J.getCtx(),L=new Matrix4,C=J.config.Scene.Lighting,af=J.canvases[0],Q=af.program,ad=af.camera;if(!ae.geometry){ae.geometry=new O3D[ae.getData("type")]}ae.geometry.update(ae);if(!ae.webGLVertexBuffer){var P=[],G=[],V=[],T=0,Y=ae.geometry;for(var ac=0,aa=Y.vertices,N=Y.faces,M=N.length;ac<M;ac++){var S=N[ac],I=aa[S.a],H=aa[S.b],F=aa[S.c],D=S.d?aa[S.d]:false,X=S.normal;P.push(I.x,I.y,I.z);P.push(H.x,H.y,H.z);P.push(F.x,F.y,F.z);if(D){P.push(D.x,D.y,D.z)}V.push(X.x,X.y,X.z);V.push(X.x,X.y,X.z);V.push(X.x,X.y,X.z);if(D){V.push(X.x,X.y,X.z)}G.push(T,T+1,T+2);if(D){G.push(T,T+2,T+3);T+=4}else{T+=3}}ae.webGLVertexBuffer=ab.createBuffer();ab.bindBuffer(ab.ARRAY_BUFFER,ae.webGLVertexBuffer);ab.bufferData(ab.ARRAY_BUFFER,new Float32Array(P),ab.STATIC_DRAW);ae.webGLFaceBuffer=ab.createBuffer();ab.bindBuffer(ab.ELEMENT_ARRAY_BUFFER,ae.webGLFaceBuffer);ab.bufferData(ab.ELEMENT_ARRAY_BUFFER,new Uint16Array(G),ab.STATIC_DRAW);ae.webGLFaceCount=G.length;ae.webGLNormalBuffer=ab.createBuffer();ab.bindBuffer(ab.ARRAY_BUFFER,ae.webGLNormalBuffer);ab.bufferData(ab.ARRAY_BUFFER,new Float32Array(V),ab.STATIC_DRAW)}L.multiply(ad.matrix,ae.geometry.matrix);ab.uniformMatrix4fv(Q.viewMatrix,false,L.flatten());ab.uniformMatrix4fv(Q.projectionMatrix,false,ad.projectionMatrix.flatten());var R=Matrix4.makeInvert(L);R.$transpose();ab.uniformMatrix4fv(Q.normalMatrix,false,R.flatten());var Z=d.hexToRgb(ae.getData("color"));Z.push(E.getAlpha());ab.uniform4f(Q.color,Z[0]/255,Z[1]/255,Z[2]/255,Z[3]);ab.uniform1i(Q.enableLighting,C.enable);if(C.enable){if(C.ambient){var U=C.ambient;ab.uniform3f(Q.ambientColor,U[0],U[1],U[2])}if(C.directional){var W=C.directional,Z=W.color,O=W.direction,B=new Vector3(O.x,O.y,O.z).normalize().$scale(-1);ab.uniform3f(Q.lightingDirection,B.x,B.y,B.z);ab.uniform3f(Q.directionalColor,Z[0],Z[1],Z[2])}}ab.bindBuffer(ab.ARRAY_BUFFER,ae.webGLVertexBuffer);ab.vertexAttribPointer(Q.position,3,ab.FLOAT,false,0,0);ab.bindBuffer(ab.ARRAY_BUFFER,ae.webGLNormalBuffer);ab.vertexAttribPointer(Q.normal,3,ab.FLOAT,false,0,0);ab.bindBuffer(ab.ELEMENT_ARRAY_BUFFER,ae.webGLFaceBuffer);ab.drawElements(ab.TRIANGLES,ae.webGLFaceCount,ab.UNSIGNED_SHORT,0)}});f.Label={};f.Label.Native=new t({initialize:function(B){this.viz=B},plotLabel:function(D,E,C){var B=D.getCtx();var F=E.pos.getc(true);B.font=E.getLabelData("style")+" "+E.getLabelData("size")+"px "+E.getLabelData("family");B.textAlign=E.getLabelData("textAlign");B.fillStyle=B.strokeStyle=E.getLabelData("color");B.textBaseline=E.getLabelData("textBaseline");this.renderLabel(D,E,C)},renderLabel:function(D,E,C){var B=D.getCtx();var F=E.pos.getc(true);B.fillText(E.name,F.x,F.y+E.getData("height")/2)},hideLabel:function(C,B){C=d.splat(C);var D=B?false:true;d.each(C,function(E){E._hideLabel=D})},hideLabels:d.empty});f.Label.DOM=new t({labelsHidden:false,labelContainer:false,labels:{},getLabelContainer:function(){return this.labelContainer?this.labelContainer:this.labelContainer=document.getElementById(this.viz.config.labelContainer)},getLabel:function(B){return(B in this.labels&&this.labels[B]!=null)?this.labels[B]:this.labels[B]=document.getElementById(B)},hideLabels:function(C){var B=this.getLabelContainer();if(C){B.style.display="none"}else{B.style.display=""}this.labelsHidden=C},clearLabels:function(B){for(var C in this.labels){if(B||!this.viz.graph.hasNode(C)){this.disposeLabel(C);delete this.labels[C]}}},disposeLabel:function(C){var B=this.getLabel(C);if(B&&B.parentNode){B.parentNode.removeChild(B)}},hideLabel:function(F,B){F=d.splat(F);var C=B?"":"none",D,E=this;d.each(F,function(G){D=E.getLabel(G.id);if(D){D.style.display=C}})},fitsInCanvas:function(D,B){var C=B.getSize();if(D.w&&D.h){if(D.x>=C.width||D.x<-D.w||D.y>=C.height||D.y<-D.h){return false}}else{if(D.x>=C.width||D.x<0||D.y>=C.height||D.y<0){return false}}return true}});f.Label.HTML=new t({Implements:f.Label.DOM,plotLabel:function(E,F,D){var G=F.id,B=this.getLabel(G);if(!B&&!(B=document.getElementById(G))){B=document.createElement("div");var C=this.getLabelContainer();B.id=G;B.className="node";B.style.position="absolute";D.onCreateLabel(B,F);C.appendChild(B);this.labels[F.id]=B}this.placeLabel(B,F,D)}});f.Label.SVG=new t({Implements:f.Label.DOM,plotLabel:function(E,G,D){var I=G.id,B=this.getLabel(I);if(!B&&!(B=document.getElementById(I))){var F="http://www.w3.org/2000/svg";B=document.createElementNS(F,"svg:text");var H=document.createElementNS(F,"svg:tspan");B.appendChild(H);var C=this.getLabelContainer();B.setAttribute("id",I);B.setAttribute("class","node");C.appendChild(B);D.onCreateLabel(B,G);this.labels[G.id]=B}this.placeLabel(B,G,D)}});f.Geom=new t({initialize:function(B){this.viz=B;this.config=B.config;this.node=B.config.Node;this.edge=B.config.Edge},translate:function(C,B){B=d.splat(B);this.viz.graph.eachNode(function(D){d.each(B,function(E){D.getPos(E).$add(C)})})},setRightLevelToShow:function(E,B,G){var F=this.getRightLevelToShow(E,B),D=this.viz.labels,C=d.merge({execShow:true,execHide:true,onHide:d.empty,onShow:d.empty},G||{});E.eachLevel(0,this.config.levelsToShow,function(I){var H=I._depth-E._depth;if(H>F){C.onHide(I);if(C.execHide){I.drawn=false;I.exist=false;D.hideLabel(I,false)}}else{C.onShow(I);if(C.execShow){I.exist=true}}});E.drawn=true},getRightLevelToShow:function(E,C){var B=this.config;var F=B.levelsToShow;var D=B.constrained;if(!D){return F}while(!this.treeFitsInCanvas(E,C,F)&&F>1){F--}return F}});var e={construct:function(C){var D=(d.type(C)=="array");var B=new f(this.graphOptions,this.config.Node,this.config.Edge,this.config.Label);if(!D){(function(E,G){E.addNode(G);if(G.children){for(var F=0,H=G.children;F<H.length;F++){E.addAdjacence(G,H[F]);arguments.callee(E,H[F])}}})(B,C)}else{(function(N,O){var F=function(S){for(var R=0,P=O.length;R<P;R++){if(O[R].id==S){return O[R]}}var Q={id:S,name:S};return N.addNode(Q)};for(var J=0,G=O.length;J<G;J++){N.addNode(O[J]);var L=O[J].adjacencies;if(L){for(var H=0,M=L.length;H<M;H++){var E=L[H],I={};if(typeof L[H]!="string"){I=d.merge(E.data,{});E=E.nodeTo}N.addAdjacence(O[J],F(E),I)}}}})(B,C)}return B},loadJSON:function(C,B){this.json=C;if(this.labels&&this.labels.clearLabels){this.labels.clearLabels(true)}this.graph=this.construct(C);if(d.type(C)!="array"){this.root=C.id}else{this.root=C[B?B:0].id}},toJSON:function(F){F=F||"tree";if(F=="tree"){var D={};var C=this.graph.getNode(this.root);var D=(function B(I){var G={};G.id=I.id;G.name=I.name;G.data=I.data;var H=[];I.eachSubnode(function(J){H.push(B(J))});G.children=H;return G})(C);return D}else{var D=[];var E=!!this.graph.getNode(this.root).visited;this.graph.eachNode(function(H){var G={};G.id=H.id;G.name=H.name;G.data=H.data;var I=[];H.eachAdjacency(function(J){var M=J.nodeTo;if(!!M.visited===E){var L={};L.nodeTo=M.id;L.data=J.data;I.push(L)}});G.adjacencies=I;D.push(G);H.visited=!E});return D}}};var h=$jit.Layouts={};var g={label:null,compute:function(E,F,C){this.initializeLabel(C);var B=this.label,D=B.style;E.eachNode(function(I){var N=I.getData("autoWidth"),O=I.getData("autoHeight");if(N||O){delete I.data.$width;delete I.data.$height;delete I.data.$dim;var G=I.getData("width"),P=I.getData("height");D.width=N?"auto":G+"px";D.height=O?"auto":P+"px";B.innerHTML=I.name;var L=B.offsetWidth,H=B.offsetHeight;var M=I.getData("type");if(d.indexOf(["circle","square","triangle","star"],M)===-1){I.setData("width",L);I.setData("height",H)}else{var J=L>H?L:H;I.setData("width",J);I.setData("height",J);I.setData("dim",J)}}})},initializeLabel:function(B){if(!this.label){this.label=document.createElement("div");document.body.appendChild(this.label)}this.setLabelStyles(B)},setLabelStyles:function(B){d.extend(this.label.style,{visibility:"hidden",position:"absolute",width:"auto",height:"auto"});this.label.className="jit-autoadjust-label"}};h.Tree=(function(){var L=Array.prototype.slice;function I(V,Q,N,T,O){var S=Q.Node;var P=Q.multitree;if(S.overridable){var U=-1,R=-1;V.eachNode(function(Y){if(Y._depth==N&&(!P||("$orn" in Y.data)&&Y.data.$orn==T)){var W=Y.getData("width",O);var X=Y.getData("height",O);U=(U<W)?W:U;R=(R<X)?X:R}});return{width:U<0?S.width:U,height:R<0?S.height:R}}else{return S}}function M(O,R,Q,N){var P=(N=="left"||N=="right")?"y":"x";O.getPos(R)[P]+=Q}function G(O,P){var N=[];d.each(O,function(Q){Q=L.call(Q);Q[0]+=P;Q[1]+=P;N.push(Q)});return N}function J(Q,N){if(Q.length==0){return N}if(N.length==0){return Q}var P=Q.shift(),O=N.shift();return[[P[0],O[1]]].concat(J(Q,N))}function E(N,O){O=O||[];if(N.length==0){return O}var P=N.pop();return E(N,J(P,O))}function H(Q,O,R,N,P){if(Q.length<=P||O.length<=P){return 0}var T=Q[P][1],S=O[P][0];return Math.max(H(Q,O,R,N,++P)+R,T-S+N)}function F(Q,O,N){function P(T,V,S){if(V.length<=S){return[]}var U=V[S],R=H(T,U,O,N,0);return[R].concat(P(J(T,G(U,R)),V,++S))}return P([],Q,0)}function C(R,Q,P){function N(U,W,T){if(W.length<=T){return[]}var V=W[T],S=-H(V,U,Q,P,0);return[S].concat(N(J(G(V,S),U),W,++T))}R=L.call(R);var O=N([],R.reverse(),0);return O.reverse()}function B(T,R,O,U){var P=F(T,R,O),S=C(T,R,O);if(U=="left"){S=P}else{if(U=="right"){P=S}}for(var Q=0,N=[];Q<P.length;Q++){N[Q]=(P[Q]+S[Q])/2}return N}function D(N,X,O,ae,ac){var Q=ae.multitree;var W=["x","y"],T=["width","height"];var P=+(ac=="left"||ac=="right");var U=W[P],ad=W[1-P];var Z=ae.Node;var S=T[P],ab=T[1-P];var R=ae.siblingOffset;var aa=ae.subtreeOffset;var Y=ae.align;function V(ah,al,ap){var ag=ah.getData(S,O);var ao=al||(ah.getData(ab,O));var at=[],aq=[],am=false;var af=ao+ae.levelDistance;ah.eachSubnode(function(av){if(av.exist&&(!Q||("$orn" in av.data)&&av.data.$orn==ac)){if(ae.levelSpacing=="even"){if(!am){am=I(N,ae,av._depth,ac,O)}}else{am={width:av.getData("width"),height:av.getData("height")}}var au=V(av,am[ab],ap+af);at.push(au.tree);aq.push(au.extent)}});var ak=B(aq,aa,R,Y);for(var aj=0,ai=[],an=[];aj<at.length;aj++){M(at[aj],O,ak[aj],ac);an.push(G(aq[aj],ak[aj]))}var ar=[[-ag/2,ag/2]].concat(E(an));ah.getPos(O)[U]=0;if(ac=="top"||ac=="left"){ah.getPos(O)[ad]=ap}else{ah.getPos(O)[ad]=-ap}return{tree:ah,extent:ar}}V(X,false,0)}return new t({compute:function(P,O){var Q=P||"start";var N=this.graph.getNode(this.root);d.extend(N,{drawn:true,exist:true,selected:true});g.compute(this.graph,Q,this.config);if(!!O||!("_depth" in N)){this.graph.computeLevels(this.root,0,"ignore")}this.computePositions(N,Q)},computePositions:function(R,N){var P=this.config;var O=P.multitree;var U=P.align;var Q=U!=="center"&&P.indent;var V=P.orientation;var T=O?["top","right","bottom","left"]:[V];var S=this;d.each(T,function(W){D(S.graph,R,N,S.config,W,N);var X=["x","y"][+(W=="left"||W=="right")];(function Y(Z){Z.eachSubnode(function(aa){if(aa.exist&&(!O||("$orn" in aa.data)&&aa.data.$orn==W)){aa.getPos(N)[X]+=Z.getPos(N)[X];if(Q){aa.getPos(N)[X]+=U=="left"?Q:-Q}Y(aa)}})})(R)})}})})();$jit.ST=(function(){var C=[];function D(I){I=I||this.clickedNode;if(!this.config.constrained){return[]}var F=this.geom;var N=this.graph;var G=this.canvas;var E=I._depth,J=[];N.eachNode(function(O){if(O.exist&&!O.selected){if(O.isDescendantOf(I.id)){if(O._depth<=E){J.push(O)}}else{J.push(O)}}});var L=F.getRightLevelToShow(I,G);I.eachLevel(L,L,function(O){if(O.exist&&!O.selected){J.push(O)}});for(var M=0;M<C.length;M++){var H=this.graph.getNode(C[M]);if(!H.isDescendantOf(I.id)){J.push(H)}}return J}function B(G){var F=[],E=this.config;G=G||this.clickedNode;this.clickedNode.eachLevel(0,E.levelsToShow,function(H){if(E.multitree&&!("$orn" in H.data)&&H.anySubnode(function(I){return I.exist&&!I.drawn})){F.push(H)}else{if(H.drawn&&!H.anySubnode("drawn")){F.push(H)}}});return F}return new t({Implements:[e,q,h.Tree],initialize:function(E){var G=$jit.ST;var F={levelsToShow:2,levelDistance:30,constrained:true,Node:{type:"rectangle"},duration:700,offsetX:0,offsetY:0};this.controller=this.config=d.merge(p("Canvas","Fx","Tree","Node","Edge","Controller","Tips","NodeStyles","Events","Navigation","Label"),F,E);var H=this.config;if(H.useCanvas){this.canvas=H.useCanvas;this.config.labelContainer=this.canvas.id+"-label"}else{if(H.background){H.background=d.merge({type:"Circles"},H.background)}this.canvas=new n(this,H);this.config.labelContainer=(typeof H.injectInto=="string"?H.injectInto:H.injectInto.id)+"-label"}this.graphOptions={klass:r};this.graph=new f(this.graphOptions,this.config.Node,this.config.Edge);this.labels=new G.Label[H.Label.type](this);this.fx=new G.Plot(this,G);this.op=new G.Op(this);this.group=new G.Group(this);this.geom=new G.Geom(this);this.clickedNode=null;this.initializeExtras()},plot:function(){this.fx.plot(this.controller)},switchPosition:function(J,I,H){var E=this.geom,F=this.fx,G=this;if(!F.busy){F.busy=true;this.contract({onComplete:function(){E.switchOrientation(J);G.compute("end",false);F.busy=false;if(I=="animate"){G.onClick(G.clickedNode.id,H)}else{if(I=="replot"){G.select(G.clickedNode.id,H)}}}},J)}},switchAlignment:function(G,F,E){this.config.align=G;if(F=="animate"){this.select(this.clickedNode.id,E)}else{if(F=="replot"){this.onClick(this.clickedNode.id,E)}}},addNodeInPath:function(E){C.push(E);this.select((this.clickedNode&&this.clickedNode.id)||this.root)},clearNodesInPath:function(E){C.length=0;this.select((this.clickedNode&&this.clickedNode.id)||this.root)},refresh:function(){this.reposition();this.select((this.clickedNode&&this.clickedNode.id)||this.root)},reposition:function(){this.graph.computeLevels(this.root,0,"ignore");this.geom.setRightLevelToShow(this.clickedNode,this.canvas);this.graph.eachNode(function(F){if(F.exist){F.drawn=true}});this.compute("end");if(this.clickedNode){var E={x:this.canvas.translateOffsetX+this.config.offsetX||0,y:this.canvas.translateOffsetY+this.config.offsetY||0};this.geom.translate(this.clickedNode.endPos.add(E).$scale(-1),"end")}},requestNodes:function(G,H){var F=d.merge(this.controller,H),E=this.config.levelsToShow;if(F.request){var J=[],I=G._depth;G.eachLevel(0,E,function(L){if(L.drawn&&!L.anySubnode()){J.push(L);L._level=E-(L._depth-I)}});this.group.requestNodes(J,F)}else{F.onComplete()}},contract:function(I,J){var H=this.config.orientation;var E=this.geom,G=this.group;if(J){E.switchOrientation(J)}var F=D.call(this);if(J){E.switchOrientation(H)}G.contract(F,d.merge(this.controller,I))},move:function(F,G){this.compute("end",false);var E=G.Move,H={x:E.offsetX,y:E.offsetY};if(E.enable){this.geom.translate(F.endPos.add(H).$scale(-1),"end")}else{this.geom.translate(u(H.x,H.y).$scale(-1),"end")}this.fx.animate(d.merge(this.controller,{modes:["linear"]},G))},expand:function(F,G){var E=B.call(this,F);this.group.expand(E,d.merge(this.controller,G))},selectPath:function(H){var G=this;this.graph.eachNode(function(J){J.selected=false});function I(L){if(L==null||L.selected){return}L.selected=true;d.each(G.group.getSiblings([L])[L.id],function(M){M.exist=true;M.drawn=true});var J=L.getParents();J=(J.length>0)?J[0]:null;I(J)}for(var E=0,F=[H.id].concat(C);E<F.length;E++){I(this.graph.getNode(F[E]))}},setRoot:function(M,L,J){if(this.busy){return}this.busy=true;var I=this,G=this.canvas;var E=this.graph.getNode(this.root);var F=this.graph.getNode(M);function H(){if(this.config.multitree&&F.data.$orn){var O=F.data.$orn;var P={left:"right",right:"left",top:"bottom",bottom:"top"}[O];E.data.$orn=P;(function N(Q){Q.eachSubnode(function(R){if(R.id!=M){R.data.$orn=P;N(R)}})})(E);delete F.data.$orn}this.root=M;this.clickedNode=F;this.graph.computeLevels(this.root,0,"ignore");this.geom.setRightLevelToShow(F,G,{execHide:false,onShow:function(Q){if(!Q.drawn){Q.drawn=true;Q.setData("alpha",1,"end");Q.setData("alpha",0);Q.pos.setc(F.pos.x,F.pos.y)}}});this.compute("end");this.busy=true;this.fx.animate({modes:["linear","node-property:alpha"],onComplete:function(){I.busy=false;I.onClick(M,{onComplete:function(){J&&J.onComplete()}})}})}delete E.data.$orns;if(L=="animate"){H.call(this);I.selectPath(F)}else{if(L=="replot"){H.call(this);this.select(this.root)}}},addSubtree:function(E,G,F){if(G=="replot"){this.op.sum(E,d.extend({type:"replot"},F||{}))}else{if(G=="animate"){this.op.sum(E,d.extend({type:"fade:seq"},F||{}))}}},removeSubtree:function(J,F,I,H){var G=this.graph.getNode(J),E=[];G.eachLevel(+!F,false,function(L){E.push(L.id)});if(I=="replot"){this.op.removeNode(E,d.extend({type:"replot"},H||{}))}else{if(I=="animate"){this.op.removeNode(E,d.extend({type:"fade:seq"},H||{}))}}},select:function(E,H){var N=this.group,L=this.geom;var I=this.graph.getNode(E),G=this.canvas;var M=this.graph.getNode(this.root);var F=d.merge(this.controller,H);var J=this;F.onBeforeCompute(I);this.selectPath(I);this.clickedNode=I;this.requestNodes(I,{onComplete:function(){N.hide(N.prepare(D.call(J)),F);L.setRightLevelToShow(I,G);J.compute("current");J.graph.eachNode(function(Q){var P=Q.pos.getc(true);Q.startPos.setc(P.x,P.y);Q.endPos.setc(P.x,P.y);Q.visited=false});var O={x:F.offsetX,y:F.offsetY};J.geom.translate(I.endPos.add(O).$scale(-1),["start","current","end"]);N.show(B.call(J));J.plot();F.onAfterCompute(J.clickedNode);F.onComplete()}})},onClick:function(F,N){var H=this.canvas,M=this,E=this.geom,I=this.config;var L={Move:{enable:true,offsetX:H.translateOffsetX+I.offsetX||0,offsetY:H.translateOffsetY+I.offsetY||0},setRightLevelToShowConfig:false,onBeforeRequest:d.empty,onBeforeContract:d.empty,onBeforeMove:d.empty,onBeforeExpand:d.empty};var G=d.merge(this.controller,L,N);if(!this.busy){this.busy=true;var J=this.graph.getNode(F);this.selectPath(J,this.clickedNode);this.clickedNode=J;G.onBeforeCompute(J);G.onBeforeRequest(J);this.requestNodes(J,{onComplete:function(){G.onBeforeContract(J);M.contract({onComplete:function(){E.setRightLevelToShow(J,H,G.setRightLevelToShowConfig);G.onBeforeMove(J);M.move(J,{Move:G.Move,onComplete:function(){G.onBeforeExpand(J);M.expand(J,{onComplete:function(){M.busy=false;G.onAfterCompute(F);G.onComplete()}})}})}})}})}}})})();$jit.ST.$extend=true;$jit.ST.Op=new t({Implements:f.Op});$jit.ST.Group=new t({initialize:function(B){this.viz=B;this.canvas=B.canvas;this.config=B.config;this.animation=new z;this.nodes=null},requestNodes:function(G,F){var E=0,C=G.length,I={};var D=function(){F.onComplete()};var B=this.viz;if(C==0){D()}for(var H=0;H<C;H++){I[G[H].id]=G[H];F.request(G[H].id,G[H]._level,{onComplete:function(L,J){if(J&&J.children){J.id=L;B.op.sum(J,{type:"nothing"})}if(++E==C){B.graph.computeLevels(B.root,0);D()}}})}},contract:function(D,C){var B=this.viz;var E=this;D=this.prepare(D);this.animation.setOptions(d.merge(C,{$animating:false,compute:function(F){if(F==1){F=0.99}E.plotStep(1-F,C,this.$animating);this.$animating="contract"},complete:function(){E.hide(D,C)}})).start()},hide:function(D,C){var B=this.viz;for(var E=0;E<D.length;E++){if(true||!C||!C.request){D[E].eachLevel(1,false,function(G){if(G.exist){d.extend(G,{drawn:false,exist:false})}})}else{var F=[];D[E].eachLevel(1,false,function(G){F.push(G.id)});B.op.removeNode(F,{type:"nothing"});B.labels.clearLabels()}}C.onComplete()},expand:function(C,B){var D=this;this.show(C);this.animation.setOptions(d.merge(B,{$animating:false,compute:function(E){D.plotStep(E,B,this.$animating);this.$animating="expand"},complete:function(){D.plotStep(undefined,B,false);B.onComplete()}})).start()},show:function(B){var C=this.config;this.prepare(B);d.each(B,function(E){if(C.multitree&&!("$orn" in E.data)){delete E.data.$orns;var D=" ";E.eachSubnode(function(F){if(("$orn" in F.data)&&D.indexOf(F.data.$orn)<0&&F.exist&&!F.drawn){D+=F.data.$orn+" "}});E.data.$orns=D}E.eachLevel(0,C.levelsToShow,function(F){if(F.exist){F.drawn=true}})})},prepare:function(B){this.nodes=this.getNodesWithChildren(B);return this.nodes},getNodesWithChildren:function(D){var C=[],F=this.config,B=this.viz.root;D.sort(function(J,I){return(J._depth<=I._depth)-(J._depth>=I._depth)});for(var G=0;G<D.length;G++){if(D[G].anySubnode("exist")){for(var E=G+1,H=false;!H&&E<D.length;E++){if(!F.multitree||"$orn" in D[E].data){H=H||D[G].isDescendantOf(D[E].id)}}if(!H){C.push(D[G])}}}return C},plotStep:function(M,H,O){var L=this.viz,E=this.config,D=L.canvas,N=D.getCtx(),B=this.nodes;var G,F;var C={};for(G=0;G<B.length;G++){F=B[G];C[F.id]=[];var J=E.multitree&&!("$orn" in F.data);var I=J&&F.data.$orns;F.eachSubgraph(function(P){if(J&&I&&I.indexOf(P.data.$orn)>0&&P.drawn){P.drawn=false;C[F.id].push(P)}else{if((!J||!I)&&P.drawn){P.drawn=false;C[F.id].push(P)}}});F.drawn=true}if(B.length>0){L.fx.plot()}for(G in C){d.each(C[G],function(P){P.drawn=true})}for(G=0;G<B.length;G++){F=B[G];N.save();L.fx.plotSubtree(F,H,M,O);N.restore()}},getSiblings:function(B){var C={};d.each(B,function(F){var E=F.getParents();if(E.length==0){C[F.id]=[F]}else{var D=[];E[0].eachSubnode(function(G){D.push(G)});C[F.id]=D}});return C}});$jit.ST.Geom=new t({Implements:f.Geom,switchOrientation:function(B){this.config.orientation=B},dispatch:function(){var C=Array.prototype.slice.call(arguments);var D=C.shift(),B=C.length;var E=function(F){return typeof F=="function"?F():F};if(B==2){return(D=="top"||D=="bottom")?E(C[0]):E(C[1])}else{if(B==4){switch(D){case"top":return E(C[0]);case"right":return E(C[1]);case"bottom":return E(C[2]);case"left":return E(C[3])}}}return undefined},getSize:function(I,H){var G=I.data,D=this.config;var C=D.siblingOffset;var F=(D.multitree&&("$orn" in G)&&G.$orn)||D.orientation;var B=I.getData("width")+C;var E=I.getData("height")+C;if(!H){return this.dispatch(F,E,B)}else{return this.dispatch(F,B,E)}},getTreeBaseSize:function(F,G,C){var D=this.getSize(F,true),B=0,E=this;if(C(G,F)){return D}if(G===0){return 0}F.eachSubnode(function(H){B+=E.getTreeBaseSize(H,G-1,C)});return(D>B?D:B)+this.config.subtreeOffset},getEdge:function(G,F,E){var C=function(J,I){return function(){return G.pos.add(new r(J,I))}};var H=this.node;var B=G.getData("width");var D=G.getData("height");if(F=="begin"){if(H.align=="center"){return this.dispatch(E,C(0,D/2),C(-B/2,0),C(0,-D/2),C(B/2,0))}else{if(H.align=="left"){return this.dispatch(E,C(0,D),C(0,0),C(0,0),C(B,0))}else{if(H.align=="right"){return this.dispatch(E,C(0,0),C(-B,0),C(0,-D),C(0,0))}else{throw"align: not implemented"}}}}else{if(F=="end"){if(H.align=="center"){return this.dispatch(E,C(0,-D/2),C(B/2,0),C(0,D/2),C(-B/2,0))}else{if(H.align=="left"){return this.dispatch(E,C(0,0),C(B,0),C(0,D),C(0,0))}else{if(H.align=="right"){return this.dispatch(E,C(0,-D),C(0,0),C(0,0),C(-B,0))}else{throw"align: not implemented"}}}}}},getScaledTreePosition:function(F,H){var G=this.node;var B=F.getData("width");var E=F.getData("height");var D=(this.config.multitree&&("$orn" in F.data)&&F.data.$orn)||this.config.orientation;var C=function(J,I){return function(){return F.pos.add(new r(J,I)).$scale(1-H)}};if(G.align=="left"){return this.dispatch(D,C(0,E),C(0,0),C(0,0),C(B,0))}else{if(G.align=="center"){return this.dispatch(D,C(0,E/2),C(-B/2,0),C(0,-E/2),C(B/2,0))}else{if(G.align=="right"){return this.dispatch(D,C(0,0),C(-B,0),C(0,-E),C(0,0))}else{throw"align: not implemented"}}}},treeFitsInCanvas:function(G,B,H){var D=B.getSize();var E=(this.config.multitree&&("$orn" in G.data)&&G.data.$orn)||this.config.orientation;var C=this.dispatch(E,D.width,D.height);var F=this.getTreeBaseSize(G,H,function(J,I){return J===0||!I.anySubnode()});return(F<C)}});$jit.ST.Plot=new t({Implements:f.Plot,plotSubtree:function(E,B,F,J){var H=this.viz,C=H.canvas,D=H.config;F=Math.min(Math.max(0.001,F),1);if(F>=0){E.drawn=false;var I=C.getCtx();var G=H.geom.getScaledTreePosition(E,F);I.translate(G.x,G.y);I.scale(F,F)}this.plotTree(E,d.merge(B,{withLabels:true,hideLabels:!!F,plotSubtree:function(O,M){var L=D.multitree&&!("$orn" in E.data);var N=L&&E.getData("orns");return !L||N.indexOf(E.getData("orn"))>-1}}),J);if(F>=0){E.drawn=true}},getAlignedPos:function(G,E,B){var D=this.node;var F,C;if(D.align=="center"){F={x:G.x-E/2,y:G.y-B/2}}else{if(D.align=="left"){C=this.config.orientation;if(C=="bottom"||C=="top"){F={x:G.x-E/2,y:G.y}}else{F={x:G.x,y:G.y-B/2}}}else{if(D.align=="right"){C=this.config.orientation;if(C=="bottom"||C=="top"){F={x:G.x-E/2,y:G.y-B}}else{F={x:G.x-E,y:G.y-B/2}}}else{throw"align: not implemented"}}}return F},getOrientation:function(B){var D=this.config;var C=D.orientation;if(D.multitree){var E=B.nodeFrom;var F=B.nodeTo;C=(("$orn" in E.data)&&E.data.$orn)||(("$orn" in F.data)&&F.data.$orn)}return C}});$jit.ST.Label={};$jit.ST.Label.Native=new t({Implements:f.Label.Native,renderLabel:function(E,G,D){var C=E.getCtx(),I=G.pos.getc(true),F=G.getData("width"),B=G.getData("height"),H=this.viz.fx.getAlignedPos(I,F,B);C.fillText(G.name,H.x+F/2,H.y+B/2)}});$jit.ST.Label.DOM=new t({Implements:f.Label.DOM,placeLabel:function(U,O,J){var F=O.pos.getc(true),T=this.viz.config,P=T.Node,B=this.viz.canvas,G=O.getData("width"),R=O.getData("height"),C=B.getSize(),L,S;var E=B.translateOffsetX,D=B.translateOffsetY,I=B.scaleOffsetX,H=B.scaleOffsetY,N=F.x*I+E,M=F.y*H+D;if(P.align=="center"){L={x:Math.round(N-G/2+C.width/2),y:Math.round(M-R/2+C.height/2)}}else{if(P.align=="left"){S=T.orientation;if(S=="bottom"||S=="top"){L={x:Math.round(N-G/2+C.width/2),y:Math.round(M+C.height/2)}}else{L={x:Math.round(N+C.width/2),y:Math.round(M-R/2+C.height/2)}}}else{if(P.align=="right"){S=T.orientation;if(S=="bottom"||S=="top"){L={x:Math.round(N-G/2+C.width/2),y:Math.round(M-R+C.height/2)}}else{L={x:Math.round(N-G+C.width/2),y:Math.round(M-R/2+C.height/2)}}}else{throw"align: not implemented"}}}L.w=G;L.h=R;var Q=U.style;Q.left=L.x+"px";Q.top=L.y+"px";Q.display=this.fitsInCanvas(L,B)?"":"none";J.onPlaceLabel(U,O)}});$jit.ST.Label.SVG=new t({Implements:[$jit.ST.Label.DOM,f.Label.SVG],initialize:function(B){this.viz=B}});$jit.ST.Label.HTML=new t({Implements:[$jit.ST.Label.DOM,f.Label.HTML],initialize:function(B){this.viz=B}});$jit.ST.Plot.NodeTypes=new t({none:{render:d.empty,contains:d.lambda(false)},circle:{render:function(C,B){var E=C.getData("dim"),F=this.getAlignedPos(C.pos.getc(true),E,E),D=E/2;this.nodeHelper.circle.render("fill",{x:F.x+D,y:F.y+D},D,B)},contains:function(B,F){var D=B.getData("dim"),E=this.getAlignedPos(B.pos.getc(true),D,D),C=D/2;return this.nodeHelper.circle.contains({x:E.x+C,y:E.y+C},F,C)}},square:{render:function(C,B){var E=C.getData("dim"),D=E/2,F=this.getAlignedPos(C.pos.getc(true),E,E);this.nodeHelper.square.render("fill",{x:F.x+D,y:F.y+D},D,B)},contains:function(B,F){var D=B.getData("dim"),E=this.getAlignedPos(B.pos.getc(true),D,D),C=D/2;return this.nodeHelper.square.contains({x:E.x+C,y:E.y+C},F,C)}},ellipse:{render:function(E,C){var D=E.getData("width"),B=E.getData("height"),F=this.getAlignedPos(E.pos.getc(true),D,B);this.nodeHelper.ellipse.render("fill",{x:F.x+D/2,y:F.y+B/2},D,B,C)},contains:function(D,F){var C=D.getData("width"),B=D.getData("height"),E=this.getAlignedPos(D.pos.getc(true),C,B);return this.nodeHelper.ellipse.contains({x:E.x+C/2,y:E.y+B/2},F,C,B)}},rectangle:{render:function(E,C){var D=E.getData("width"),B=E.getData("height"),F=this.getAlignedPos(E.pos.getc(true),D,B);this.nodeHelper.rectangle.render("fill",{x:F.x+D/2,y:F.y+B/2},D,B,C)},contains:function(D,F){var C=D.getData("width"),B=D.getData("height"),E=this.getAlignedPos(D.pos.getc(true),C,B);return this.nodeHelper.rectangle.contains({x:E.x+C/2,y:E.y+B/2},F,C,B)}}});$jit.ST.Plot.EdgeTypes=new t({none:d.empty,line:{render:function(C,E){var D=this.getOrientation(C),F=C.nodeFrom,G=C.nodeTo,B=F._depth<G._depth,I=this.viz.geom.getEdge(B?F:G,"begin",D),H=this.viz.geom.getEdge(B?G:F,"end",D);this.edgeHelper.line.render(I,H,E)},contains:function(C,I){var D=this.getOrientation(C),E=C.nodeFrom,F=C.nodeTo,B=E._depth<F._depth,H=this.viz.geom.getEdge(B?E:F,"begin",D),G=this.viz.geom.getEdge(B?F:E,"end",D);return this.edgeHelper.line.contains(H,G,I,this.edge.epsilon)}},arrow:{render:function(H,C){var G=this.getOrientation(H),D=H.nodeFrom,B=H.nodeTo,M=(D._depth<B._depth),F=H.getData("dim"),L=this.viz.geom.getEdge((M?D:B),"begin",G),J=this.viz.geom.getEdge((M?B:D),"end",G),I=H.data.$direction,E=(I&&I.length>1&&I[0]!=D.id);this.edgeHelper.arrow.render(L,J,F,E,C)},contains:function(C,I){var D=this.getOrientation(C),E=C.nodeFrom,F=C.nodeTo,B=E._depth<F._depth,H=this.viz.geom.getEdge(B?E:F,"begin",D),G=this.viz.geom.getEdge(B?F:E,"end",D);return this.edgeHelper.arrow.contains(H,G,I,this.edge.epsilon)}},"quadratic:begin":{render:function(H,B){var G=this.getOrientation(H);var F=H.nodeFrom,I=H.nodeTo,L=F._depth<I._depth,C=this.viz.geom.getEdge(L?F:I,"begin",G),D=this.viz.geom.getEdge(L?I:F,"end",G),E=H.getData("dim"),J=B.getCtx();J.beginPath();J.moveTo(C.x,C.y);switch(G){case"left":J.quadraticCurveTo(C.x+E,C.y,D.x,D.y);break;case"right":J.quadraticCurveTo(C.x-E,C.y,D.x,D.y);break;case"top":J.quadraticCurveTo(C.x,C.y+E,D.x,D.y);break;case"bottom":J.quadraticCurveTo(C.x,C.y-E,D.x,D.y);break}J.stroke()}},"quadratic:end":{render:function(H,B){var G=this.getOrientation(H);var F=H.nodeFrom,I=H.nodeTo,L=F._depth<I._depth,C=this.viz.geom.getEdge(L?F:I,"begin",G),D=this.viz.geom.getEdge(L?I:F,"end",G),E=H.getData("dim"),J=B.getCtx();J.beginPath();J.moveTo(C.x,C.y);switch(G){case"left":J.quadraticCurveTo(D.x-E,D.y,D.x,D.y);break;case"right":J.quadraticCurveTo(D.x+E,D.y,D.x,D.y);break;case"top":J.quadraticCurveTo(D.x,D.y-E,D.x,D.y);break;case"bottom":J.quadraticCurveTo(D.x,D.y+E,D.x,D.y);break}J.stroke()}},bezier:{render:function(H,B){var G=this.getOrientation(H),F=H.nodeFrom,I=H.nodeTo,L=F._depth<I._depth,C=this.viz.geom.getEdge(L?F:I,"begin",G),D=this.viz.geom.getEdge(L?I:F,"end",G),E=H.getData("dim"),J=B.getCtx();J.beginPath();J.moveTo(C.x,C.y);switch(G){case"left":J.bezierCurveTo(C.x+E,C.y,D.x-E,D.y,D.x,D.y);break;case"right":J.bezierCurveTo(C.x-E,C.y,D.x+E,D.y,D.x,D.y);break;case"top":J.bezierCurveTo(C.x,C.y+E,D.x,D.y-E,D.x,D.y);break;case"bottom":J.bezierCurveTo(C.x,C.y-E,D.x,D.y+E,D.x,D.y);break}J.stroke()}}});$jit.ST.Plot.NodeTypes.implement({"areachart-stacked":{render:function(aa,G){var Y=aa.pos.getc(true),B=aa.getData("width"),D=aa.getData("height"),J=this.getAlignedPos(Y,B,D),af=J.x,ae=J.y,P=aa.getData("stringArray"),I=aa.getData("dimArray"),E=aa.getData("valueArray"),ah=d.reduce(E,function(ao,ap){return ao+ap[0]},0),ag=d.reduce(E,function(ao,ap){return ao+ap[1]},0),M=aa.getData("colorArray"),F=M.length,ac=aa.getData("config"),N=aa.getData("gradient"),an=ac.showLabels,R=ac.showAggregates,aj=ac.Label,X=aa.getData("prev");var Q=G.getCtx(),L=aa.getData("border");if(M&&I&&P){for(var am=0,ak=I.length,O=0,H=0,ab=0;am<ak;am++){Q.fillStyle=Q.strokeStyle=M[am%F];Q.save();if(N&&(I[am][0]>0||I[am][1]>0)){var V=O+I[am][0],T=H+I[am][1],al=Math.atan((T-V)/B),ad=55;var Z=Q.createLinearGradient(af+B/2,ae-(V+T)/2,af+B/2+ad*Math.sin(al),ae-(V+T)/2+ad*Math.cos(al));var U=d.rgbToHex(d.map(d.hexToRgb(M[am%F].slice(1)),function(ao){return(ao*0.85)>>0}));Z.addColorStop(0,M[am%F]);Z.addColorStop(1,U);Q.fillStyle=Z}Q.beginPath();Q.moveTo(af,ae-O);Q.lineTo(af+B,ae-H);Q.lineTo(af+B,ae-H-I[am][1]);Q.lineTo(af,ae-O-I[am][0]);Q.lineTo(af,ae-O);Q.fill();Q.restore();if(L){var W=L.name==P[am];var C=W?0.7:0.8;var U=d.rgbToHex(d.map(d.hexToRgb(M[am%F].slice(1)),function(ao){return(ao*C)>>0}));Q.strokeStyle=U;Q.lineWidth=W?4:1;Q.save();Q.beginPath();if(L.index===0){Q.moveTo(af,ae-O);Q.lineTo(af,ae-O-I[am][0])}else{Q.moveTo(af+B,ae-H);Q.lineTo(af+B,ae-H-I[am][1])}Q.stroke();Q.restore()}O+=(I[am][0]||0);H+=(I[am][1]||0);if(I[am][0]>0){ab+=(E[am][0]||0)}}if(X&&aj.type=="Native"){Q.save();Q.beginPath();Q.fillStyle=Q.strokeStyle=aj.color;Q.font=aj.style+" "+aj.size+"px "+aj.family;Q.textAlign="center";Q.textBaseline="middle";var S=R(aa.name,ah,ag,aa,ab);if(S!==false){Q.fillText(S!==true?S:ab,af,ae-O-ac.labelOffset-aj.size/2,B)}var ai=an(aa.name,ah,ag,aa);if(ai!==false){Q.fillText(ai!==true?ai:aa.name,af,ae+aj.size/2+ac.labelOffset)}Q.restore()}}},contains:function(F,H){var N=F.pos.getc(true),C=F.getData("width"),R=F.getData("height"),Q=this.getAlignedPos(N,C,R),P=Q.x,O=Q.y,S=F.getData("dimArray"),B=H.x-P;if(H.x<P||H.x>P+C||H.y>O||H.y<O-R){return false}for(var I=0,G=S.length,M=O,D=O;I<G;I++){var E=S[I];M-=E[0];D-=E[1];var J=M+(D-M)*B/C;if(H.y>=J){var L=+(B>C/2);return{name:F.getData("stringArray")[I],color:F.getData("colorArray")[I],value:F.getData("valueArray")[I][L],index:L}}}return false}}});$jit.AreaChart=new t({st:null,colors:["#416D9C","#70A35E","#EBB056","#C74243","#83548B","#909291","#557EAA"],selected:{},busy:false,initialize:function(D){this.controller=this.config=d.merge(p("Canvas","Margin","Label","AreaChart"),{Label:{type:"Native"}},D);var E=this.config.showLabels,C=d.type(E),F=this.config.showAggregates,B=d.type(F);this.config.showLabels=C=="function"?E:d.lambda(E);this.config.showAggregates=B=="function"?F:d.lambda(F);this.initializeViz()},initializeViz:function(){var C=this.config,G=this,B=C.type.split(":")[0],F={};var E=new $jit.ST({injectInto:C.injectInto,width:C.width,height:C.height,orientation:"bottom",levelDistance:0,siblingOffset:0,subtreeOffset:0,withLabels:C.Label.type!="Native",useCanvas:C.useCanvas,Label:{type:C.Label.type},Node:{overridable:true,type:"areachart-"+B,align:"left",width:1,height:1},Edge:{type:"none"},Tips:{enable:C.Tips.enable,type:"Native",force:true,onShow:function(M,L,I){var J=I;C.Tips.onShow(M,J,L)}},Events:{enable:true,type:"Native",onClick:function(L,M,I){if(!C.filterOnClick&&!C.Events.enable){return}var J=M.getContains();if(J){C.filterOnClick&&G.filter(J.name)}C.Events.enable&&C.Events.onClick(J,M,I)},onRightClick:function(J,L,I){if(!C.restoreOnRightClick){return}G.restore()},onMouseMove:function(L,M,I){if(!C.selectOnHover){return}if(L){var J=M.getContains();G.select(L.id,J.name,J.index)}else{G.select(false,false,false)}}},onCreateLabel:function(P,M){var V=C.Label,U=M.getData("valueArray"),N=d.reduce(U,function(W,X){return W+X[0]},0),S=d.reduce(U,function(W,X){return W+X[1]},0);if(M.getData("prev")){var R={wrapper:document.createElement("div"),aggregate:document.createElement("div"),label:document.createElement("div")};var I=R.wrapper,T=R.label,J=R.aggregate,L=I.style,Q=T.style,O=J.style;F[M.id]=R;I.appendChild(T);I.appendChild(J);if(!C.showLabels(M.name,N,S,M)){T.style.display="none"}if(!C.showAggregates(M.name,N,S,M)){J.style.display="none"}L.position="relative";L.overflow="visible";L.fontSize=V.size+"px";L.fontFamily=V.family;L.color=V.color;L.textAlign="center";O.position=Q.position="absolute";P.style.width=M.getData("width")+"px";P.style.height=M.getData("height")+"px";T.innerHTML=M.name;P.appendChild(I)}},onPlaceLabel:function(ab,V){if(!V.getData("prev")){return}var Z=F[V.id],J=Z.wrapper.style,I=Z.label.style,U=Z.aggregate.style,S=V.getData("width"),Q=V.getData("height"),P=V.getData("dimArray"),M=V.getData("valueArray"),R=d.reduce(M,function(ac,ad){return ac+ad[0]},0),N=d.reduce(M,function(ac,ad){return ac+ad[1]},0),O=parseInt(J.fontSize,10),T=ab.style;if(P&&M){if(C.showLabels(V.name,R,N,V)){I.display=""}else{I.display="none"}var L=C.showAggregates(V.name,R,N,V);if(L!==false){U.display=""}else{U.display="none"}J.width=U.width=I.width=ab.style.width=S+"px";U.left=I.left=-S/2+"px";for(var Y=0,W=M.length,X=0,aa=0;Y<W;Y++){if(P[Y][0]>0){X+=M[Y][0];aa+=P[Y][0]}}U.top=(-O-C.labelOffset)+"px";I.top=(C.labelOffset+aa)+"px";ab.style.top=parseInt(ab.style.top,10)-aa+"px";ab.style.height=J.height=aa+"px";Z.aggregate.innerHTML=L!==true?L:X}}});var D=E.canvas.getSize(),H=C.Margin;E.config.offsetY=-D.height/2+H.bottom+(C.showLabels&&(C.labelOffset+C.Label.size));E.config.offsetX=(H.right-H.left)/2;this.delegate=E;this.canvas=this.delegate.canvas},loadJSON:function(T){var P=d.time(),G=[],S=this.delegate,W=d.splat(T.label),O=d.splat(T.color||this.colors),U=this.config,C=!!U.type.split(":")[1],E=U.animate;for(var Q=0,D=T.values,N=D.length;Q<N-1;Q++){var V=D[Q],J=D[Q-1],L=D[Q+1];var R=d.splat(D[Q].values),B=d.splat(D[Q+1].values);var F=d.zip(R,B);var I=0,H=0;G.push({id:P+V.label,name:V.label,data:{value:F,"$valueArray":F,"$colorArray":O,"$stringArray":W,"$next":L.label,"$prev":J?J.label:false,"$config":U,"$gradient":C},children:[]})}var M={id:P+"$root",name:"",data:{"$type":"none","$width":1,"$height":1},children:G};S.loadJSON(M);this.normalizeDims();S.compute();S.select(S.root);if(E){S.fx.animate({modes:["node-property:height:dimArray"],duration:1500})}},updateJSON:function(M,C){if(this.busy){return}this.busy=true;var I=this.delegate,L=I.graph,F=M.label&&d.splat(M.label),J=M.values,B=this.config.animate,H=this,G={};for(var E=0,D=J.length;E<D;E++){G[J[E].label]=J[E]}L.eachNode(function(R){var N=G[R.name],O=R.getData("stringArray"),Q=R.getData("valueArray"),P=R.getData("next");if(N){N.values=d.splat(N.values);d.each(Q,function(S,T){S[0]=N.values[T];if(F){O[T]=F[T]}});R.setData("valueArray",Q)}if(P){N=G[P];if(N){d.each(Q,function(S,T){S[1]=N.values[T]})}}});this.normalizeDims();I.compute();I.select(I.root);if(B){I.fx.animate({modes:["node-property:height:dimArray"],duration:1500,onComplete:function(){H.busy=false;C&&C.onComplete()}})}},filter:function(E,F){if(this.busy){return}this.busy=true;if(this.config.Tips.enable){this.delegate.tips.hide()}this.select(false,false,false);var C=d.splat(E);var B=this.delegate.graph.getNode(this.delegate.root);var D=this;this.normalizeDims();B.eachAdjacency(function(G){var J=G.nodeTo,I=J.getData("dimArray","end"),H=J.getData("stringArray");J.setData("dimArray",d.map(I,function(M,L){return(d.indexOf(C,H[L])>-1)?M:[0,0]}),"end")});this.delegate.fx.animate({modes:["node-property:dimArray"],duration:1500,onComplete:function(){D.busy=false;F&&F.onComplete()}})},restore:function(C){if(this.busy){return}this.busy=true;if(this.config.Tips.enable){this.delegate.tips.hide()}this.select(false,false,false);this.normalizeDims();var B=this;this.delegate.fx.animate({modes:["node-property:height:dimArray"],duration:1500,onComplete:function(){B.busy=false;C&&C.onComplete()}})},select:function(G,C,B){if(!this.config.selectOnHover){return}var D=this.selected;if(D.id!=G||D.name!=C||D.index!=B){D.id=G;D.name=C;D.index=B;this.delegate.graph.eachNode(function(H){H.setData("border",false)});if(G){var F=this.delegate.graph.getNode(G);F.setData("border",D);var E=B===0?"prev":"next";E=F.getData(E);if(E){F=this.delegate.graph.getByName(E);if(F){F.setData("border",{name:C,index:1-B})}}}this.delegate.plot()}},getLegend:function(){var D={};var E;this.delegate.graph.getNode(this.delegate.root).eachAdjacency(function(F){E=F.nodeTo});var C=E.getData("colorArray"),B=C.length;d.each(E.getData("stringArray"),function(G,F){D[G]=C[F%B]});return D},getMaxValue:function(){var B=0;this.delegate.graph.eachNode(function(G){var D=G.getData("valueArray"),C=0,F=0;d.each(D,function(H){C+=+H[0];F+=+H[1]});var E=F>C?F:C;B=B>E?B:E});return B},normalizeDims:function(){var H=this.delegate.graph.getNode(this.delegate.root),E=0;H.eachAdjacency(function(){E++});var G=this.getMaxValue()||1,L=this.delegate.canvas.getSize(),D=this.config,F=D.Margin,I=D.labelOffset+D.Label.size,B=(L.width-(F.left+F.right))/E,C=D.animate,J=L.height-(F.top+F.bottom)-(D.showAggregates&&I)-(D.showLabels&&I);this.delegate.graph.eachNode(function(R){var O=0,Q=0,M=[];d.each(R.getData("valueArray"),function(S){O+=+S[0];Q+=+S[1];M.push([0,0])});var P=Q>O?Q:O;R.setData("width",B);if(C){R.setData("height",P*J/G,"end");R.setData("dimArray",d.map(R.getData("valueArray"),function(S){return[S[0]*J/G,S[1]*J/G]}),"end");var N=R.getData("dimArray");if(!N){R.setData("dimArray",M)}}else{R.setData("height",P*J/G);R.setData("dimArray",d.map(R.getData("valueArray"),function(S){return[S[0]*J/G,S[1]*J/G]}))}})}});p.BarChart={$extend:true,animate:true,type:"stacked",labelOffset:3,barsOffset:0,hoveredColor:"#9fd4ff",orientation:"horizontal",showAggregates:true,showLabels:true,Tips:{enable:false,onShow:d.empty,onHide:d.empty},Events:{enable:false,onClick:d.empty}};$jit.ST.Plot.NodeTypes.implement({"barchart-stacked":{render:function(V,F){var L=V.pos.getc(true),U=V.getData("width"),S=V.getData("height"),Q=this.getAlignedPos(L,U,S),P=Q.x,O=Q.y,R=V.getData("dimArray"),I=V.getData("valueArray"),H=V.getData("colorArray"),E=H.length,ac=V.getData("stringArray");var X=F.getCtx(),B={},Y=V.getData("border"),C=V.getData("gradient"),ae=V.getData("config"),D=ae.orientation=="horizontal",G=ae.showAggregates,T=ae.showLabels,N=ae.Label;if(H&&R&&ac){for(var ab=0,W=R.length,aa=0,J=0;ab<W;ab++){X.fillStyle=X.strokeStyle=H[ab%E];if(C){var ad;if(D){ad=X.createLinearGradient(P+aa+R[ab]/2,O,P+aa+R[ab]/2,O+S)}else{ad=X.createLinearGradient(P,O-aa-R[ab]/2,P+U,O-aa-R[ab]/2)}var Z=d.rgbToHex(d.map(d.hexToRgb(H[ab%E].slice(1)),function(af){return(af*0.5)>>0}));ad.addColorStop(0,Z);ad.addColorStop(0.5,H[ab%E]);ad.addColorStop(1,Z);X.fillStyle=ad}if(D){X.fillRect(P+aa,O,R[ab],S)}else{X.fillRect(P,O-aa-R[ab],U,R[ab])}if(Y&&Y.name==ac[ab]){B.acum=aa;B.dimValue=R[ab]}aa+=(R[ab]||0);J+=(I[ab]||0)}if(Y){X.save();X.lineWidth=2;X.strokeStyle=Y.color;if(D){X.strokeRect(P+B.acum+1,O+1,B.dimValue-2,S-2)}else{X.strokeRect(P+1,O-B.acum-B.dimValue+1,U-2,B.dimValue-2)}X.restore()}if(N.type=="Native"){X.save();X.fillStyle=X.strokeStyle=N.color;X.font=N.style+" "+N.size+"px "+N.family;X.textBaseline="middle";var M=G(V.name,J,V);if(M!==false){M=M!==true?M:J;if(D){X.textAlign="right";X.fillText(M,P+aa-ae.labelOffset,O+S/2)}else{X.textAlign="center";X.fillText(M,P+U/2,O-S-N.size/2-ae.labelOffset)}}if(T(V.name,J,V)){if(D){X.textAlign="center";X.translate(P-ae.labelOffset-N.size/2,O+S/2);X.rotate(Math.PI/2);X.fillText(V.name,0,0)}else{X.textAlign="center";X.fillText(V.name,P+U/2,O+N.size/2+ae.labelOffset)}}X.restore()}}},contains:function(G,I){var M=G.pos.getc(true),D=G.getData("width"),R=G.getData("height"),Q=this.getAlignedPos(M,D,R),P=Q.x,N=Q.y,S=G.getData("dimArray"),E=G.getData("config"),C=I.x-P,B=E.orientation=="horizontal";if(B){if(I.x<P||I.x>P+D||I.y>N+R||I.y<N){return false}}else{if(I.x<P||I.x>P+D||I.y>N||I.y<N-R){return false}}for(var J=0,H=S.length,O=(B?P:N);J<H;J++){var F=S[J];if(B){O+=F;var L=O;if(I.x<=L){return{name:G.getData("stringArray")[J],color:G.getData("colorArray")[J],value:G.getData("valueArray")[J],label:G.name}}}else{O-=F;var L=O;if(I.y>=L){return{name:G.getData("stringArray")[J],color:G.getData("colorArray")[J],value:G.getData("valueArray")[J],label:G.name}}}}return false}},"barchart-grouped":{render:function(X,F){var M=X.pos.getc(true),W=X.getData("width"),U=X.getData("height"),R=this.getAlignedPos(M,W,U),Q=R.x,P=R.y,T=X.getData("dimArray"),J=X.getData("valueArray"),ad=J.length,I=X.getData("colorArray"),E=I.length,af=X.getData("stringArray");var Z=F.getCtx(),B={},aa=X.getData("border"),C=X.getData("gradient"),ah=X.getData("config"),D=ah.orientation=="horizontal",H=ah.showAggregates,V=ah.showLabels,O=ah.Label,G=(D?U:W)/ad;if(I&&T&&af){for(var ae=0,Y=ad,ac=0,L=0;ae<Y;ae++){Z.fillStyle=Z.strokeStyle=I[ae%E];if(C){var ag;if(D){ag=Z.createLinearGradient(Q+T[ae]/2,P+G*ae,Q+T[ae]/2,P+G*(ae+1))}else{ag=Z.createLinearGradient(Q+G*ae,P-T[ae]/2,Q+G*(ae+1),P-T[ae]/2)}var ab=d.rgbToHex(d.map(d.hexToRgb(I[ae%E].slice(1)),function(ai){return(ai*0.5)>>0}));ag.addColorStop(0,ab);ag.addColorStop(0.5,I[ae%E]);ag.addColorStop(1,ab);Z.fillStyle=ag}if(D){Z.fillRect(Q,P+G*ae,T[ae],G)}else{Z.fillRect(Q+G*ae,P-T[ae],G,T[ae])}if(aa&&aa.name==af[ae]){B.acum=G*ae;B.dimValue=T[ae]}ac+=(T[ae]||0);L+=(J[ae]||0)}if(aa){Z.save();Z.lineWidth=2;Z.strokeStyle=aa.color;if(D){Z.strokeRect(Q+1,P+B.acum+1,B.dimValue-2,G-2)}else{Z.strokeRect(Q+B.acum+1,P-B.dimValue+1,G-2,B.dimValue-2)}Z.restore()}if(O.type=="Native"){Z.save();Z.fillStyle=Z.strokeStyle=O.color;Z.font=O.style+" "+O.size+"px "+O.family;Z.textBaseline="middle";var N=H(X.name,L,X);if(N!==false){N=N!==true?N:L;if(D){Z.textAlign="right";Z.fillText(N,Q+Math.max.apply(null,T)-ah.labelOffset,P+U/2)}else{Z.textAlign="center";Z.fillText(N,Q+W/2,P-Math.max.apply(null,T)-O.size/2-ah.labelOffset)}}var S=V(X.name,L,X);if(S!==false){S=S!==true?S:X.name;if(D){Z.textAlign="center";Z.translate(Q-ah.labelOffset-O.size/2,P+U/2);Z.rotate(Math.PI/2);Z.fillText(S,0,0)}else{Z.textAlign="center";Z.fillText(S,Q+W/2,P+O.size/2+ah.labelOffset)}}Z.restore()}}},contains:function(N,I){var E=N.pos.getc(true),M=N.getData("width"),L=N.getData("height"),H=this.getAlignedPos(E,M,L),G=H.x,F=H.y,J=N.getData("dimArray"),Q=J.length,T=N.getData("config"),D=I.x-G,B=T.orientation=="horizontal",C=(B?L:M)/Q;if(B){if(I.x<G||I.x>G+M||I.y>F+L||I.y<F){return false}}else{if(I.x<G||I.x>G+M||I.y>F||I.y<F-L){return false}}for(var P=0,O=J.length;P<O;P++){var S=J[P];if(B){var R=F+C*P;if(I.x<=G+S&&I.y>=R&&I.y<=R+C){return{name:N.getData("stringArray")[P],color:N.getData("colorArray")[P],value:N.getData("valueArray")[P],label:N.name}}}else{var R=G+C*P;if(I.x>=R&&I.x<=R+C&&I.y>=F-S){return{name:N.getData("stringArray")[P],color:N.getData("colorArray")[P],value:N.getData("valueArray")[P],label:N.name}}}}return false}}});$jit.BarChart=new t({st:null,colors:["#416D9C","#70A35E","#EBB056","#C74243","#83548B","#909291","#557EAA"],selected:{},busy:false,initialize:function(D){this.controller=this.config=d.merge(p("Canvas","Margin","Label","BarChart"),{Label:{type:"Native"}},D);var E=this.config.showLabels,C=d.type(E),F=this.config.showAggregates,B=d.type(F);this.config.showLabels=C=="function"?E:d.lambda(E);this.config.showAggregates=B=="function"?F:d.lambda(F);this.initializeViz()},initializeViz:function(){var C=this.config,G=this;var B=C.type.split(":")[0],I=C.orientation=="horizontal",F={};var E=new $jit.ST({injectInto:C.injectInto,width:C.width,height:C.height,orientation:I?"left":"bottom",levelDistance:0,siblingOffset:C.barsOffset,subtreeOffset:0,withLabels:C.Label.type!="Native",useCanvas:C.useCanvas,Label:{type:C.Label.type},Node:{overridable:true,type:"barchart-"+B,align:"left",width:1,height:1},Edge:{type:"none"},Tips:{enable:C.Tips.enable,type:"Native",force:true,onShow:function(N,M,J){var L=J;C.Tips.onShow(N,L,M)}},Events:{enable:true,type:"Native",onClick:function(M,N,J){if(!C.Events.enable){return}var L=N.getContains();C.Events.onClick(L,N,J)},onMouseMove:function(M,N,J){if(!C.hoveredColor){return}if(M){var L=N.getContains();G.select(M.id,L.name,L.index)}else{G.select(false,false,false)}}},onCreateLabel:function(P,N){var V=C.Label,T=N.getData("valueArray"),S=d.reduce(T,function(W,X){return W+X},0);var R={wrapper:document.createElement("div"),aggregate:document.createElement("div"),label:document.createElement("div")};var J=R.wrapper,U=R.label,L=R.aggregate,M=J.style,Q=U.style,O=L.style;F[N.id]=R;J.appendChild(U);J.appendChild(L);if(!C.showLabels(N.name,S,N)){Q.display="none"}if(!C.showAggregates(N.name,S,N)){O.display="none"}M.position="relative";M.overflow="visible";M.fontSize=V.size+"px";M.fontFamily=V.family;M.color=V.color;M.textAlign="center";O.position=Q.position="absolute";P.style.width=N.getData("width")+"px";P.style.height=N.getData("height")+"px";O.left=Q.left="0px";U.innerHTML=N.name;P.appendChild(J)},onPlaceLabel:function(aa,V){if(!F[V.id]){return}var Z=F[V.id],M=Z.wrapper.style,J=Z.label.style,U=Z.aggregate.style,ab=C.type.split(":")[0]=="grouped",L=C.orientation=="horizontal",Q=V.getData("dimArray"),O=V.getData("valueArray"),S=(ab&&L)?Math.max.apply(null,Q):V.getData("width"),R=(ab&&!L)?Math.max.apply(null,Q):V.getData("height"),P=parseInt(M.fontSize,10),T=aa.style;if(Q&&O){M.width=U.width=J.width=aa.style.width=S+"px";for(var Y=0,W=O.length,X=0;Y<W;Y++){if(Q[Y]>0){X+=O[Y]}}if(C.showLabels(V.name,X,V)){J.display=""}else{J.display="none"}var N=C.showAggregates(V.name,X,V);if(N!==false){U.display=""}else{U.display="none"}if(C.orientation=="horizontal"){U.textAlign="right";J.textAlign="left";J.textIndex=U.textIndent=C.labelOffset+"px";U.top=J.top=(R-P)/2+"px";aa.style.height=M.height=R+"px"}else{U.top=(-P-C.labelOffset)+"px";J.top=(C.labelOffset+R)+"px";aa.style.top=parseInt(aa.style.top,10)-R+"px";aa.style.height=M.height=R+"px"}Z.aggregate.innerHTML=N!==true?N:X}}});var D=E.canvas.getSize(),H=C.Margin;if(I){E.config.offsetX=D.width/2-H.left-(C.showLabels&&(C.labelOffset+C.Label.size));E.config.offsetY=(H.bottom-H.top)/2}else{E.config.offsetY=-D.height/2+H.bottom+(C.showLabels&&(C.labelOffset+C.Label.size));E.config.offsetX=(H.right-H.left)/2}this.delegate=E;this.canvas=this.delegate.canvas},loadJSON:function(Q){if(this.busy){return}this.busy=true;var N=d.time(),H=[],P=this.delegate,T=d.splat(Q.label),M=d.splat(Q.color||this.colors),R=this.config,B=!!R.type.split(":")[1],E=R.animate,D=R.orientation=="horizontal",F=this;for(var O=0,C=Q.values,J=C.length;O<J;O++){var S=C[O];var G=d.splat(C[O].values);var L=0;if(typeof S.id=="undefined"){S.id=S.label}H.push({id:N+S.id,name:S.label,data:{value:G,"$valueArray":G,"$colorArray":M,"$stringArray":T,"$gradient":B,"$config":R},children:[]})}var I={id:N+"$root",name:"",data:{"$type":"none","$width":1,"$height":1},children:H};P.loadJSON(I);this.normalizeDims();P.compute();P.select(P.root);if(E){if(D){P.fx.animate({modes:["node-property:width:dimArray"],duration:1500,onComplete:function(){F.busy=false}})}else{P.fx.animate({modes:["node-property:height:dimArray"],duration:1500,onComplete:function(){F.busy=false}})}}else{this.busy=false}},updateJSON:function(D,H){if(this.busy){return}this.busy=true;this.select(false,false,false);var E=this.delegate;var G=E.graph;var C=D.values;var B=this.config.animate;var F=this;var I=this.config.orientation=="horizontal";d.each(C,function(J){var L=G.getByName(J.label);if(L){L.setData("valueArray",d.splat(J.values));if(D.label){L.setData("stringArray",d.splat(D.label))}}});this.normalizeDims();E.compute();E.select(E.root);if(B){if(I){E.fx.animate({modes:["node-property:width:dimArray"],duration:1500,onComplete:function(){F.busy=false;H&&H.onComplete()}})}else{E.fx.animate({modes:["node-property:height:dimArray"],duration:1500,onComplete:function(){F.busy=false;H&&H.onComplete()}})}}},select:function(D,B){if(!this.config.hoveredColor){return}var C=this.selected;if(C.id!=D||C.name!=B){C.id=D;C.name=B;C.color=this.config.hoveredColor;this.delegate.graph.eachNode(function(E){if(D==E.id){E.setData("border",C)}else{E.setData("border",false)}});this.delegate.plot()}},getLegend:function(){var D={};var E;this.delegate.graph.getNode(this.delegate.root).eachAdjacency(function(F){E=F.nodeTo});var C=E.getData("colorArray"),B=C.length;d.each(E.getData("stringArray"),function(G,F){D[G]=C[F%B]});return D},getMaxValue:function(){var C=0,B=this.config.type.split(":")[0]=="stacked";this.delegate.graph.eachNode(function(F){var D=F.getData("valueArray"),E=0;if(!D){return}if(B){d.each(D,function(G){E+=+G})}else{E=Math.max.apply(null,D)}C=C>E?C:E});return C},setBarType:function(B){this.config.type=B;this.delegate.config.Node.type="barchart-"+B.split(":")[0]},normalizeDims:function(){var M=this.delegate.graph.getNode(this.delegate.root),G=0;M.eachAdjacency(function(){G++});var I=this.getMaxValue()||1,P=this.delegate.canvas.getSize(),E=this.config,H=E.Margin,N=H.left+H.right,F=H.top+H.bottom,C=E.orientation=="horizontal",B=(P[C?"height":"width"]-(C?F:N)-(G-1)*E.barsOffset)/G,D=E.animate,O=P[C?"width":"height"]-(C?N:F)-(!C&&E.showAggregates&&(E.Label.size+E.labelOffset))-(E.showLabels&&(E.Label.size+E.labelOffset)),L=C?"height":"width",J=C?"width":"height";this.delegate.graph.eachNode(function(T){var S=0,Q=[];d.each(T.getData("valueArray"),function(U){S+=+U;Q.push(0)});T.setData(L,B);if(D){T.setData(J,S*O/I,"end");T.setData("dimArray",d.map(T.getData("valueArray"),function(U){return U*O/I}),"end");var R=T.getData("dimArray");if(!R){T.setData("dimArray",Q)}}else{T.setData(J,S*O/I);T.setData("dimArray",d.map(T.getData("valueArray"),function(U){return U*O/I}))}})}});p.PieChart={$extend:true,animate:true,offset:25,sliceOffset:0,labelOffset:3,type:"stacked",hoveredColor:"#9fd4ff",Events:{enable:false,onClick:d.empty},Tips:{enable:false,onShow:d.empty,onHide:d.empty},showLabels:true,resizeLabels:false,updateHeights:false};h.Radial=new t({compute:function(C){var D=d.splat(C||["current","start","end"]);g.compute(this.graph,D,this.config);this.graph.computeLevels(this.root,0,"ignore");var B=this.createLevelDistanceFunc();this.computeAngularWidths(D);this.computePositions(D,B)},computePositions:function(I,F){var L=I;var J=this.graph;var G=J.getNode(this.root);var H=this.parent;var B=this.config;for(var D=0,C=L.length;D<C;D++){var E=L[D];G.setPos(l(0,0),E);G.setData("span",Math.PI*2,E)}G.angleSpan={begin:0,end:2*Math.PI};J.eachBFS(this.root,function(Q){var W=Q.angleSpan.end-Q.angleSpan.begin;var Y=Q.angleSpan.begin;var X=F(Q);var Z=0,M=[],P={};Q.eachSubnode(function(ac){Z+=ac._treeAngularWidth;for(var ad=0,ab=L.length;ad<ab;ad++){var af=L[ad],ae=ac.getData("dim",af);P[af]=(af in P)?(ae>P[af]?ae:P[af]):ae}M.push(ac)},"ignore");if(H&&H.id==Q.id&&M.length>0&&M[0].dist){M.sort(function(ac,ab){return(ac.dist>=ab.dist)-(ac.dist<=ab.dist)})}for(var S=0,U=M.length;S<U;S++){var O=M[S];if(!O._flag){var aa=O._treeAngularWidth/Z*W;var N=Y+aa/2;for(var T=0,R=L.length;T<R;T++){var V=L[T];O.setPos(l(N,X),V);O.setData("span",aa,V);O.setData("dim-quotient",O.getData("dim",V)/P[V],V)}O.angleSpan={begin:Y,end:Y+aa};Y+=aa}}},"ignore")},setAngularWidthForNodes:function(B){this.graph.eachBFS(this.root,function(E,C){var D=E.getData("angularWidth",B[0])||5;E._angularWidth=D/C},"ignore")},setSubtreesAngularWidth:function(){var B=this;this.graph.eachNode(function(C){B.setSubtreeAngularWidth(C)},"ignore")},setSubtreeAngularWidth:function(E){var D=this,C=E._angularWidth,B=0;E.eachSubnode(function(F){D.setSubtreeAngularWidth(F);B+=F._treeAngularWidth},"ignore");E._treeAngularWidth=Math.max(C,B)},computeAngularWidths:function(B){this.setAngularWidthForNodes(B);this.setSubtreesAngularWidth()}});$jit.Sunburst=new t({Implements:[e,q,h.Radial],initialize:function(B){var D=$jit.Sunburst;var C={interpolation:"linear",levelDistance:100,Node:{type:"multipie",height:0},Edge:{type:"none"},Label:{textAlign:"start",textBaseline:"middle"}};this.controller=this.config=d.merge(p("Canvas","Node","Edge","Fx","Tips","NodeStyles","Events","Navigation","Controller","Label"),C,B);var E=this.config;if(E.useCanvas){this.canvas=E.useCanvas;this.config.labelContainer=this.canvas.id+"-label"}else{if(E.background){E.background=d.merge({type:"Circles"},E.background)}this.canvas=new n(this,E);this.config.labelContainer=(typeof E.injectInto=="string"?E.injectInto:E.injectInto.id)+"-label"}this.graphOptions={klass:b,Node:{selected:false,exist:true,drawn:true}};this.graph=new f(this.graphOptions,this.config.Node,this.config.Edge);this.labels=new D.Label[E.Label.type](this);this.fx=new D.Plot(this,D);this.op=new D.Op(this);this.json=null;this.root=null;this.rotated=null;this.busy=false;this.initializeExtras()},createLevelDistanceFunc:function(){var B=this.config.levelDistance;return function(C){return(C._depth+1)*B}},refresh:function(){this.compute();this.plot()},reposition:function(){this.compute("end")},rotate:function(D,E,C){var B=D.getPos(C.property||"current").getp(true).theta;this.rotated=D;this.rotateAngle(-B,E,C)},rotateAngle:function(D,G,C){var E=this;var B=d.merge(this.config,C||{},{modes:["polar"]});var F=C.property||(G==="animate"?"end":"current");if(G==="animate"){this.fx.animation.pause()}this.graph.eachNode(function(I){var H=I.getPos(F);H.theta+=D;if(H.theta<0){H.theta+=Math.PI*2}});if(G=="animate"){this.fx.animate(B)}else{if(G=="replot"){this.fx.plot();this.busy=false}}},plot:function(){this.fx.plot()}});$jit.Sunburst.$extend=true;(function(B){B.Op=new t({Implements:f.Op});B.Plot=new t({Implements:f.Plot});B.Label={};B.Label.Native=new t({Implements:f.Label.Native,initialize:function(C){this.viz=C;this.label=C.config.Label;this.config=C.config},renderLabel:function(F,H,J){var R=H.getData("span");if(R<Math.PI/2&&Math.tan(R)*this.config.levelDistance*H._depth<10){return}var S=F.getCtx();var D=S.measureText(H.name);if(H.id==this.viz.root){var Q=-D.width/2,O=0,P=0;var C=0}else{var G=5;var C=J.levelDistance-G;var N=H.pos.clone();N.rho+=G;var E=N.getp(true);var L=N.getc(true);var Q=L.x,O=L.y;var I=Math.PI;var M=(E.theta>I/2&&E.theta<3*I/2);var P=M?E.theta+I:E.theta;if(M){Q-=Math.abs(Math.cos(E.theta)*D.width);O+=Math.sin(E.theta)*D.width}else{if(H.id==this.viz.root){Q-=D.width/2}}}S.save();S.translate(Q,O);S.rotate(P);S.fillText(H.name,0,0);S.restore()}});B.Label.SVG=new t({Implements:f.Label.SVG,initialize:function(C){this.viz=C},placeLabel:function(R,F,H){var N=F.pos.getc(true),Q=this.viz,D=this.viz.canvas;var I=D.getSize();var E={x:Math.round(N.x+I.width/2),y:Math.round(N.y+I.height/2)};R.setAttribute("x",E.x);R.setAttribute("y",E.y);var J=R.getBBox();if(J){var P=R.getAttribute("x");var M=R.getAttribute("y");var C=F.pos.getp(true);var G=Math.PI;var L=(C.theta>G/2&&C.theta<3*G/2);if(L){R.setAttribute("x",P-J.width);R.setAttribute("y",M-J.height)}else{if(F.id==Q.root){R.setAttribute("x",P-J.width/2)}}var O=L?C.theta+G:C.theta;if(F._depth){R.setAttribute("transform","rotate("+O*360/(2*G)+" "+P+" "+M+")")}}H.onPlaceLabel(R,F)}});B.Label.HTML=new t({Implements:f.Label.HTML,initialize:function(C){this.viz=C},placeLabel:function(M,F,H){var J=F.pos.clone(),D=this.viz.canvas,L=F.getData("height"),G=((L||F._depth==0)?L:this.viz.config.levelDistance)/2,I=D.getSize();J.rho+=G;J=J.getc(true);var E={x:Math.round(J.x+I.width/2),y:Math.round(J.y+I.height/2)};var C=M.style;C.left=E.x+"px";C.top=E.y+"px";C.display=this.fitsInCanvas(E,D)?"":"none";H.onPlaceLabel(M,F)}});B.Plot.NodeTypes=new t({none:{render:d.empty,contains:d.lambda(false),anglecontains:function(G,I){var F=G.getData("span")/2,D=G.pos.theta;var E=D-F,C=D+F;if(E<0){E+=Math.PI*2}var H=Math.atan2(I.y,I.x);if(H<0){H+=Math.PI*2}if(E>C){return(H>E&&H<=Math.PI*2)||H<C}else{return H>E&&H<C}}},pie:{render:function(H,F){var M=H.getData("span")/2,E=H.pos.theta;var G=E-M,I=E+M;var L=H.pos.getp(true);var C=new b(L.rho,G);var D=C.getc(true);C.theta=I;var J=C.getc(true);var N=F.getCtx();N.beginPath();N.moveTo(0,0);N.lineTo(D.x,D.y);N.moveTo(0,0);N.lineTo(J.x,J.y);N.moveTo(0,0);N.arc(0,0,L.rho*H.getData("dim-quotient"),G,I,false);N.fill()},contains:function(E,G){if(this.nodeTypes.none.anglecontains.call(this,E,G)){var C=Math.sqrt(G.x*G.x+G.y*G.y);var D=this.config.levelDistance,F=E._depth;return(C<=D*F)}return false}},multipie:{render:function(I,G){var Q=I.getData("height");var J=Q?Q:this.config.levelDistance;var P=I.getData("span")/2,F=I.pos.theta;var H=F-P,M=F+P;var O=I.pos.getp(true);var D=new b(O.rho,H);var E=D.getc(true);D.theta=M;var N=D.getc(true);D.rho+=J;var C=D.getc(true);D.theta=H;var L=D.getc(true);var R=G.getCtx();R.moveTo(0,0);R.beginPath();R.arc(0,0,O.rho,H,M,false);R.arc(0,0,O.rho+J,M,H,true);R.moveTo(E.x,E.y);R.lineTo(L.x,L.y);R.moveTo(N.x,N.y);R.lineTo(C.x,C.y);R.fill();if(I.collapsed){R.save();R.lineWidth=2;R.moveTo(0,0);R.beginPath();R.arc(0,0,O.rho+J+5,M-0.01,H+0.01,true);R.stroke();R.restore()}},contains:function(F,I){if(this.nodeTypes.none.anglecontains.call(this,F,I)){var D=Math.sqrt(I.x*I.x+I.y*I.y);var C=F.getData("height");var G=C?C:this.config.levelDistance;var E=this.config.levelDistance,H=F._depth;return(D>=E*H)&&(D<=(E*H+G))}return false}},"gradient-multipie":{render:function(F,C){var L=C.getCtx();var J=F.getData("height");var G=J?J:this.config.levelDistance;var D=L.createRadialGradient(0,0,F.getPos().rho,0,0,F.getPos().rho+G);var I=d.hexToRgb(F.getData("color")),H=[];d.each(I,function(M){H.push(parseInt(M*0.5,10))});var E=d.rgbToHex(H);D.addColorStop(0,E);D.addColorStop(1,F.getData("color"));L.fillStyle=D;this.nodeTypes.multipie.render.call(this,F,C)},contains:function(C,D){return this.nodeTypes.multipie.contains.call(this,C,D)}},"gradient-pie":{render:function(H,E){var C=E.getCtx();var I=C.createRadialGradient(0,0,0,0,0,H.getPos().rho);var G=d.hexToRgb(H.getData("color")),D=[];d.each(G,function(J){D.push(parseInt(J*0.5,10))});var F=d.rgbToHex(D);I.addColorStop(1,F);I.addColorStop(0,H.getData("color"));C.fillStyle=I;this.nodeTypes.pie.render.call(this,H,E)},contains:function(C,D){return this.nodeTypes.pie.contains.call(this,C,D)}}});B.Plot.EdgeTypes=new t({none:d.empty,line:{render:function(C,D){var F=C.nodeFrom.pos.getc(true),E=C.nodeTo.pos.getc(true);this.edgeHelper.line.render(F,E,D)},contains:function(C,F){var E=C.nodeFrom.pos.getc(true),D=C.nodeTo.pos.getc(true);return this.edgeHelper.line.contains(E,D,F,this.edge.epsilon)}},arrow:{render:function(D,E){var I=D.nodeFrom.pos.getc(true),H=D.nodeTo.pos.getc(true),G=D.getData("dim"),F=D.data.$direction,C=(F&&F.length>1&&F[0]!=D.nodeFrom.id);this.edgeHelper.arrow.render(I,H,G,C,E)},contains:function(C,F){var E=C.nodeFrom.pos.getc(true),D=C.nodeTo.pos.getc(true);return this.edgeHelper.arrow.contains(E,D,F,this.edge.epsilon)}},hyperline:{render:function(C,D){var G=C.nodeFrom.pos.getc(),F=C.nodeTo.pos.getc(),E=Math.max(G.norm(),F.norm());this.edgeHelper.hyperline.render(G.$scale(1/E),F.$scale(1/E),E,D)},contains:d.lambda(false)}})})($jit.Sunburst);$jit.Sunburst.Plot.NodeTypes.implement({"piechart-stacked":{render:function(aa,F){var Z=aa.pos.getp(true),H=aa.getData("dimArray"),Y=aa.getData("valueArray"),M=aa.getData("colorArray"),E=M.length,S=aa.getData("stringArray"),V=aa.getData("span")/2,Q=aa.pos.theta,L=Q-V,P=Q+V,X=new b;var T=F.getCtx(),R={},O=aa.getData("gradient"),I=aa.getData("border"),af=aa.getData("config"),ao=af.showLabels,ae=af.resizeLabels,ah=af.Label;var ak=af.sliceOffset*Math.cos((L+P)/2);var J=af.sliceOffset*Math.sin((L+P)/2);if(M&&H&&S){for(var al=0,ai=H.length,B=0,ad=0;al<ai;al++){var G=H[al],am=M[al%E];if(G<=0){continue}T.fillStyle=T.strokeStyle=am;if(O&&G){var aj=T.createRadialGradient(ak,J,B+af.sliceOffset,ak,J,B+G+af.sliceOffset);var C=d.hexToRgb(am),ac=d.map(C,function(ar){return(ar*0.8)>>0}),D=d.rgbToHex(ac);aj.addColorStop(0,am);aj.addColorStop(0.5,am);aj.addColorStop(1,D);T.fillStyle=aj}X.rho=B+af.sliceOffset;X.theta=L;var an=X.getc(true);X.theta=P;var U=X.getc(true);X.rho+=G;var ap=X.getc(true);X.theta=L;var W=X.getc(true);T.beginPath();T.arc(ak,J,B+0.01,L,P,false);T.arc(ak,J,B+G+0.01,P,L,true);T.fill();if(I&&I.name==S[al]){R.acum=B;R.dimValue=H[al];R.begin=L;R.end=P}B+=(G||0);ad+=(Y[al]||0)}if(I){T.save();T.globalCompositeOperation="source-over";T.lineWidth=2;T.strokeStyle=I.color;var ag=L<P?1:-1;T.beginPath();T.arc(ak,J,R.acum+0.01+1,R.begin,R.end,false);T.arc(ak,J,R.acum+R.dimValue+0.01-1,R.end,R.begin,true);T.closePath();T.stroke();T.restore()}if(ao&&ah.type=="Native"){T.save();T.fillStyle=T.strokeStyle=ah.color;var ab=ae?aa.getData("normalizedDim"):1,N=(ah.size*ab)>>0;N=N<+ae?+ae:N;T.font=ah.style+" "+N+"px "+ah.family;T.textBaseline="middle";T.textAlign="center";X.rho=B+af.labelOffset+af.sliceOffset;X.theta=aa.pos.theta;var aq=X.getc(true);T.fillText(aa.name,aq.x,aq.y);T.restore()}}},contains:function(E,I){if(this.nodeTypes.none.anglecontains.call(this,E,I)){var L=Math.sqrt(I.x*I.x+I.y*I.y);var B=this.config.levelDistance,H=E._depth;var C=E.getData("config");if(L<=B*H+C.sliceOffset){var M=E.getData("dimArray");for(var G=0,F=M.length,J=C.sliceOffset;G<F;G++){var D=M[G];if(L>=J&&L<=J+D){return{name:E.getData("stringArray")[G],color:E.getData("colorArray")[G],value:E.getData("valueArray")[G],label:E.name}}J+=D}}return false}return false}}});$jit.PieChart=new t({sb:null,colors:["#416D9C","#70A35E","#EBB056","#C74243","#83548B","#909291","#557EAA"],selected:{},busy:false,initialize:function(B){this.controller=this.config=d.merge(p("Canvas","PieChart","Label"),{Label:{type:"Native"}},B);this.initializeViz()},initializeViz:function(){var C=this.config,G=this;var B=C.type.split(":")[0];var F=new $jit.Sunburst({injectInto:C.injectInto,width:C.width,height:C.height,useCanvas:C.useCanvas,withLabels:C.Label.type!="Native",Label:{type:C.Label.type},Node:{overridable:true,type:"piechart-"+B,width:1,height:1},Edge:{type:"none"},Tips:{enable:C.Tips.enable,type:"Native",force:true,onShow:function(L,J,H){var I=H;C.Tips.onShow(L,I,J)}},Events:{enable:true,type:"Native",onClick:function(J,L,H){if(!C.Events.enable){return}var I=L.getContains();C.Events.onClick(I,L,H)},onMouseMove:function(J,L,H){if(!C.hoveredColor){return}if(J){var I=L.getContains();G.select(J.id,I.name,I.index)}else{G.select(false,false,false)}}},onCreateLabel:function(L,J){var H=C.Label;if(C.showLabels){var I=L.style;I.fontSize=H.size+"px";I.fontFamily=H.family;I.color=H.color;I.textAlign="center";L.innerHTML=J.name}},onPlaceLabel:function(Y,S){if(!C.showLabels){return}var M=S.pos.getp(true),P=S.getData("dimArray"),V=S.getData("span")/2,N=S.pos.theta,X=N-V,I=N+V,aa=new b;var R=C.showLabels,L=C.resizeLabels,O=C.Label;if(P){for(var W=0,T=P.length,U=0;W<T;W++){U+=P[W]}var Z=L?S.getData("normalizedDim"):1,H=(O.size*Z)>>0;H=H<+L?+L:H;Y.style.fontSize=H+"px";aa.rho=U+C.labelOffset+C.sliceOffset;aa.theta=(X+I)/2;var M=aa.getc(true);var J=G.canvas.getSize();var Q={x:Math.round(M.x+J.width/2),y:Math.round(M.y+J.height/2)};Y.style.left=Q.x+"px";Y.style.top=Q.y+"px"}}});var E=F.canvas.getSize(),D=Math.min;F.config.levelDistance=D(E.width,E.height)/2-C.offset-C.sliceOffset;this.delegate=F;this.canvas=this.delegate.canvas;this.canvas.getCtx().globalCompositeOperation="lighter"},loadJSON:function(Q){var N=d.time(),G=[],P=this.delegate,T=d.splat(Q.label),I=T.length,M=d.splat(Q.color||this.colors),D=M.length,R=this.config,B=!!R.type.split(":")[1],E=R.animate,L=I==1;for(var O=0,C=Q.values,J=C.length;O<J;O++){var S=C[O];var F=d.splat(S.values);G.push({id:N+S.label,name:S.label,data:{value:F,"$valueArray":F,"$colorArray":L?d.splat(M[O%D]):M,"$stringArray":T,"$gradient":B,"$config":R,"$angularWidth":d.reduce(F,function(U,V){return U+V})},children:[]})}var H={id:N+"$root",name:"",data:{"$type":"none","$width":1,"$height":1},children:G};P.loadJSON(H);this.normalizeDims();P.refresh();if(E){P.fx.animate({modes:["node-property:dimArray"],duration:1500})}},updateJSON:function(D,H){if(this.busy){return}this.busy=true;var E=this.delegate;var G=E.graph;var C=D.values;var B=this.config.animate;var F=this;d.each(C,function(I){var L=G.getByName(I.label),J=d.splat(I.values);if(L){L.setData("valueArray",J);L.setData("angularWidth",d.reduce(J,function(M,N){return M+N}));if(D.label){L.setData("stringArray",d.splat(D.label))}}});this.normalizeDims();if(B){E.compute("end");E.fx.animate({modes:["node-property:dimArray:span","linear"],duration:1500,onComplete:function(){F.busy=false;H&&H.onComplete()}})}else{E.refresh()}},select:function(D,B){if(!this.config.hoveredColor){return}var C=this.selected;if(C.id!=D||C.name!=B){C.id=D;C.name=B;C.color=this.config.hoveredColor;this.delegate.graph.eachNode(function(E){if(D==E.id){E.setData("border",C)}else{E.setData("border",false)}});this.delegate.plot()}},getLegend:function(){var D={};var E;this.delegate.graph.getNode(this.delegate.root).eachAdjacency(function(F){E=F.nodeTo});var C=E.getData("colorArray"),B=C.length;d.each(E.getData("stringArray"),function(G,F){D[G]=C[F%B]});return D},getMaxValue:function(){var B=0;this.delegate.graph.eachNode(function(E){var C=E.getData("valueArray"),D=0;d.each(C,function(F){D+=+F});B=B>D?B:D});return B},normalizeDims:function(){var C=this.delegate.graph.getNode(this.delegate.root),B=0;C.eachAdjacency(function(){B++});var G=this.getMaxValue()||1,F=this.config,D=F.animate,E=this.delegate.config.levelDistance;this.delegate.graph.eachNode(function(M){var L=0,H=[];d.each(M.getData("valueArray"),function(N){L+=+N;H.push(1)});var J=(H.length==1)&&!F.updateHeights;if(D){M.setData("dimArray",d.map(M.getData("valueArray"),function(N){return J?E:(N*E/G)}),"end");var I=M.getData("dimArray");if(!I){M.setData("dimArray",H)}}else{M.setData("dimArray",d.map(M.getData("valueArray"),function(N){return J?E:(N*E/G)}))}M.setData("normalizedDim",L/G)})}});h.TM={};h.TM.SliceAndDice=new t({compute:function(G){var C=this.graph.getNode(this.clickedNode&&this.clickedNode.id||this.root);this.controller.onBeforeCompute(C);var E=this.canvas.getSize(),D=this.config,F=E.width,B=E.height;this.graph.computeLevels(this.root,0,"ignore");C.getPos(G).setc(-F/2,-B/2);C.setData("width",F,G);C.setData("height",B+D.titleHeight,G);this.computePositions(C,C,this.layout.orientation,G);this.controller.onAfterCompute(C)},computePositions:function(M,J,V,D){var T=0;M.eachSubnode(function(X){T+=X.getData("area",D)});var W=this.config,G=W.offset,Q=M.getData("width",D),O=Math.max(M.getData("height",D)-W.titleHeight,0),C=M==J?1:(J.getData("area",D)/T);var P,N,S,H,F,L,I;var U=(V=="h");if(U){V="v";P=O;N=Q*C;S="height";H="y";F="x";L=W.titleHeight;I=0}else{V="h";P=O*C;N=Q;S="width";H="x";F="y";L=0;I=W.titleHeight}var B=J.getPos(D);J.setData("width",N,D);J.setData("height",P,D);var R=0,E=this;J.eachSubnode(function(Y){var X=Y.getPos(D);X[H]=R+B[H]+L;X[F]=B[F]+I;E.computePositions(J,Y,V,D);R+=Y.getData(S,D)})}});h.TM.Area={compute:function(B){B=B||"current";var H=this.graph.getNode(this.clickedNode&&this.clickedNode.id||this.root);this.controller.onBeforeCompute(H);var D=this.config,L=this.canvas.getSize(),C=L.width,J=L.height,I=D.offset,E=C-I,G=J-I;this.graph.computeLevels(this.root,0,"ignore");H.getPos(B).setc(-C/2,-J/2);H.setData("width",C,B);H.setData("height",J,B);var F={top:-J/2+D.titleHeight+I/2,left:-C/2+I/2,width:E,height:G-D.titleHeight};this.computePositions(H,F,B);this.controller.onAfterCompute(H)},computeDim:function(F,G,I,E,D,B){if(F.length+G.length==1){var C=(F.length==1)?F:G;this.layoutLast(C,I,E,B);return}if(F.length>=2&&G.length==0){G=[F.shift()]}if(F.length==0){if(G.length>0){this.layoutRow(G,I,E,B)}return}var H=F[0];if(D(G,I)>=D([H].concat(G),I)){this.computeDim(F.slice(1),G.concat([H]),I,E,D,B)}else{var J=this.layoutRow(G,I,E,B);this.computeDim(F,[],J.dim,J,D,B)}},worstAspectRatio:function(B,J){if(!B||B.length==0){return Number.MAX_VALUE}var C=0,L=0,F=Number.MAX_VALUE;for(var H=0,G=B.length;H<G;H++){var D=B[H]._area;C+=D;F=F<D?F:D;L=L>D?L:D}var I=J*J,E=C*C;return Math.max(I*L/E,E/(I*F))},avgAspectRatio:function(F,C){if(!F||F.length==0){return Number.MAX_VALUE}var H=0;for(var D=0,B=F.length;D<B;D++){var G=F[D]._area;var E=G/C;H+=C>E?C/E:E/C}return H/B},layoutLast:function(C,B,F,E){var D=C[0];D.getPos(E).setc(F.left,F.top);D.setData("width",F.width,E);D.setData("height",F.height,E)}};h.TM.Squarified=new t({Implements:h.TM.Area,computePositions:function(F,I,C){var E=this.config,L=Math.max;if(I.width>=I.height){this.layout.orientation="h"}else{this.layout.orientation="v"}var B=F.getSubnodes([1,1],"ignore");if(B.length>0){this.processChildrenLayout(F,B,I,C);for(var H=0,G=B.length;H<G;H++){var M=B[H],N=E.offset,O=L(M.getData("height",C)-N-E.titleHeight,0),D=L(M.getData("width",C)-N,0),J=M.getPos(C);I={width:D,height:O,top:J.y+E.titleHeight+N/2,left:J.x+N/2};this.computePositions(M,I,C)}}},processChildrenLayout:function(M,B,H,C){var F=H.width*H.height;var G,D=B.length,I=0,N=[];for(G=0;G<D;G++){N[G]=parseFloat(B[G].getData("area",C));I+=N[G]}for(G=0;G<D;G++){B[G]._area=F*N[G]/I}var E=this.layout.horizontal()?H.height:H.width;B.sort(function(P,O){var Q=O._area-P._area;return Q?Q:(O.id==P.id?0:(O.id<P.id?1:-1))});var L=[B[0]];var J=B.slice(1);this.squarify(J,L,E,H,C)},squarify:function(C,F,B,E,D){this.computeDim(C,F,B,E,this.worstAspectRatio,D)},layoutRow:function(C,B,E,D){if(this.layout.horizontal()){return this.layoutV(C,B,E,D)}else{return this.layoutH(C,B,E,D)}},layoutV:function(B,O,I,C){var P=0,E=function(Q){return Q};d.each(B,function(Q){P+=Q._area});var D=E(P/O)||0,L=0;for(var G=0,F=B.length;G<F;G++){var H=E(B[G]._area/D)||0;var M=B[G];var J=d.getDir()==="rtl"?(-1*I.left)-D:I.left;M.getPos(C).setc(J,I.top+L);M.setData("width",D,C);M.setData("height",H,C);L+=H}var N={height:I.height,width:I.width-D,top:I.top,left:I.left+D};N.dim=Math.min(N.width,N.height);if(N.dim!=N.height){this.layout.change()}return N},layoutH:function(B,M,G,C){var O=0;d.each(B,function(P){O+=P._area});var N=O/M||0,I=G.top,D=0;for(var F=0,E=B.length;F<E;F++){var J=B[F];var M=J._area/N||0;var H=d.getDir()==="rtl"?(-1*(G.left+D))-M:G.left+D;J.getPos(C).setc(H,I);J.setData("width",M,C);J.setData("height",N,C);D+=M}var L={height:G.height-N,width:G.width,top:G.top+N,left:G.left};L.dim=Math.min(L.width,L.height);if(L.dim!=L.width){this.layout.change()}return L},layoutLast:function(D,C,G,F){var E=D[0];var B=d.getDir()==="rtl"?-1*G.left-G.width:G.left;E.getPos(F).setc(B,G.top);E.setData("width",G.width,F);E.setData("height",G.height,F)}});h.TM.Strip=new t({Implements:h.TM.Area,computePositions:function(F,I,C){var B=F.getSubnodes([1,1],"ignore"),E=this.config,L=Math.max;if(B.length>0){this.processChildrenLayout(F,B,I,C);for(var H=0,G=B.length;H<G;H++){var M=B[H];var N=E.offset,O=L(M.getData("height",C)-N-E.titleHeight,0),D=L(M.getData("width",C)-N,0);var J=M.getPos(C);I={width:D,height:O,top:J.y+E.titleHeight+N/2,left:J.x+N/2};this.computePositions(M,I,C)}}},processChildrenLayout:function(M,B,G,C){var E=G.width*G.height;var F,D=B.length,H=0,N=[];for(F=0;F<D;F++){N[F]=+B[F].getData("area",C);H+=N[F]}for(F=0;F<D;F++){B[F]._area=E*N[F]/H}var L=this.layout.horizontal()?G.width:G.height;var J=[B[0]];var I=B.slice(1);this.stripify(I,J,L,G,C)},stripify:function(C,F,B,E,D){this.computeDim(C,F,B,E,this.avgAspectRatio,D)},layoutRow:function(C,B,E,D){if(this.layout.horizontal()){return this.layoutH(C,B,E,D)}else{return this.layoutV(C,B,E,D)}},layoutV:function(B,L,H,C){var M=0;d.each(B,function(N){M+=N._area});var D=M/L||0,I=0;for(var F=0,E=B.length;F<E;F++){var J=B[F];var G=J._area/D||0;J.getPos(C).setc(H.left,H.top+(L-G-I));J.setData("width",D,C);J.setData("height",G,C);I+=G}return{height:H.height,width:H.width-D,top:H.top,left:H.left+D,dim:L}},layoutH:function(B,J,G,C){var M=0;d.each(B,function(O){M+=O._area});var L=M/J||0,H=G.height-L,D=0;for(var F=0,E=B.length;F<E;F++){var I=B[F];var N=I._area/L||0;I.getPos(C).setc(G.left+D,G.top+H);I.setData("width",N,C);I.setData("height",L,C);D+=N}return{height:G.height-L,width:G.width,top:G.top,left:G.left,dim:J}}});h.TM.Voronoi=new t({Implements:h.TM.Area,compute:function(I){this.controller.onBeforeCompute(C);var C=this.graph.getNode(this.clickedNode&&this.clickedNode.id||this.root),E=this.canvas.getSize(),D=this.config,H=D.offset,G=E.width,B=E.height;this.graph.computeLevels(this.root,0,0);C.getPos(I).setc(-5,-5);if(!C.histoPos){C.histoPos=[]}C.histoPos[0]=u(0,0);var F=[u(-G*0.5,-B*0.5),u(G*0.5,-B*0.5),u(G*0.5,B*0.5),u(-G*0.5,B*0.5)];F=Geometry.offsetConvex(F,-H*0.5);C.setData("vertices",F,I);C.setData("width",0,I);C.setData("height",0,I);F=Geometry.offsetConvex(F,-H*1.5);this.computePositions(C,F,I,0);this.controller.onAfterCompute(C)},computePositions:function(E,F,B,C){var L=this,G=E.getSubnodes([1,1],"ignore"),D=this.config,H=D.offset,J=E.histoPos[C]||c(0,0),I,M;E.setData("width",0,B);E.setData("height",0,B);E.getPos(B).setc(J.x,J.y);if(G.length>0){if(!G[0].histoPos||!G[0].histoPos[C+1]){I=$jit.util.map(G,function(N){var O=Geometry.randPointInPolygon(F);if(N.data&&N.data.$area){O.area=N.data.$area}return O});I=L[L.config.centroidType](I,F);$jit.util.each(I,function(O,N){if(!G[N].histoPos){G[N].histoPos=[]}G[N].histoPos[C+1]=O})}I=$jit.util.map(G,function(N){return N.histoPos[C+1]});M=Geometry.voronoi(I,F);$jit.util.each(G,function(Q,P){var O=M[P];var N=O.slice(0);if(Geometry.area(O)<0){O.reverse()}if(H){N=Geometry.offsetConvex(O,-H*2);O=Geometry.offsetConvex(O,-H*0.5);Q.offset=H}Q.setData("vertices",O,B);L.computePositions(Q,N,B,C+1)})}},centroid:function(E,D){var C=2,B;while(C>0.001){B=Geometry.voronoi(E,D);C=0;E=B.map(function(G,F){var H=Geometry.centroid(G);C+=Geometry.dist2(H,E[F]);return H})}return E},doLayoutPressure:function(){var C=this,B=C.graph.getNode(C.clickedNode&&C.clickedNode.id||C.root);B.eachNode(function(){})},weightedCentroid:function(E,C){var L=[];var D=2,F,I=Geometry.area(C),B=0,H;d.each(E,function(M,N){B+=M.area});H=I/B;F=Geometry.voronoi(E,C);d.each(F,function(N,M){L[M]=E[M].area*H/Geometry.area(N)});var J=0,G=0;d.each(L,function(N,M){J+=N;G+=N*N});console.log("from "+(G-J*J/L.length)/L.length);while(D>0.001){F=Geometry.voronoi(E,C);d.each(F,function(N,M){L[M]=E[M].area*H/Geometry.area(N)});D=0;E=F.map(function(N,M){var P=u(0,0),O=0;d.each(N,function(R,T){var U=[E[M],R,N[T+1]||N[0]],S=(R.attached)?L[R.attached[0]]:1,Q=Geometry.area(U)*Math.exp((L[M]-S)*2);O+=Q;P.$add(R.add(U[2]).scale(0.5*Q))});P.$scale(1/O);P.area=E[M].area;D+=Geometry.dist(P,E[M]);return P})}var J=0,G=0;d.each(L,function(N,M){J+=N;G+=N*N});console.log("to "+(G-J*J/L.length)/L.length);return E},byArea:function(H,F){H=this.centroid(H,F);var D=0,C=0,B,G,B;$jit.util.each(H,function(I){D+=I.area});D=Geometry.area(F)/D;for(;C<100;C++){B=Geometry.voronoi(H,F);for(var E=0;E<H.length;E++){if(B[E].length==0){H=B.map(function(J,I){return Geometry.centroid(J)});break}}G=B.map(function(J,I){return J.area*D/(Geometry.area(J)+1e-10)});B=Geometry.voronoi(H,F);H=B.map(function(M,L){var I=u(H[L].x,H[L].y),N,J;I.area=H[L].area;N=u(0,0);$jit.util.each(M,function(U,R){var S=(U.attached)?U.attached:-1,O=(U.attached)?G[U.attached[0]]:1,Q=U,T=M[R+1]||M[0],P=(G[L]-O),W=T.x-Q.x,V=T.y-Q.y;N.x+=V*P;N.y-=W*P});I.x+=N.x/10;I.y+=N.y/10;I.tp=N;return I})}return H}});h.Icicle=new t({compute:function(J){J=J||"current";var I=this.graph.getNode(this.root),E=this.config,N=this.canvas.getSize(),B=N.width,M=N.height,F=E.offset,H=E.constrained?E.levelsToShow:Number.MAX_VALUE;this.controller.onBeforeCompute(I);f.Util.computeLevels(this.graph,I.id,0,"ignore");var L=0;f.Util.eachLevel(I,0,false,function(P,O){if(O>L){L=O}});var D=this.graph.getNode(this.clickedNode&&this.clickedNode.id||I.id);var C=Math.min(L,H-1);var G=D._depth;if(this.layout.horizontal()){this.computeSubtree(D,-B/2,-M/2,B/(C+1),M,G,C,J)}else{this.computeSubtree(D,-B/2,-M/2,B,M/(C+1),G,C,J)}},computeSubtree:function(J,M,I,B,P,H,D,L){J.getPos(L).setc(M,I);J.setData("width",B,L);J.setData("height",P,L);var F,O=0,N=0;var C=f.Util.getSubnodes(J,[1,1],"ignore");if(!C.length){return}d.each(C,function(Q){N+=Q.getData("dim")});for(var G=0,E=C.length;G<E;G++){if(this.layout.horizontal()){F=P*C[G].getData("dim")/N;this.computeSubtree(C[G],M+B,I,B,F,H,D,L);I+=F}else{F=B*C[G].getData("dim")/N;this.computeSubtree(C[G],M,I+P,F,P,H,D,L);M+=F}}}});$jit.Icicle=new t({Implements:[e,q,h.Icicle],layout:{orientation:"h",vertical:function(){return this.orientation=="v"},horizontal:function(){return this.orientation=="h"},change:function(){this.orientation=this.vertical()?"h":"v"}},initialize:function(B){var C={animate:false,orientation:"h",offset:2,levelsToShow:Number.MAX_VALUE,constrained:false,Node:{type:"rectangle",overridable:true},Edge:{type:"none"},Label:{type:"Native"},duration:700,fps:45};var E=p("Canvas","Node","Edge","Fx","Tips","NodeStyles","Events","Navigation","Controller","Label");this.controller=this.config=d.merge(E,C,B);this.layout.orientation=this.config.orientation;var D=this.config;if(D.useCanvas){this.canvas=D.useCanvas;this.config.labelContainer=this.canvas.id+"-label"}else{this.canvas=new n(this,D);this.config.labelContainer=(typeof D.injectInto=="string"?D.injectInto:D.injectInto.id)+"-label"}this.graphOptions={klass:r,Node:{selected:false,exist:true,drawn:true}};this.graph=new f(this.graphOptions,this.config.Node,this.config.Edge,this.config.Label);this.labels=new $jit.Icicle.Label[this.config.Label.type](this);this.fx=new $jit.Icicle.Plot(this,$jit.Icicle);this.op=new $jit.Icicle.Op(this);this.group=new $jit.Icicle.Group(this);this.clickedNode=null;this.initializeExtras()},refresh:function(){var B=this.config.Label.type;if(B!="Native"){var C=this;this.graph.eachNode(function(D){C.labels.hideLabel(D,false)})}this.compute();this.plot()},plot:function(){this.fx.plot(this.config)},enter:function(E){if(this.busy){return}this.busy=true;var D=this,C=this.config,B=E;var F={onComplete:function(){if(C.request){D.compute()}if(C.animate){D.graph.nodeList.setDataset(["current","end"],{alpha:[1,0]});f.Util.eachSubgraph(E,function(G){G.setData("alpha",1,"end")},"ignore");D.fx.animate({duration:500,modes:["node-property:alpha"],onComplete:function(){D.clickedNode=E;D.compute("end");D.fx.animate({modes:["linear","node-property:width:height"],duration:1000,onComplete:function(){D.busy=false;D.clickedNode=E}})}})}else{D.clickedNode=E;D.busy=false;D.refresh()}}};if(C.request){this.requestNodes(E,F)}else{F.onComplete()}},out:function(){if(this.busy){return}var C=this,D=f.Util,B=this.config,I=this.graph,F=D.getParents(I.getNode(this.clickedNode&&this.clickedNode.id||this.root)),G=F[0],J=G,E=this.clickedNode,H;this.busy=true;this.events.hoveredNode=false;if(!G){this.busy=false;return}H={onComplete:function(){C.clickedNode=G;if(B.request){C.requestNodes(G,{onComplete:function(){C.compute();C.plot();C.busy=false}})}else{C.compute();C.plot();C.busy=false}}};if(B.animate){this.clickedNode=J;this.compute("end");this.clickedNode=E;this.fx.animate({modes:["linear","node-property:width:height"],duration:1000,onComplete:function(){C.clickedNode=J;I.nodeList.setDataset(["current","end"],{alpha:[0,1]});D.eachSubgraph(E,function(L){L.setData("alpha",1)},"ignore");C.fx.animate({duration:500,modes:["node-property:alpha"],onComplete:function(){H.onComplete()}})}})}else{H.onComplete()}},requestNodes:function(D,E){var C=d.merge(this.controller,E),B=this.config.constrained?this.config.levelsToShow:Number.MAX_VALUE;if(C.request){var G=[],F=D._depth;f.Util.eachLevel(D,0,B,function(H){if(H.drawn&&!f.Util.anySubnode(H)){G.push(H);H._level=H._depth-F}});this.group.requestNodes(G,C)}else{C.onComplete()}}});$jit.Icicle.Op=new t({Implements:f.Op});$jit.Icicle.Group=new t({initialize:function(B){this.viz=B;this.canvas=B.canvas;this.config=B.config},requestNodes:function(G,F){var E=0,C=G.length,I={};var D=function(){F.onComplete()};var B=this.viz;if(C==0){D()}for(var H=0;H<C;H++){I[G[H].id]=G[H];F.request(G[H].id,G[H]._level,{onComplete:function(L,J){if(J&&J.children){J.id=L;B.op.sum(J,{type:"nothing"})}if(++E==C){f.Util.computeLevels(B.graph,B.root,0);D()}}})}}});$jit.Icicle.Plot=new t({Implements:f.Plot,plot:function(F,D){F=F||this.viz.controller;var B=this.viz,G=B.graph,C=G.getNode(B.clickedNode&&B.clickedNode.id||B.root),E=C._depth;B.canvas.clear();this.plotTree(C,d.merge(F,{withLabels:true,hideLabels:false,plotSubtree:function(H,I){return !B.config.constrained||(I._depth-E<B.config.levelsToShow)}}),D)}});$jit.Icicle.Label={};$jit.Icicle.Label.Native=new t({Implements:f.Label.Native,renderLabel:function(C,D,F){var I=C.getCtx(),B=D.getData("width"),H=D.getData("height"),J=D.getLabelData("size"),E=I.measureText(D.name);if(H<(J*1.5)||B<E.width){return}var G=D.pos.getc(true);I.fillText(D.name,G.x+B/2,G.y+H/2)}});$jit.Icicle.Label.SVG=new t({Implements:f.Label.SVG,initialize:function(B){this.viz=B},placeLabel:function(C,F,D){var H=F.pos.getc(true),E=this.viz.canvas;var B=E.getSize();var G={x:Math.round(H.x+B.width/2),y:Math.round(H.y+B.height/2)};C.setAttribute("x",G.x);C.setAttribute("y",G.y);D.onPlaceLabel(C,F)}});$jit.Icicle.Label.HTML=new t({Implements:f.Label.HTML,initialize:function(B){this.viz=B},placeLabel:function(C,G,D){var I=G.pos.getc(true),E=this.viz.canvas;var B=E.getSize();var H={x:Math.round(I.x+B.width/2),y:Math.round(I.y+B.height/2)};var F=C.style;F.left=H.x+"px";F.top=H.y+"px";F.display="";D.onPlaceLabel(C,G)}});$jit.Icicle.Plot.NodeTypes=new t({none:{render:d.empty},rectangle:{render:function(E,C,Q){var D=this.viz.config;var H=D.offset;var B=E.getData("width");var N=E.getData("height");var G=E.getData("border");var M=E.pos.getc(true);var L=M.x+H/2,I=M.y+H/2;var P=C.getCtx();if(B-H<2||N-H<2){return}if(D.cushion){var F=E.getData("color");var O=P.createRadialGradient(L+(B-H)/2,I+(N-H)/2,1,L+(B-H)/2,I+(N-H)/2,B<N?N:B);var J=d.rgbToHex(d.map(d.hexToRgb(F),function(R){return R*0.3>>0}));O.addColorStop(0,F);O.addColorStop(1,J);P.fillStyle=O}if(G){P.strokeStyle=G;P.lineWidth=3}P.fillRect(L,I,Math.max(0,B-H),Math.max(0,N-H));G&&P.strokeRect(M.x,M.y,B,N)},contains:function(D,F){if(this.viz.clickedNode&&!$jit.Graph.Util.isDescendantOf(D,this.viz.clickedNode.id)){return false}var E=D.pos.getc(true),C=D.getData("width"),B=D.getData("height");return this.nodeHelper.rectangle.contains({x:E.x+C/2,y:E.y+B/2},F,C,B)}}});$jit.Icicle.Plot.EdgeTypes=new t({none:d.empty});QuadTreeNode=new t({com:[0,0],children:[null,null,null,null],hasChildren:false,mass:null,fItem:null});QuadTreeNodeFactory=new t({maxNodes:50000,nodes:null,setup:function(){this.nodes=new Array()},getQuadTreeNode:function(){if(this.nodes.length>0){return this.nodes.pop()}else{return new QuadTreeNode()}},reclaim:function(B){B.mass=0;B.com[0]=0;B.com[1]=0;B.fItem=null;B.hasChildren=false;B.children=[null,null,null,null];if(this.nodes.length<this.maxNodes){this.nodes.push(B)}}});NBodyForce=new t({pnames:["GravitationalConstant","Distance","BarnesHutTheta"],DEFAULT_GRAV_CONSTANT:-1,DEFAULT_MIN_GRAV_CONSTANT:-10,DEFAULT_MAX_GRAV_CONSTANT:10,DEFAULT_DISTANCE:-1,DEFAULT_MIN_DISTANCE:-1,DEFAULT_MAX_DISTANCE:500,DEFAULT_THETA:0.9,DEFAULT_MIN_THETA:0,DEFAULT_MAX_THETA:1,GRAVITATIONAL_CONST:0,MIN_DISTANCE:1,BARNES_HUT_THETA:2,xMin:null,xMax:null,yMin:null,yMax:null,params:null,minValues:null,maxValues:null,factory:null,root:null,setup:function(){this.params=[this.DEFAULT_GRAV_CONSTANT,this.DEFAULT_DISTANCE,this.DEFAULT_THETA];this.minValues=[this.DEFAULT_MIN_GRAV_CONSTANT,this.DEFAULT_MIN_DISTANCE,this.DEFAULT_MIN_THETA];this.maxValues=[this.DEFAULT_MAX_GRAV_CONSTANT,this.DEFAULT_MAX_DISTANCE,this.DEFAULT_MAX_THETA];this.factory=new QuadTreeNodeFactory();this.factory.setup();this.root=this.factory.getQuadTreeNode()},setBounds:function(C,B,E,D){this.xMin=C;this.yMin=B;this.xMax=E;this.yMax=D},insertHelper:function(C,E,D,L,B,J){var M=C.location[0];var I=C.location[1];var H=(D+B)/2;var G=(L+J)/2;var F=(M>=H?1:0)+(I>=G?2:0);if(E.children[F]==null){E.children[F]=this.factory.getQuadTreeNode();E.hasChildren=true}if(F==1||F==3){D=H}else{B=H}if(F>1){L=G}else{J=G}this.insert(C,E.children[F],D,L,B,J)},isSameLocation:function(E,D){var C=Math.abs(E.location[0]-D.location[0]);var B=Math.abs(E.location[1]-D.location[1]);return(C<0.01&&B<0.01)},insert:function(G,H,D,F,C,E){if(H.hasChildren){this.insertHelper(G,H,D,F,C,E)}else{if(H.fItem!=null){if(this.isSameLocation(H.fItem,G)){this.insertHelper(G,H,D,F,C,E)}else{var B=H.fItem;H.fItem=null;this.insertHelper(B,H,D,F,C,E);this.insertHelper(G,H,D,F,C,E)}}else{H.fItem=G}}},calcMass:function(E){var D=0;var B=0;E.mass=0;if(E.hasChildren){for(var C=0;C<E.children.length;C++){if(E.children[C]!=null){this.calcMass(E.children[C]);E.mass+=E.children[C].mass;D+=E.children[C].mass*E.children[C].com[0];B+=E.children[C].mass*E.children[C].com[1]}}}if(E.fItem!=null){E.mass+=E.fItem.mass;D+=E.fItem.mass*E.fItem.location[0];B+=E.fItem.mass*E.fItem.location[1]}E.com[0]=D/E.mass;E.com[1]=B/E.mass},insertRoot:function(B){this.insert(B,this.root,this.xMin,this.yMin,this.xMax,this.yMax)},clearHelper:function(C){for(var B=0;B<C.children.length;B++){if(C.children[B]!=null){this.clearHelper(C.children[B])}}this.factory.reclaim(C)},clear:function(){this.clearHelper(this.root);this.root=this.factory.getQuadTreeNode()},init:function(D){this.clear();var C=Number.MAX_VALUE;var H=Number.MAX_VALUE;var B=Number.MIN_VALUE;var G=Number.MIN_VALUE;for(var E=0;E<D.items.length;E++){var I=D.items[E].location[0];var F=D.items[E].location[1];if(I<C){C=I}if(F<H){H=F}if(I>B){B=I}if(F>G){G=F}}var L=B-C;var J=G-H;if(L>J){G=H+L}else{B=C+J}this.setBounds(C,H,B,G);for(var E=0;E<D.items.length;E++){this.insertRoot(D.items[E])}this.calcMass(this.root)},getForce:function(B){this.forceHelper(B,this.root,this.xMin,this.yMin,this.xMax,this.yMax)},forceHelper:function(O,E,D,L,C,I){var Q=E.com[0]-O.location[0];var P=E.com[1]-O.location[1];var B=Math.sqrt(Q*Q+P*P);var J=false;if(B==0){Q=(Math.random()-0.5)/50;P=(Math.random()-0.5)/50;B=Math.sqrt(Q*Q+P*P);J=true}var M=this.params[this.MIN_DISTANCE]>0&&B>this.params[this.MIN_DISTANCE];if((!E.hasChildren&&E.fItem!=O)||(!J&&(C-D)/B<this.params[this.BARNES_HUT_THETA])){if(M){return}var N=this.params[this.GRAVITATIONAL_CONST]*O.mass*E.mass/(B*B*B);O.force[0]+=N*Q;O.force[1]+=N*P}else{if(E.hasChildren){var H=(D+C)/2;var G=(L+I)/2;for(var F=0;F<E.children.length;F++){if(E.children[F]!=null){this.forceHelper(O,E.children[F],(F==1||F==3?H:D),(F>1?G:L),(F==1||F==3?C:H),(F>1?I:G))}}if(M){return}if(E.fItem!=null&&E.fItem!=O){var N=this.params[this.GRAVITATIONAL_CONST]*O.mass*E.fItem.mass/(B*B*B);O.force[0]+=N*Q;O.force[1]+=N*P}}}}});SpringForce=new t({pnames:["SpringCoefficient","DefaultSpringLength"],DEFAULT_SPRING_COEFF:0.0001,DEFAULT_MAX_SPRING_COEFF:0.001,DEFAULT_MIN_SPRING_COEFF:0.00001,DEFAULT_SPRING_LENGTH:50,DEFAULT_MIN_SPRING_LENGTH:0,DEFAULT_MAX_SPRING_LENGTH:200,SPRING_COEFF:0,SPRING_LENGTH:1,params:null,minValues:null,maxValues:null,setup:function(){this.params=[this.DEFAULT_SPRING_COEFF,this.DEFAULT_SPRING_LENGTH];this.minValues=[this.DEFAULT_MIN_SPRING_COEFF,this.DEFAULT_MIN_SPRING_LENGTH];this.maxValues=[this.DEFAULT_MAX_SPRING_COEFF,this.DEFAULT_MAX_SPRING_LENGTH]},getForce:function(O){var H=O.item1;var G=O.item2;var E=(O.length<0?this.params[this.SPRING_LENGTH]:O.length);var D=H.location[0];var L=H.location[1];var C=G.location[0];var J=G.location[1];var N=C-D;var M=J-L;var B=Math.sqrt(N*N+M*M);if(B==0){N=(Math.random()-0.5)/50;M=(Math.random()-0.5)/50;B=Math.sqrt(N*N+M*M)}var I=B-E;var F=(O.coeff<0?this.params[this.SPRING_COEFF]:O.coeff)*I/B;H.force[0]+=F*N;H.force[1]+=F*M;G.force[0]+=-F*N;G.force[1]+=-F*M},init:function(){}});DragForce=new t({pnames:["DragCoefficient"],DEFAULT_DRAG_COEFF:0.01,DEFAULT_MIN_DRAG_COEFF:0,DEFAULT_MAX_DRAG_COEFF:0.1,DRAG_COEFF:0,params:null,minValues:null,maxValues:null,setup:function(){this.params=[this.DEFAULT_DRAG_COEFF];this.minValues=[this.DEFAULT_MIN_DRAG_COEFF];this.maxValues=[this.DEFAULT_MAX_DRAG_COEFF]},getForce:function(B){B.force[0]-=this.params[this.DRAG_COEFF]*B.velocity[0];B.force[1]-=this.params[this.DRAG_COEFF]*B.velocity[1]},init:function(){}});RungeKuttaIntegrator=new t({integrate:function(L,C){var D=L.speedLimit;var J,I,M,H;var F,E;for(var G=0;G<L.items.length;G++){var N=L.items[G];H=C/N.mass;F=N.k;E=N.l;N.plocation[0]=N.location[0];N.plocation[1]=N.location[1];F[0][0]=C*N.velocity[0];F[0][1]=C*N.velocity[1];E[0][0]=H*N.force[0];E[0][1]=H*N.force[1];N.location[0]+=0.5*F[0][0];N.location[1]+=0.5*F[0][1]}L.accumulate();for(var G=0;G<L.items.length;G++){var N=L.items[G];H=C/N.mass;F=N.k;E=N.l;J=N.velocity[0]+0.5*E[0][0];I=N.velocity[1]+0.5*E[0][1];M=Math.sqrt(J*J+I*I);if(M>D){J=D*J/M;I=D*I/M}F[1][0]=C*J;F[1][1]=C*I;E[1][0]=H*N.force[0];E[1][1]=H*N.force[1];N.location[0]=N.plocation[0]+0.5*F[1][0];N.location[1]=N.plocation[1]+0.5*F[1][1]}L.accumulate();for(var G=0;G<L.items.length;G++){var N=L.items[G];H=C/N.mass;F=N.k;E=N.l;J=N.velocity[0]+0.5*E[1][0];I=N.velocity[1]+0.5*E[1][1];M=Math.sqrt(J*J+I*I);if(M>D){J=D*J/M;I=D*I/M}F[2][0]=C*J;F[2][1]=C*I;E[2][0]=H*N.force[0];E[2][1]=H*N.force[1];N.location[0]=N.plocation[0]+0.5*F[2][0];N.location[1]=N.plocation[1]+0.5*F[2][1]}L.accumulate();for(var G=0;G<L.items.length;G++){var N=L.items[G];H=C/N.mass;F=N.k;E=N.l;var B=N.plocation;J=N.velocity[0]+E[2][0];I=N.velocity[1]+E[2][1];M=Math.sqrt(J*J+I*I);if(M>D){J=D*J/M;I=D*I/M}F[3][0]=C*J;F[3][1]=C*I;E[3][0]=H*N.force[0];E[3][1]=H*N.force[1];N.location[0]=B[0]+(F[0][0]+F[3][0])/6+(F[1][0]+F[2][0])/3;N.location[1]=B[1]+(F[0][1]+F[3][1])/6+(F[1][1]+F[2][1])/3;J=(E[0][0]+E[3][0])/6+(E[1][0]+E[2][0])/3;I=(E[0][1]+E[3][1])/6+(E[1][1]+E[2][1])/3;M=Math.sqrt(J*J+I*I);if(M>D){J=D*J/M;I=D*I/M}N.velocity[0]+=J;N.velocity[1]+=I}}});ForceSimulator=new t({speedLimit:1,iflen:0,sflen:0,integrator:null,items:null,springs:null,iforces:null,sforces:null,setup:function(){this.items=new Array();this.springs=new Array();this.iforces=new Array();this.sforces=new Array();this.integrator=new RungeKuttaIntegrator()},accumulate:function(){for(var C=0;C<this.iforces.length;C++){this.iforces[C].init(this)}for(var C=0;C<this.sforces.length;C++){this.sforces[C].init(this)}for(var C=0;C<this.items.length;C++){this.items[C].force[0]=0;this.items[C].force[1]=0;for(var B=0;B<this.iforces.length;B++){this.iforces[B].getForce(this.items[C])}}for(var C=0;C<this.springs.length;C++){for(var B=0;B<this.sforces.length;B++){this.sforces[B].getForce(this.springs[C])}}},runSimulator:function(B){this.accumulate();this.integrator.integrate(this,B)},addForce:function(B,C){if(C){this.iforces.push(B);this.iflen++}else{this.sforces.push(B);this.sflen++}},addItem:function(B){this.items.push(B)},addSpring:function(B){this.springs.push(B)}});Spring=new t({item1:null,item2:null,coeff:null,length:null,setup:function(E,D,C,B){this.item1=E;this.item2=D;this.coeff=C;this.length=B}});ForceItem=new t({mass:1,force:null,velocity:null,location:null,plocation:null,k:[[0,0],[0,0],[0,0],[0,0]],l:[[0,0],[0,0],[0,0],[0,0]],setup:function(){this.force=new Array();this.velocity=new Array();this.location=new Array();this.plocation=new Array()},init:function(C,B){this.force[0]=0;this.force[1]=0;this.velocity[0]=0;this.velocity[1]=0;this.location[0]=C;this.location[1]=B;this.plocation[0]=0;this.plocation[1]=0}});h.ForceDirected=new t({getOptions:function(H){var F=this.canvas.getSize();var C=F.width,E=F.height;var G=0;this.graph.eachNode(function(J){G++});var I=C*E/G,D=Math.sqrt(I);var B=this.config.levelDistance;return{width:C-B,height:E-B,tstart:C*0.1,nodef:function(J){return I/(J||1)},edgef:function(J){return D*(J-B)}}},compute:function(C,D){var E=d.splat(C||["current","start","end"]);var B=this.getOptions();g.compute(this.graph,E,this.config);this.graph.computeLevels(this.root,0,"ignore");this.graph.eachNode(function(F){d.each(E,function(G){var H=F.getPos(G);if(H.equals(r.KER)){H.x=B.width/5*(Math.random()-0.5);H.y=B.height/5*(Math.random()-0.5)}F.disp={};d.each(E,function(I){F.disp[I]=u(0,0)})})});this.computePositions(E,B,D)},computePositions:function(F,D,G){var H=this.config.iterations,C=0,E=this;if(G){(function B(){for(var J=G.iter,I=0;I<J;I++){D.t=D.tstart;if(H){D.t*=(1-C++/(H-1))}E.computePositionStep(F,D);if(H&&C>=H){G.onComplete();return}}G.onStep(Math.round(C/(H-1)*100));setTimeout(B,1)})()}else{for(;C<H;C++){D.t=D.tstart*(1-C/(H-1));this.computePositionStep(F,D)}}},computePositionStep:function(I,B){var J=this.graph;var D=Math.min,H=Math.max;var G=u(0,0);J.eachNode(function(M){d.each(I,function(N){M.disp[N].x=0;M.disp[N].y=0});J.eachNode(function(N){if(N.id!=M.id){d.each(I,function(R){var P=M.getPos(R),O=N.getPos(R);G.x=P.x-O.x;G.y=P.y-O.y;var Q=G.norm()||1;M.disp[R].$add(G.$scale(B.nodef(Q)/Q))})}})});var C=!!J.getNode(this.root).visited;J.eachNode(function(M){M.eachAdjacency(function(N){var O=N.nodeTo;if(!!O.visited===C){d.each(I,function(S){var Q=M.getPos(S),P=O.getPos(S);G.x=Q.x-P.x;G.y=Q.y-P.y;var R=G.norm()||1;M.disp[S].$add(G.$scale(-B.edgef(R)/R));O.disp[S].$add(G.$scale(-1))})}});M.visited=!C});var L=B.t,E=B.width/2,F=B.height/2;J.eachNode(function(M){d.each(I,function(P){var N=M.disp[P];var O=N.norm()||1;var P=M.getPos(P);P.$add(u(N.x*D(Math.abs(N.x),L)/O,N.y*D(Math.abs(N.y),L)/O));P.x=D(E,H(-E,P.x));P.y=D(F,H(-F,P.y))})})},computeFast:function(P,I){var L=new ForceSimulator();L.setup();var S=new NBodyForce();S.setup();var Q=new SpringForce();Q.setup();var H=new DragForce();H.setup();L.addForce(S,true);L.addForce(Q,false);L.addForce(H,true);var F=1000;var C=d.splat(P||["current","start","end"]);var E=this.getOptions();var N=[];g.compute(this.graph,C,this.config);this.graph.computeLevels(this.root,0,"ignore");this.graph.eachNode(function(T){d.each(C,function(U){var V=T.getPos(U);V.x=E.width/2;V.y=E.height/2;T.forceItem=new ForceItem();T.forceItem.setup();T.forceItem.init(V.x,V.y);L.addItem(T.forceItem);T.disp={};d.each(C,function(W){T.disp[W]=u(0,0)})})});this.graph.eachNode(function(T){T.eachAdjacency(function(U){if(N[U.nodeTo.id]===undefined){var V=new Spring();V.setup(U.nodeFrom.forceItem,U.nodeTo.forceItem,-1,-1);L.addSpring(V);N[U.nodeFrom.id]=[];N[U.nodeFrom.id][U.nodeTo.id]=true}})});var D=Math.ceil(this.config.iterations/I.iter);var M=0;var O=0;var B=this.config.iterations;var G=0;var R=this.graph;(function J(){for(var ac=I.iter,ab=0;ab<ac;ab++){E.t=E.tstart;if(B){E.t*=(1-G++/(B-1))}F*=(1-G/B);var X=F+50;L.runSimulator(X);if(B&&G>=B){var W=0;var ae=0;var V=E.width/2;var ad=E.height/2;R.eachNode(function(ag){d.each(C,function(am){var ai=ag.forceItem.location[0];var ao=ag.forceItem.location[1];var ah=ag.getData("dim")*2;var al=ag.getData("dim")*2;var aj=ag.disp[am];var ak=aj.norm()||1;var an=ag.getPos(am);an.x=ai;an.y=ao})});I.onComplete();var U=-Number.MAX_VALUE;var aa=Number.MAX_VALUE;var T=-Number.MAX_VALUE;var Z=Number.MAX_VALUE;R.eachNode(function(ag){d.each(C,function(ai){var ah=ag.getPos(ai);if(ah.x>U){U=ah.x}if(ah.x<aa){aa=ah.x}if(ah.y>T){T=ah.y}if(ah.y<Z){Z=ah.y}})});var af;var Y;if(U<0){Y=Math.ceil(Math.floor(Math.abs(aa))-Math.floor(Math.abs(U)))}else{if(aa>=0){Y=Math.ceil(U-aa)}else{Y=Math.ceil(U+Math.abs(aa))}}if(T<0){af=Math.ceil(Math.floor(Math.abs(Z))-Math.floor(Math.abs(T)))}else{if(Z>=0){af=Math.ceil(T-Z)}else{af=Math.ceil(T+Math.abs(Z))}}var V=E.width/2;var ad=E.height/2;R.eachNode(function(ag){d.each(C,function(aj){var ah=ag.getPos(aj);var ai=ag.getData("dim");if(aa<0){ah.x=((ah.x+Math.abs(aa))*(E.width/Y))-(E.width/2)}else{ah.x=((ah.x-aa)*(E.width/Y))-(E.width/2)}if(ah.x<=-V+ai){ah.x=-V+(ai*2)}if(ah.x>=V-ai){ah.x=V-(ai*2)}if(Z<0){ah.y=((ah.y+Math.abs(Z))*(E.height/af))-(E.height/2)}else{ah.y=((ah.y-Z)*(E.height/af))-(E.height/2)}if(ah.y<=-ad+ai){ah.y=-ad+(ai*2)}if(ah.y>=ad-ai){ah.y=ad-(ai*2)}})});return}}I.onStep(Math.round(G/(B-1)*100));setTimeout(J,1)})()}});$jit.ForceDirected=new t({Implements:[e,q,h.ForceDirected],initialize:function(C){var B=$jit.ForceDirected;var D={iterations:50,levelDistance:50};this.controller=this.config=d.merge(p("Canvas","Node","Edge","Fx","Tips","NodeStyles","Events","Navigation","Controller","Label"),D,C);var E=this.config;if(E.useCanvas){this.canvas=E.useCanvas;this.config.labelContainer=this.canvas.id+"-label"}else{if(E.background){E.background=d.merge({type:"Circles"},E.background)}this.canvas=new n(this,E);this.config.labelContainer=(typeof E.injectInto=="string"?E.injectInto:E.injectInto.id)+"-label"}this.graphOptions={klass:r,Node:{selected:false,exist:true,drawn:true}};this.graph=new f(this.graphOptions,this.config.Node,this.config.Edge);this.labels=new B.Label[E.Label.type](this);this.fx=new B.Plot(this,B);this.op=new B.Op(this);this.json=null;this.busy=false;this.initializeExtras()},refresh:function(){this.compute();this.plot()},reposition:function(){this.compute("end")},computeIncremental:function(B){B=d.merge({iter:20,property:"end",onStep:d.empty,onComplete:d.empty},B||{});this.config.onBeforeCompute(this.graph.getNode(this.root));this.compute(B.property,B)},computePrefuse:function(B){B=d.merge({iter:20,property:"end",onStep:d.empty,onComplete:d.empty},B||{});this.config.onBeforeCompute(this.graph.getNode(this.root));this.computeFast(B.property,B)},plot:function(){this.fx.plot()},animate:function(B){this.fx.animate(d.merge({modes:["linear"]},B||{}))}});$jit.ForceDirected.$extend=true;(function(B){B.Op=new t({Implements:f.Op});B.Plot=new t({Implements:f.Plot});B.Label={};B.Label.Native=new t({Implements:f.Label.Native});B.Label.SVG=new t({Implements:f.Label.SVG,initialize:function(C){this.viz=C},placeLabel:function(N,G,H){var L=G.pos.getc(true),D=this.viz.canvas,E=D.translateOffsetX,C=D.translateOffsetY,M=D.scaleOffsetX,J=D.scaleOffsetY,I=D.getSize();var F={x:Math.round(L.x*M+E+I.width/2),y:Math.round(L.y*J+C+I.height/2)};N.setAttribute("x",F.x);N.setAttribute("y",F.y);H.onPlaceLabel(N,G)}});B.Label.HTML=new t({Implements:f.Label.HTML,initialize:function(C){this.viz=C},placeLabel:function(O,H,I){var M=H.pos.getc(true),E=this.viz.canvas,F=E.translateOffsetX,D=E.translateOffsetY,N=E.scaleOffsetX,L=E.scaleOffsetY,J=E.getSize();var G={x:Math.round(M.x*N+F+J.width/2),y:Math.round(M.y*L+D+J.height/2)};var C=O.style;C.left=G.x+"px";C.top=G.y+"px";C.display=this.fitsInCanvas(G,E)?"":"none";I.onPlaceLabel(O,H)}});B.Plot.NodeTypes=new t({none:{render:d.empty,contains:d.lambda(false)},circle:{render:function(D,C){var F=D.pos.getc(true),E=D.getData("dim");this.nodeHelper.circle.render("fill",F,E,C)},contains:function(C,F){var E=C.pos.getc(true),D=C.getData("dim");return this.nodeHelper.circle.contains(E,F,D)}},ellipse:{render:function(F,D){var G=F.pos.getc(true),E=F.getData("width"),C=F.getData("height");this.nodeHelper.ellipse.render("fill",G,E,C,D)},contains:function(E,G){var F=E.pos.getc(true),D=E.getData("width"),C=E.getData("height");return this.nodeHelper.ellipse.contains(F,G,D,C)}},square:{render:function(D,C){var F=D.pos.getc(true),E=D.getData("dim");this.nodeHelper.square.render("fill",F,E,C)},contains:function(C,F){var E=C.pos.getc(true),D=C.getData("dim");return this.nodeHelper.square.contains(E,F,D)}},rectangle:{render:function(F,D){var G=F.pos.getc(true),E=F.getData("width"),C=F.getData("height");this.nodeHelper.rectangle.render("fill",G,E,C,D)},contains:function(E,G){var F=E.pos.getc(true),D=E.getData("width"),C=E.getData("height");return this.nodeHelper.rectangle.contains(F,G,D,C)}},triangle:{render:function(D,C){var F=D.pos.getc(true),E=D.getData("dim");this.nodeHelper.triangle.render("fill",F,E,C)},contains:function(C,F){var E=C.pos.getc(true),D=C.getData("dim");return this.nodeHelper.triangle.contains(E,F,D)}},star:{render:function(D,C){var F=D.pos.getc(true),E=D.getData("dim");this.nodeHelper.star.render("fill",F,E,C)},contains:function(C,F){var E=C.pos.getc(true),D=C.getData("dim");return this.nodeHelper.star.contains(E,F,D)}}});B.Plot.EdgeTypes=new t({none:d.empty,line:{render:function(C,D){var F=C.nodeFrom.pos.getc(true),E=C.nodeTo.pos.getc(true);this.edgeHelper.line.render(F,E,D)},contains:function(C,F){var E=C.nodeFrom.pos.getc(true),D=C.nodeTo.pos.getc(true);return this.edgeHelper.line.contains(E,D,F,this.edge.epsilon)}},arrow:{render:function(D,E){var I=D.nodeFrom.pos.getc(true),H=D.nodeTo.pos.getc(true),G=D.getData("dim"),F=D.data.$direction,C=(F&&F.length>1&&F[0]!=D.nodeFrom.id);this.edgeHelper.arrow.render(I,H,G,C,E)},contains:function(C,F){var E=C.nodeFrom.pos.getc(true),D=C.nodeTo.pos.getc(true);return this.edgeHelper.arrow.contains(E,D,F,this.edge.epsilon)}}})})($jit.ForceDirected);$jit.TM={};var A=$jit.TM;$jit.TM.$extend=true;A.Base={layout:{orientation:"h",vertical:function(){return this.orientation=="v"},horizontal:function(){return this.orientation=="h"},change:function(){this.orientation=this.vertical()?"h":"v"}},initialize:function(B){var C={orientation:"h",titleHeight:13,offset:2,levelsToShow:0,labelsToShow:[0,-1],constrained:false,animate:false,Node:{type:"rectangle",overridable:true,width:3,height:3,color:"#444",props:"node-property:width:height"},Label:{textAlign:"center",textBaseline:"top"},Edge:{type:"none"},duration:700,fps:45};this.controller=this.config=d.merge(p("Canvas","Node","Edge","Fx","Controller","Tips","NodeStyles","Events","Navigation","Label"),C,B);this.layout.orientation=this.config.orientation;var D=this.config;if(D.useCanvas){this.canvas=D.useCanvas;this.config.labelContainer=this.canvas.id+"-label"}else{if(D.background){D.background=d.merge({type:"Circles"},D.background)}this.canvas=new n(this,D);this.config.labelContainer=(typeof D.injectInto=="string"?D.injectInto:D.injectInto.id)+"-label"}this.graphOptions={klass:r,Node:{selected:false,exist:true,drawn:true}};this.graph=new f(this.graphOptions,this.config.Node,this.config.Edge);this.labels=new A.Label[D.Label.type](this);this.fx=new A.Plot(this);this.op=new A.Op(this);this.group=new A.Group(this);this.geom=new A.Geom(this);this.clickedNode=null;this.busy=false;this.initializeExtras()},refresh:function(){if(this.busy){return}this.busy=true;var C=this;if(this.config.animate){this.compute("end");this.geom.setRightLevelToShow(this.graph.getNode(this.clickedNode&&this.clickedNode.id||this.root));this.fx.animate(d.merge(this.config,{modes:["linear",this.config.Node.props],onComplete:function(){C.busy=false}}))}else{var B=this.config.Label.type;if(B!="Native"){this.graph.eachNode(function(D){C.labels.hideLabel(D,false)})}this.busy=false;this.compute();this.geom.setRightLevelToShow(this.graph.getNode(this.clickedNode&&this.clickedNode.id||this.root));this.plot()}},plot:function(){this.fx.plot()},leaf:function(B){return B.getSubnodes([1,1],"ignore").length==0},enter:function(H){if(this.busy){return}this.busy=true;var D=this,C=this.config,F=this.graph,B=H,E=this.clickedNode;var G={onComplete:function(){D.geom.setRightLevelToShow(H);if(C.request){D.compute()}if(C.animate){F.nodeList.setData("alpha",0,"end");H.eachSubgraph(function(I){I.setData("alpha",1,"end");I.selected=false},"ignore");B.selected=true;D.fx.animate({duration:D.config.duration/3,modes:["node-property:alpha"],onComplete:function(){D.clickedNode=B;D.compute("end");D.clickedNode=E;D.fx.animate({duration:2*D.config.duration/3,modes:["linear",D.config.Node.props],onComplete:function(){D.busy=false;D.clickedNode=B;D.geom.setRightLevelToShow(B)}})}})}else{D.busy=false;D.clickedNode=H;D.refresh()}}};this.geom.setRightLevelToShow(H);if(C.request){this.requestNodes(B,G)}else{G.onComplete()}},out:function(){if(this.busy){return}this.busy=true;this.events.hoveredNode=false;var F=this,D=this.config,H=this.graph,C=H.getNode(this.clickedNode&&this.clickedNode.id||this.root).getParents(),E=C[0],B=E,G=this.clickedNode;if(!E){this.busy=false;return}E.selected=true;var I={onComplete:function(){G.selected=false;F.clickedNode=E;if(D.request){F.requestNodes(E,{onComplete:function(){F.compute();F.plot();F.busy=false}})}else{F.compute();F.plot();F.busy=false}F.geom.setRightLevelToShow(E);F.plot()}};this.geom.setRightLevelToShow(E);if(D.animate){this.clickedNode=B;this.compute("end");this.clickedNode=G;this.fx.animate({duration:2*this.config.duration/3,modes:["linear",this.config.Node.props],onComplete:function(){F.clickedNode=B;B.eachSubgraph(function(J){J.setDataset(["current","end"],{alpha:[0,1]})},"ignore");G.eachSubgraph(function(J){J.setData("alpha",1)},"ignore");F.geom.setRightLevelToShow(E);F.fx.animate({duration:F.config.duration/3,modes:["node-property:alpha"],onComplete:function(){I.onComplete()}})}})}else{I.onComplete()}},requestNodes:function(D,E){var C=d.merge(this.controller,E),B=this.config.levelsToShow;if(C.request){var G=[],F=D._depth;D.eachLevel(0,B,function(I){var H=B-(I._depth-F);if(I.drawn&&!I.anySubnode()&&H>0){G.push(I);I._level=H}});this.group.requestNodes(G,C)}else{C.onComplete()}},reposition:function(){this.compute("end")}};A.Op=new t({Implements:f.Op,initialize:function(B){this.viz=B}});A.Geom=new t({Implements:f.Geom,getRightLevelToShow:function(){return this.viz.config.levelsToShow},setRightLevelToShow:function(C){var F=this.getRightLevelToShow(),E=this.viz.config.labelsToShow,B=this.viz.labels;var D={};C.eachLevel(0,false,function(H){var G=H._depth-C._depth;H._hideLabel=E[0]>=0&&G<E[0]||E[1]>=0&&G>E[1];if(F>0&&G>F){H.drawn=false;H.exist=false;H.ignore=true;B.hideLabel(H,false)}else{H.drawn=true;H.exist=true;delete H.ignore}D[H.name]=H._hideLabel});C.drawn=true;delete C.ignore}});A.Group=new t({initialize:function(B){this.viz=B;this.canvas=B.canvas;this.config=B.config},requestNodes:function(G,F){var E=0,C=G.length,I={};var D=function(){F.onComplete()};var B=this.viz;if(C==0){D()}for(var H=0;H<C;H++){I[G[H].id]=G[H];F.request(G[H].id,G[H]._level,{onComplete:function(L,J){if(J&&J.children){J.id=L;B.op.sum(J,{type:"nothing"})}if(++E==C){B.graph.computeLevels(B.root,0);D()}}})}}});A.Plot=new t({Implements:f.Plot,initialize:function(B){this.viz=B;this.config=B.config;this.node=this.config.Node;this.edge=this.config.Edge;this.animation=new z;this.nodeTypes=new A.Plot.NodeTypes;this.edgeTypes=new A.Plot.EdgeTypes;this.labels=B.labels},plot:function(D,C){var B=this.viz,E=B.graph;B.canvas.clear();this.plotTree(E.getNode(B.clickedNode&&B.clickedNode.id||B.root),d.merge(B.config,D||{},{withLabels:true,hideLabels:false,plotSubtree:function(G,F){return G.anySubnode("exist")}}),C)}});A.Label={};A.Label.Native=new t({Implements:f.Label.Native,initialize:function(B){this.config=B.config;this.leaf=B.leaf},renderLabel:function(C,D,E){if(D._hideLabel||!this.leaf(D)&&!this.config.titleHeight){return}var G=D.pos.getc(true),J=C.getCtx(),B=D.getData("width"),I=D.getData("height"),H=G.x+B/2,F=G.y;if(isNaN(B)||B===0){J.fillText(D.name,H,F)}else{J.fillText(D.name,H,F,B)}}});A.Label.SVG=new t({Implements:f.Label.SVG,initialize:function(B){this.viz=B;this.leaf=B.leaf;this.config=B.config},placeLabel:function(M,F,G){G=G||this.viz.controller;var J=F.pos.getc(true),C=this.viz.canvas,D=C.translateOffsetX,B=C.translateOffsetY,L=C.scaleOffsetX,I=C.scaleOffsetY,H=C.getSize();var E={x:Math.round(J.x*L+D+H.width/2),y:Math.round(J.y*I+B+H.height/2)};M.setAttribute("x",E.x);M.setAttribute("y",E.y);if(F._hideLabel||!this.leaf(F)&&!this.config.titleHeight){M.style.display="none"}G.onPlaceLabel(M,F)}});A.Label.HTML=new t({Implements:f.Label.HTML,initialize:function(B){this.viz=B;this.leaf=B.leaf;this.config=B.config},placeLabel:function(N,G,H){H=H||this.viz.controller;var L=G.pos.getc(true),D=this.viz.canvas,E=D.translateOffsetX,C=D.translateOffsetY,M=D.scaleOffsetX,J=D.scaleOffsetY,I=D.getSize();var F={x:Math.round(L.x*M+E+I.width/2),y:Math.round(L.y*J+C+I.height/2)};var B=N.style;B.left=F.x+"px";B.top=F.y+"px";B.width=Math.max(0,G.getData("width")*M)+"px";B.height=Math.max(0,G.getData("height")*J)+"px";B.zIndex=G._depth*100;B.display="";if(G._hideLabel||!this.leaf(G)&&!this.config.titleHeight){N.style.display="none"}H.onPlaceLabel(N,G)}});A.Plot.NodeTypes=new t({none:{render:d.empty},rectangle:{render:function(E,C,S){var I=this.viz.leaf(E),D=this.config,O=D.offset,H=D.titleHeight,N=E.pos.getc(true),B=E.getData("width"),P=E.getData("height"),G=E.getData("border"),R=C.getCtx(),M=N.x+O/2,J=N.y+O/2;if(B<=O||P<=O){return}if(I){if(D.cushion){var Q=R.createRadialGradient(M+(B-O)/2,J+(P-O)/2,1,M+(B-O)/2,J+(P-O)/2,B<P?P:B);var F=E.getData("color");var L=d.rgbToHex(d.map(d.hexToRgb(F),function(T){return T*0.2>>0}));Q.addColorStop(0,F);Q.addColorStop(1,L);R.fillStyle=Q}R.fillRect(M,J,B-O,P-O);if(G){R.save();R.strokeStyle=G;R.strokeRect(M,J,B-O,P-O);R.restore()}}else{if(H>0){R.fillRect(N.x+O/2,N.y+O/2,B-O,H-O);if(G){R.save();R.strokeStyle=G;R.strokeRect(N.x+O/2,N.y+O/2,B-O,P-O);R.restore()}}}},contains:function(E,G){if(this.viz.clickedNode&&!E.isDescendantOf(this.viz.clickedNode.id)||E.ignore){return false}var F=E.pos.getc(true),D=E.getData("width"),C=this.viz.leaf(E),B=C?E.getData("height"):this.config.titleHeight;return this.nodeHelper.rectangle.contains({x:F.x+D/2,y:F.y+B/2},G,D,B)}}});A.Plot.EdgeTypes=new t({none:d.empty});A.SliceAndDice=new t({Implements:[e,q,A.Base,h.TM.SliceAndDice]});A.Squarified=new t({Implements:[e,q,A.Base,h.TM.Squarified]});A.Strip=new t({Implements:[e,q,A.Base,h.TM.Strip]});$jit.RGraph=new t({Implements:[e,q,h.Radial],initialize:function(B){var C=$jit.RGraph;var D={interpolation:"linear",levelDistance:100};this.controller=this.config=d.merge(p("Canvas","Node","Edge","Fx","Controller","Tips","NodeStyles","Events","Navigation","Label"),D,B);var E=this.config;if(E.useCanvas){this.canvas=E.useCanvas;this.config.labelContainer=this.canvas.id+"-label"}else{if(E.background){E.background=d.merge({type:"Circles"},E.background)}this.canvas=new n(this,E);this.config.labelContainer=(typeof E.injectInto=="string"?E.injectInto:E.injectInto.id)+"-label"}this.graphOptions={klass:b,Node:{selected:false,exist:true,drawn:true}};this.graph=new f(this.graphOptions,this.config.Node,this.config.Edge);this.labels=new C.Label[E.Label.type](this);this.fx=new C.Plot(this,C);this.op=new C.Op(this);this.json=null;this.root=null;this.busy=false;this.parent=false;this.initializeExtras()},createLevelDistanceFunc:function(){var B=this.config.levelDistance;return function(C){return(C._depth+1)*B}},refresh:function(){this.compute();this.plot()},reposition:function(){this.compute("end")},plot:function(){this.fx.plot()},getNodeAndParentAngle:function(I){var D=false;var H=this.graph.getNode(I);var F=H.getParents();var E=(F.length>0)?F[0]:false;if(E){var B=E.pos.getc(),G=H.pos.getc();var C=B.add(G.scale(-1));D=Math.atan2(C.y,C.x);if(D<0){D+=2*Math.PI}}return{parent:E,theta:D}},tagChildren:function(F,H){if(F.angleSpan){var G=[];F.eachAdjacency(function(I){G.push(I.nodeTo)},"ignore");var B=G.length;for(var E=0;E<B&&H!=G[E].id;E++){}for(var D=(E+1)%B,C=0;H!=G[D].id;D=(D+1)%B){G[D].dist=C++}}},onClick:function(G,C){if(this.root!=G&&!this.busy){this.busy=true;this.root=G;var D=this;this.controller.onBeforeCompute(this.graph.getNode(G));var E=this.getNodeAndParentAngle(G);this.tagChildren(E.parent,G);this.parent=E.parent;this.compute("end");var B=E.theta-E.parent.endPos.theta;this.graph.eachNode(function(H){H.endPos.set(H.endPos.getp().add(l(B,0)))});var F=this.config.interpolation;C=d.merge({onComplete:d.empty},C||{});this.fx.animate(d.merge({hideLabels:true,modes:[F]},C,{onComplete:function(){D.busy=false;C.onComplete()}}))}}});$jit.RGraph.$extend=true;(function(B){B.Op=new t({Implements:f.Op});B.Plot=new t({Implements:f.Plot});B.Label={};B.Label.Native=new t({Implements:f.Label.Native});B.Label.SVG=new t({Implements:f.Label.SVG,initialize:function(C){this.viz=C},placeLabel:function(N,G,H){var L=G.pos.getc(true),D=this.viz.canvas,E=D.translateOffsetX,C=D.translateOffsetY,M=D.scaleOffsetX,J=D.scaleOffsetY,I=D.getSize();var F={x:Math.round(L.x*M+E+I.width/2),y:Math.round(L.y*J+C+I.height/2)};N.setAttribute("x",F.x);N.setAttribute("y",F.y);H.onPlaceLabel(N,G)}});B.Label.HTML=new t({Implements:f.Label.HTML,initialize:function(C){this.viz=C},placeLabel:function(O,H,I){var M=H.pos.getc(true),E=this.viz.canvas,F=E.translateOffsetX,D=E.translateOffsetY,N=E.scaleOffsetX,L=E.scaleOffsetY,J=E.getSize();var G={x:Math.round(M.x*N+F+J.width/2),y:Math.round(M.y*L+D+J.height/2)};var C=O.style;C.left=G.x+"px";C.top=G.y+"px";C.display=this.fitsInCanvas(G,E)?"":"none";I.onPlaceLabel(O,H)}});B.Plot.NodeTypes=new t({none:{render:d.empty,contains:d.lambda(false)},circle:{render:function(D,C){var F=D.pos.getc(true),E=D.getData("dim");this.nodeHelper.circle.render("fill",F,E,C)},contains:function(C,F){var E=C.pos.getc(true),D=C.getData("dim");return this.nodeHelper.circle.contains(E,F,D)}},ellipse:{render:function(F,D){var G=F.pos.getc(true),E=F.getData("width"),C=F.getData("height");this.nodeHelper.ellipse.render("fill",G,E,C,D)},contains:function(E,G){var F=E.pos.getc(true),D=E.getData("width"),C=E.getData("height");return this.nodeHelper.ellipse.contains(F,G,D,C)}},square:{render:function(D,C){var F=D.pos.getc(true),E=D.getData("dim");this.nodeHelper.square.render("fill",F,E,C)},contains:function(C,F){var E=C.pos.getc(true),D=C.getData("dim");return this.nodeHelper.square.contains(E,F,D)}},rectangle:{render:function(F,D){var G=F.pos.getc(true),E=F.getData("width"),C=F.getData("height");this.nodeHelper.rectangle.render("fill",G,E,C,D)},contains:function(E,G){var F=E.pos.getc(true),D=E.getData("width"),C=E.getData("height");return this.nodeHelper.rectangle.contains(F,G,D,C)}},triangle:{render:function(D,C){var F=D.pos.getc(true),E=D.getData("dim");this.nodeHelper.triangle.render("fill",F,E,C)},contains:function(C,F){var E=C.pos.getc(true),D=C.getData("dim");return this.nodeHelper.triangle.contains(E,F,D)}},star:{render:function(D,C){var F=D.pos.getc(true),E=D.getData("dim");this.nodeHelper.star.render("fill",F,E,C)},contains:function(C,F){var E=C.pos.getc(true),D=C.getData("dim");return this.nodeHelper.star.contains(E,F,D)}}});B.Plot.EdgeTypes=new t({none:d.empty,line:{render:function(C,D){var F=C.nodeFrom.pos.getc(true),E=C.nodeTo.pos.getc(true);this.edgeHelper.line.render(F,E,D)},contains:function(C,F){var E=C.nodeFrom.pos.getc(true),D=C.nodeTo.pos.getc(true);return this.edgeHelper.line.contains(E,D,F,this.edge.epsilon)}},arrow:{render:function(D,E){var J=D.nodeFrom.pos.getc(true),I=D.nodeTo.pos.getc(true),H=D.getData("dim"),G=D.data.$direction,C=(G&&G.length>1&&G[0]!=D.nodeFrom.id),F=this.edge.arrowPosition||"end";this.edgeHelper.arrow.render(J,I,H,C,E,F)},contains:function(C,F){var E=C.nodeFrom.pos.getc(true),D=C.nodeTo.pos.getc(true);return this.edgeHelper.arrow.contains(E,D,F,this.edge.epsilon)}}})})($jit.RGraph);r.prototype.moebiusTransformation=function(D){var B=this.add(D);var C=D.$conjugate().$prod(this);C.x++;return B.$div(C)};f.Util.moebiusTransformation=function(D,F,E,C,B){this.eachNode(D,function(H){for(var G=0;G<E.length;G++){var J=F[G].scale(-1),I=C?C:E[G];H.getPos(E[G]).set(H.getPos(I).getc().moebiusTransformation(J))}},B)};$jit.Hypertree=new t({Implements:[e,q,h.Radial],initialize:function(B){var E=$jit.Hypertree;var C={radius:"auto",offset:0,Edge:{type:"hyperline"},duration:1500,fps:35};this.controller=this.config=d.merge(p("Canvas","Node","Edge","Fx","Tips","NodeStyles","Events","Navigation","Controller","Label"),C,B);var D=this.config;if(D.useCanvas){this.canvas=D.useCanvas;this.config.labelContainer=this.canvas.id+"-label"}else{if(D.background){D.background=d.merge({type:"Circles"},D.background)}this.canvas=new n(this,D);this.config.labelContainer=(typeof D.injectInto=="string"?D.injectInto:D.injectInto.id)+"-label"}this.graphOptions={klass:b,Node:{selected:false,exist:true,drawn:true}};this.graph=new f(this.graphOptions,this.config.Node,this.config.Edge);this.labels=new E.Label[D.Label.type](this);this.fx=new E.Plot(this,E);this.op=new E.Op(this);this.json=null;this.root=null;this.busy=false;this.initializeExtras()},createLevelDistanceFunc:function(){var F=this.getRadius();var H=0,B=Math.max,C=this.config;this.graph.eachNode(function(I){H=B(I._depth,H)},"ignore");H++;var G=function(I){return function(L){L.scale=F;var N=L._depth+1;var M=0,J=Math.pow;while(N){M+=J(I,N--)}return M-C.offset}};for(var E=0.51;E<=1;E+=0.01){var D=(1-Math.pow(E,H))/(1-E);if(D>=2){return G(E-0.01)}}return G(0.75)},getRadius:function(){var B=this.config.radius;if(B!=="auto"){return B}var C=this.canvas.getSize();return Math.min(C.width,C.height)/2},refresh:function(B){if(B){this.reposition();this.graph.eachNode(function(C){C.startPos.rho=C.pos.rho=C.endPos.rho;C.startPos.theta=C.pos.theta=C.endPos.theta})}else{this.compute()}this.plot()},reposition:function(){this.compute("end");var B=this.graph.getNode(this.root).pos.getc().scale(-1);f.Util.moebiusTransformation(this.graph,[B],["end"],"end","ignore");this.graph.eachNode(function(C){if(C.ignore){C.endPos.rho=C.pos.rho;C.endPos.theta=C.pos.theta}})},plot:function(){this.fx.plot()},onClick:function(D,B){var C=this.graph.getNode(D).pos.getc(true);this.move(C,B)},move:function(F,D){var C=u(F.x,F.y);if(this.busy===false&&C.norm()<1){this.busy=true;var B=this.graph.getClosestNodeToPos(C),E=this;this.graph.computeLevels(B.id,0);this.controller.onBeforeCompute(B);D=d.merge({onComplete:d.empty},D||{});this.fx.animate(d.merge({modes:["moebius"],hideLabels:true},D,{onComplete:function(){E.busy=false;D.onComplete()}}),C)}}});$jit.Hypertree.$extend=true;(function(B){B.Op=new t({Implements:f.Op});B.Plot=new t({Implements:f.Plot});B.Label={};B.Label.Native=new t({Implements:f.Label.Native,initialize:function(C){this.viz=C},renderLabel:function(E,G,D){var C=E.getCtx();var H=G.pos.getc(true);var F=this.viz.getRadius();C.fillText(G.name,H.x*F,H.y*F)}});B.Label.SVG=new t({Implements:f.Label.SVG,initialize:function(C){this.viz=C},placeLabel:function(O,H,I){var M=H.pos.getc(true),E=this.viz.canvas,F=E.translateOffsetX,D=E.translateOffsetY,N=E.scaleOffsetX,L=E.scaleOffsetY,J=E.getSize(),C=this.viz.getRadius();var G={x:Math.round((M.x*N)*C+F+J.width/2),y:Math.round((M.y*L)*C+D+J.height/2)};O.setAttribute("x",G.x);O.setAttribute("y",G.y);I.onPlaceLabel(O,H)}});B.Label.HTML=new t({Implements:f.Label.HTML,initialize:function(C){this.viz=C},placeLabel:function(P,I,J){var N=I.pos.getc(true),F=this.viz.canvas,G=F.translateOffsetX,E=F.translateOffsetY,O=F.scaleOffsetX,M=F.scaleOffsetY,L=F.getSize(),C=this.viz.getRadius();var H={x:Math.round((N.x*O)*C+G+L.width/2),y:Math.round((N.y*M)*C+E+L.height/2)};var D=P.style;D.left=H.x+"px";D.top=H.y+"px";D.display=this.fitsInCanvas(H,F)?"":"none";J.onPlaceLabel(P,I)}});B.Plot.NodeTypes=new t({none:{render:d.empty,contains:d.lambda(false)},circle:{render:function(E,C){var D=this.node,G=E.getData("dim"),F=E.pos.getc();G=D.transform?G*(1-F.squaredNorm()):G;F.$scale(E.scale);if(G>0.2){this.nodeHelper.circle.render("fill",F,G,C)}},contains:function(C,F){var D=C.getData("dim"),E=C.pos.getc().$scale(C.scale);return this.nodeHelper.circle.contains(E,F,D)}},ellipse:{render:function(F,D){var G=F.pos.getc().$scale(F.scale),E=F.getData("width"),C=F.getData("height");this.nodeHelper.ellipse.render("fill",G,E,C,D)},contains:function(E,G){var D=E.getData("width"),C=E.getData("height"),F=E.pos.getc().$scale(E.scale);return this.nodeHelper.circle.contains(F,G,D,C)}},square:{render:function(E,C){var D=this.node,G=E.getData("dim"),F=E.pos.getc();G=D.transform?G*(1-F.squaredNorm()):G;F.$scale(E.scale);if(G>0.2){this.nodeHelper.square.render("fill",F,G,C)}},contains:function(C,F){var D=C.getData("dim"),E=C.pos.getc().$scale(C.scale);return this.nodeHelper.square.contains(E,F,D)}},rectangle:{render:function(G,D){var F=this.node,E=G.getData("width"),C=G.getData("height"),H=G.pos.getc();E=F.transform?E*(1-H.squaredNorm()):E;C=F.transform?C*(1-H.squaredNorm()):C;H.$scale(G.scale);if(E>0.2&&C>0.2){this.nodeHelper.rectangle.render("fill",H,E,C,D)}},contains:function(E,G){var D=E.getData("width"),C=E.getData("height"),F=E.pos.getc().$scale(E.scale);return this.nodeHelper.rectangle.contains(F,G,D,C)}},triangle:{render:function(E,C){var D=this.node,G=E.getData("dim"),F=E.pos.getc();G=D.transform?G*(1-F.squaredNorm()):G;F.$scale(E.scale);if(G>0.2){this.nodeHelper.triangle.render("fill",F,G,C)}},contains:function(C,F){var D=C.getData("dim"),E=C.pos.getc().$scale(C.scale);return this.nodeHelper.triangle.contains(E,F,D)}},star:{render:function(E,C){var D=this.node,G=E.getData("dim"),F=E.pos.getc();G=D.transform?G*(1-F.squaredNorm()):G;F.$scale(E.scale);if(G>0.2){this.nodeHelper.star.render("fill",F,G,C)}},contains:function(C,F){var D=C.getData("dim"),E=C.pos.getc().$scale(C.scale);return this.nodeHelper.star.contains(E,F,D)}}});B.Plot.EdgeTypes=new t({none:d.empty,line:{render:function(C,D){var G=C.nodeFrom.pos.getc(true),F=C.nodeTo.pos.getc(true),E=C.nodeFrom.scale;this.edgeHelper.line.render({x:G.x*E,y:G.y*E},{x:F.x*E,y:F.y*E},D)},contains:function(C,G){var F=C.nodeFrom.pos.getc(true),E=C.nodeTo.pos.getc(true),D=C.nodeFrom.scale;this.edgeHelper.line.contains({x:F.x*D,y:F.y*D},{x:E.x*D,y:E.y*D},G,this.edge.epsilon)}},arrow:{render:function(D,E){var J=D.nodeFrom.pos.getc(true),I=D.nodeTo.pos.getc(true),F=D.nodeFrom.scale,H=D.getData("dim"),G=D.data.$direction,C=(G&&G.length>1&&G[0]!=D.nodeFrom.id);this.edgeHelper.arrow.render({x:J.x*F,y:J.y*F},{x:I.x*F,y:I.y*F},H,C,E)},contains:function(C,G){var F=C.nodeFrom.pos.getc(true),E=C.nodeTo.pos.getc(true),D=C.nodeFrom.scale;this.edgeHelper.arrow.contains({x:F.x*D,y:F.y*D},{x:E.x*D,y:E.y*D},G,this.edge.epsilon)}},hyperline:{render:function(C,D){var G=C.nodeFrom.pos.getc(),F=C.nodeTo.pos.getc(),E=this.viz.getRadius();this.edgeHelper.hyperline.render(G,F,E,D)},contains:d.lambda(false)}})})($jit.Hypertree)})();
/*! openspending.aggregator.js - Aggregation API tools
 * ------------------------------------------------------------------------
 *
 * Copyright 2013 Open Knowledge Foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
;var OpenSpending=OpenSpending||{};OpenSpending.Aggregator=OpenSpending.Aggregator||{};OpenSpending.Aggregator.configFromQueryString=function(d){var b=OpenSpending.Common.parseQueryString(d);var a={};_.each(b,function(f,e){if(e=="breakdown"){a.breakdown=f}else{if(e=="drilldown"){a.drilldowns=f.split("|")}else{if(e=="cut"){a.cuts=f.split("|")}}}});return a};OpenSpending.Aggregator.get=function(b){var a=this;a.config=b;if(!a.config.processEntry){a.config.processEntry=function(d){return d}}if(!a.config.measure){a.config.measure="amount"}a.queryData=function(){var f={},d=a.config;f.dataset=d.dataset;f.drilldown=d.drilldowns.join("|");f.order=d.order;f.page=d.page;f.pagesize=d.pagesize;if(d.cuts!==undefined){f.cut=d.cuts.join("|")}var e=d.drilldowns.slice();if(d.breakdown!==undefined&&d.breakdown.length){e.push(d.breakdown)}e=jQuery.unique(e);f.drilldown=e.join("|");return f};a.queryUrl=function(){var e,d=a.config;if(d.localApiCache!==undefined){return d.localApiCache}apiUrl=d.apiUrl||d.siteUrl+"/api";return apiUrl+"/2/aggregate"};a.getTree=function(){var e=a.queryData();var d=window.btoa(jQuery.param(e)).replace(/\=/g,"");jQuery.ajax({url:a.queryUrl(),cache:true,data:e,jsonpCallback:"aggregate_"+d,dataType:a.config.localApiCache!==undefined?"json":"jsonp",context:a,success:a.onJSONTreeLoaded})};a.getCSVURL=function(){var d=a.queryUrl();var e=a.queryData();e.format="csv";return d+"?"+jQuery.param(e)};a.onJSONTreeLoaded=function(e){var d=a.buildTree(e);if(jQuery.isFunction(a.config.callback)){a.config.callback(d)}};a.buildTree=function(l){var n=l.drilldown,f=a.config,h=f.drilldowns,e=f.breakdown,g={label:f.rootNodeLabel},d={},p={id:"root",label:"Total",color:"#555",currency:l.summary.currency[a.config.measure],children:[],level:0,breakdowns:{}};p[a.config.measure]=0;if(g!==undefined){jQuery.extend(true,p,g)}d.root=p;for(var k in h){var j=h[k];d[j]={}}if(l.errors!==undefined){throw"Error"}for(var o=0;o<n.length;o++){var q=a.config.processEntry(n[o],l);a.processEntry(q,d)}return d.root};a.processEntry=function(l,e){var n=e.root,d=0,i,h=a.config.drilldowns,k,f,g;for(var j in h){i=h[j];d=d+1;k=l[i];g=a.toNode(k,n);f=e[g.id];if(f===undefined){f=g;f.children=[];f[a.config.measure]=0;f.color=k?k.color:undefined;f.level=d;f.breakdowns={};f.currency=n.currency;n.children.push(f);e[f.id]=f}f[a.config.measure]=f[a.config.measure]+l[a.config.measure];if(d===1){e.root[a.config.measure]=e.root[a.config.measure]+l[a.config.measure];a.addBreakdown(e.root,l)}a.addBreakdown(f,l);n=f}};a.addBreakdown=function(h,g){var i=a.config.breakdown;if(i===undefined){return}var f,j,e,d={},k;f=g[i];e=a.toNode(f);k=e.id;j=h.breakdowns[k];if(j===undefined){j=e;h.breakdowns[k]=j}j[a.config.measure]=j[a.config.measure]+g[a.config.measure]};a.toNode=function(g,e){var d=typeof(g);var f={};prefix=e?e.id+"__":"";if(g===undefined||g===null){f.id="others";f.label="Others";f.name="others"}else{if(d==="object"){if(g.id===undefined){f.id="others";f.label="Others";f.name="others"}else{jQuery.extend(true,f,g);if(!f.name){if(f.label){f.name=f.label.toLowerCase().replace(/\W/g,"-")}else{f.name=f.id}}}}else{if(d==="boolean"){if(g){f.id="yes";f.label="Yes";f.name="yes"}else{f.id="no";f.label="No";f.name="no"}}else{if(d==="string"||d==="number"){f.id=g+"";f.label=g+"";f.name=f.id.toLowerCase().replace(/\W/g,"-")}else{throw"unsupported type: "+d}}}}f.id=prefix+f.id;f[a.config.measure]=0;return f};a.getTree()};
/*! openspending.amounts.js - Amount formatting for OpenSpending
 * ------------------------------------------------------------------------
 *
 * Copyright 2013 Open Knowledge Foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
;var OpenSpending=OpenSpending||{};OpenSpending.Amounts=OpenSpending.Amounts||{};OpenSpending.Amounts.shorthand=function(e){var b=1000000000;var a=1000000;var f=1000;var d=Math.abs(e);if(d>b){return OpenSpending.Amounts.format(e/b)+"bn"}else{if(d>a){return OpenSpending.Amounts.format(e/a)+"m"}else{if(d>f){return OpenSpending.Amounts.format(e/f)+"k"}else{return OpenSpending.Amounts.format(e,2)}}}};OpenSpending.Amounts.format=function(d,b,a){a=OpenSpending.Amounts.currencySymbol(a);return accounting.formatMoney(d,a,b||0,OpenSpending.localeGroupSeparator,OpenSpending.localeDecimalSeparator)};OpenSpending.Amounts.currencySymbol=function(a){if(a){return OpenSpending.Amounts.currencySymbols[a]||a}else{return""}};OpenSpending.Amounts.currencySymbols={AED:"د.إ",AFN:"؋",ALL:"L",AMD:"դր.",ANG:"ƒ",AOA:"Kz",ARS:"$",AUD:"$",AWG:"ƒ",AZN:"m",BAM:"KM",BBD:"$",BDT:"৳",BGN:"лв",BHD:"ب.د",BIF:"Fr",BMD:"$",BND:"$",BOB:"Bs.",BRL:"R$",BSD:"$",BTN:"Nu",BWP:"P",BYR:"Br",BZD:"$",CAD:"$",CDF:"Fr",CHF:"Fr",CLP:"$",CNY:"¥",COP:"$",CRC:"₡",CUP:"$",CVE:"$, Esc",CZK:"Kč",DJF:"Fr",DKK:"kr",DOP:"$",DZD:"د.ج",EEK:"KR",EGP:"£,ج.م",ERN:"Nfk",ETB:"Br",EUR:"€",FJD:"$",FKP:"£",GBP:"£",GEL:"ლ",GHS:"₵",GIP:"£",GMD:"D",GNF:"Fr",GTQ:"Q",GYD:"$",HKD:"$",HNL:"L",HRK:"kn",HTG:"G",HUF:"Ft",IDR:"Rp",ILS:"₪",INR:"₨",IQD:"ع.د",IRR:"﷼",ISK:"kr",JMD:"$",JOD:"د.ا",JPY:"¥",KES:"KSh",KGS:"лв",KHR:"៛",KMF:"Fr",KPW:"₩",KRW:"₩",KWD:"د.ك",KYD:"$",KZT:"Т",LAK:"₭",LBP:"ل.ل",LKR:"ரூ",LRD:"$",LSL:"L",LTL:"Lt",LVL:"Ls",LYD:"ل.د",MAD:"د.م.",MDL:"MDL",MGA:"Ar",MKD:"ден",MMK:"K",MNT:"₮",MOP:"P",MRO:"UM",MUR:"₨",MVR:"ރ.",MWK:"MK",MXN:"$",MYR:"RM",MZN:"MT",NAD:"$",NGN:"₦",NIO:"C$",NOK:"kr",NPR:"₨",NZD:"$",OMR:"ر.ع.",PAB:"B/.",PEN:"S/.",PGK:"K",PHP:"₱",PKR:"₨",PLN:"zł",PYG:"₲",QAR:"ر.ق",RON:"RON",RSD:"RSD",RUB:"р.",RWF:"Fr",SAR:"ر.س",SBD:"$",SCR:"₨",SDG:"S$",SEK:"kr",SGD:"$",SHP:"£",SLL:"Le",SOS:"Sh",SRD:"$",STD:"Db",SYP:"£, ل.س",SZL:"L",THB:"฿",TJS:"ЅМ",TMT:"m",TND:"د.ت",TOP:"T$",TRY:"₤",TTD:"$",TWD:"$",TZS:"Sh",UAH:"₴",UGX:"Sh",USD:"$",UYU:"$",UZS:"лв",VEF:"Bs",VND:"₫",VUV:"Vt",WST:"T",XAF:"Fr",XCD:"$",XOF:"Fr",XPF:"Fr",YER:"﷼",ZAR:"R",ZMK:"ZK",ZWL:"$"};
/*! openspending.colors.js - Color palettes for OpenSpending
 * ------------------------------------------------------------------------
 *
 * Copyright 2013 Open Knowledge Foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
;var OpenSpending=OpenSpending||{};OpenSpending.Colors=OpenSpending.Colors||{};OpenSpending.Colors.DefaultPalette=["#CA221D","#C22769","#3F93E1","#481B79","#6AAC32","#42928F","#D32645","#CD531C","#EDC92D","#A5B425","#211D79","#449256","#7A2077","#CA221D","#E29826","#44913D","#2458A3","#2458A3","#14388C"];OpenSpending.Colors.DefaultPalette.getColor=function(d,e){var b=this.slice(0);if(e){var a=b.indexOf(e.toUpperCase());if(a!==-1){b.splice(a,1)}}return b[d%(b.length)]};
/*! openspending.common.js - Common javascript utils for openspendingjs
 * ------------------------------------------------------------------------
 *
 * Copyright 2013 Open Knowledge Foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
;var OpenSpending=OpenSpending||{};OpenSpending.Common=OpenSpending.Common||{};OpenSpending.Common.parseQueryString=function(a){var g=a||window.location.search.substring(1);var b={};var d=function(h){return unescape(h.replace(/\+/g," "))};var f=/([^&=]+)=?([^&]*)/g;var e=undefined;while(e=f.exec(g)){b[d(e[1])]=d(e[2])}return b};
/*! openspending.choropleth.js - Choropleth map creator
 * ------------------------------------------------------------------------
 *
 * Copyright 2013 Open Knowledge Foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
;!function(a){a.choropleth=function(e,d){var b=a.extend(true,{},a.choropleth.defaults,a.choropleth.domopts(e),d);var f=$K.map(e,b.width,b.height);f.loadMap(b.map.url,function(g){a.ajax({url:b.data.url,dataType:"jsonp",success:function(i){var h={};a.each(b.data.objects(i),function(j,k){h[b.data.id(k)]=b.data.intensity(k)});g.addLayer({id:b.map.group,className:"bg",key:b.map.id,filter:function(j){return !h.hasOwnProperty(j[b.map.id])}});g.addLayer({id:b.map.group,key:b.map.id,filter:function(j){return h.hasOwnProperty(j[b.map.id])}});g.choropleth({data:h,colors:function(j){if(j===null){return"#fff"}return b.colorscale.getColor(j)},duration:function(j){return Math.min(900,300*j)},delay:function(j){return 100+200*(10-j)+Math.random()*300}});g.onLayerEvent("click",function(j){b.click(j)})}})},{padding:5})};a.choropleth.defaults={width:640,height:320,data:{url:"http://openspending.org/datasets.json",objects:function(b){return b.territories},intensity:function(b){return b.count},id:function(b){return b.code}},map:{url:"http://openspending.org/static/openspendingjs/app/spending-map/world.svg",group:"regions",id:"iso2"},click:function(b){},colorscale:new chroma.ColorScale({colors:chroma.brewer.Greens,limits:[-2,-1,0,1,2,3,4,5,6,7]})};a.choropleth.domopts=function(b){return{width:a(b).attr("data-map-width"),height:a(b).attr("data-map-height"),data:{url:a(b).attr("data-url"),objects:a(b).attr("data-objects")?function(d){return d[a(b).attr("data-objects")]}:undefined,intensity:a(b).attr("data-intensity")?function(d){return d[a(b).attr("data-intensity")]}:undefined,id:a(b).attr("data-id")?function(d){return d[a(b).attr("data-id")]}:undefined},map:{url:a(b).attr("data-map-url"),group:a(b).attr("data-map-group"),id:a(b).attr("data-map-path-id")}}};a.fn.extend({choropleth:function(b){if(b==undefined){b={}}this.each(function(){a.choropleth(this,b)})}});a(".choropleth").choropleth()}(jQuery);!function(b){function d(f,e,q,o,k,j){var h=(q-f)/2,g=(k-q)/2,r=Math.atan((q-f)/Math.abs(o-e)),p=Math.atan((k-q)/Math.abs(o-j));r=e<o?Math.PI-r:r;p=j<o?Math.PI-p:p;var i=Math.PI/2-((r+p)%(Math.PI*2))/2,u=h*Math.sin(i+r),n=h*Math.cos(i+r),t=g*Math.sin(i+p),l=g*Math.cos(i+p);return{x1:q-u,y1:o+n,x2:q+t,y2:o+l}}var a=function(v,N,D,G,M,f,e,I,t,g,C,w,F){var z=v.path().attr({stroke:F?undefined:D,"stroke-width":4,"stroke-linejoin":"round",opacity:F?0.3:undefined,fill:F?D:undefined});var A;for(var E=0,u=G.length;E<u;E++){var n=Math.round(w-t-e*M[E]),q=Math.round(I+f*(E+0.5));if(!E){if(F){A=["M",I+f*0.5,w-t,"L",q,n,"C",q,n]}else{A=["M",q,n,"C",q,n]}}if(M[E]>0){var B=v.circle(q,n,4).attr({fill:F?D:"#333333",stroke:D,"stroke-width":2});B.data("name",N);B.data("date",G[E]);B.data("amount",OpenSpending.Amounts.shorthand(M[E]));var k,l,o;B.click(function(){if(this.data("marker")){this.data("marker").forEach(function(i){i.remove()});this.data("marker").clear();this.data("marker",undefined)}else{this.data("marker",k)}});B.mouseover(function(S){if(this.data("marker")===undefined){var i=this.attr("cx");var R="start";var Q=this.attr("cy");var O=1;if(S.layerX>C*0.7){R="end";O=-1}var P=[this.data("name"),"\n",this.data("date"),": ",this.data("amount")].join("");k=v.set();l=v.text((i+5*O),(Q-25),P).attr({fill:"#ffffff","text-anchor":R});var p=l.getBBox().width;var r=l.getBBox().height;o=v.path(["M",i,",",(Q-2),"L",i,",",(Q-(r+15)),"L",(i+(p+10)*O),",",(Q-(r+15)),"L",(i+(p+10)*O),",",(Q-10),"L",(i+10*O),",",(Q-10),"Z"].join("")).attr({fill:D,stroke:undefined});l.toFront();k.push(o);k.push(l)}});B.mouseout(function(){if(this.data("marker")===undefined){if(k){k.forEach(function(i){i.remove()});k.clear();k=undefined}}})}if(E&&E<u-1){var j=Math.round(w-t-e*M[E-1]),L=Math.round(I+f*(E-0.5)),h=Math.round(w-t-e*M[E+1]),H=Math.round(I+f*(E+1.5));var J=d(L,j,q,n,H,h);A=A.concat([J.x1,J.y1,q,n,J.x2,J.y2])}}if(F){A=A.concat([q,n,q,n,"L",q,w-t,"z"])}else{A=A.concat([q,n,q,n])}z.attr({path:A});return z};b.timeseries=function(i,o){var k=b(i);var j="#828282";var e;var g=b.extend(true,{},b.timeseries.defaults,b.timeseries.domopts(i),o);var f={drilldowns:g.data.drilldowns,cuts:g.data.cuts,year:g.data.year,month:g.data.month};var n=function(v){console.log(v);var p=5,q=5,z=50,w=j;e.clear();var C=[];var B=[];for(var G in v.breakdowns){C.push(v.breakdowns[G].name);B.push(v.breakdowns[G].amount)}var t=(g.width-p)/C.length,E=Math.max.apply(Math,B),r=(g.height-q-z)/E;var H=a(e,v.label,w,C,B,t,r,p,q,z,g.width,g.height,0.1,true);for(var A in v.children){var u=[];for(var G in v.children[A].breakdowns){u.push(v.children[A].breakdowns[G].amount)}var D=g.colorscale.getColor(A,j);var F=a(e,v.children[A].label,D,C,u,t,r,p,q,z,g.width,g.height);F.data("node",v.children[A]);F.data("color",D);if(v.children[A].children.length){F.click(function(I){j=this.data("color");n(this.data("node"))})}}};var h=function(){f.drilldowns=f.drilldowns||[];f.cuts=f.cuts||{};e=Raphael(i,g.width,g.height);l("Total")};var l=function(q){var p=[];for(var r in f.cuts){p.push(r+":"+f.cuts[r])}if(f.year){p.push("time.year:"+f.year)}if(f.month){p.push("time.month:"+f.month)}if(f.drilldowns){OpenSpending.Aggregator.get({siteUrl:g.data.site,dataset:g.data.dataset,drilldowns:f.drilldowns,breakdown:["time"],cuts:p,rootNodeLabel:q,callback:n})}};h()};b.timeseries.defaults={data:{site:"http://openspending.org",dataset:undefined,year:undefined,month:undefined,drilldowns:[],cuts:{}},width:600,height:400,colorscale:OpenSpending.Colors.DefaultPalette,point:{tooltip:function(e){return[e.label," (",OpenSpending.Amounts.format(node.amount,2),"%)"].join("")}}};b.timeseries.domopts=function(f){var e=b(f);return{data:{site:e.attr("data-site"),dataset:e.attr("data-dataset"),drilldowns:b(f).attr("data-drilldowns")?e.attr("data-drilldowns").split(","):undefined,year:e.attr("data-year"),cuts:b(f).attr("data-cuts")?JSON.parse(e.attr("data-cuts")):undefined},width:e.attr("data-width"),height:e.attr("data-height")}};b.fn.extend({timeseries:function(e){if(e==undefined){e={}}this.each(function(){b.timeseries(this,e)})}});b(".timeseries[data-dataset]").timeseries()}(jQuery);!function(a){a.treemap=function(h,g){var e=a(h);if(!e.attr("id")){e.attr("id",Math.random().toString().substr(2))}var f=a.extend(true,{},a.treemap.defaults,a.treemap.domopts(h),g);var j={drilldowns:f.data.drilldowns,cuts:f.data.cuts,year:f.data.year};var d=function(l){e.empty();if(!l.children.length){e.hide();return}e.show();var k=new $jit.TM.Squarified({injectInto:h,width:f.width,height:f.height,levelsToShow:1,titleHeight:0,animate:f.transition.animate,transition:f.transition.type,duration:f.transition.duration,offset:2,Label:{type:"HTML",size:12,family:"Tahoma, Verdana, Arial",color:"#DDE7F0"},onCreateLabel:function(o,n){f.node.label(o,n)},Tips:{enable:true,type:"Native",offsetX:20,offsetY:20,onShow:function(o,n){o.innerHTML=f.node.tooltip(n)}},Node:{color:"#243448",CanvasStyles:{shadowBlur:0,shadowColor:"#000"}},Events:{enable:true,onClick:function(o){if(o){var p=f.click(o);if(p){if(o.data.node.children.length){i(o.data.node)}else{if(o.data.link){var n=this.embed?o.data.link+"?embed=true":o.data.link;document.location.href=n}else{alert("Not able to go any further")}}}}},onMouseEnter:function(n,o,p){if(n){if(n.data.link===undefined){e.find("#"+n.id).css("cursor","default")}n.setCanvasStyle("shadowBlur",8);n.orig_color=n.getData("color");n.setData("color","#A3B3C7");k.fx.plotNode(n,k.canvas)}},onMouseLeave:function(n){if(n){n.removeData("color");n.removeCanvasStyle("shadowBlur");n.setData("color",n.orig_color);k.plot()}}},request:function(q,r,p){var n=json;var o=$jit.json.getSubtree(n,q);$jit.json.prune(o,1);p.onComplete(q,o)}});k.loadJSON(l);k.refresh()};var i=function(k){var l={children:_.map(k.children,function(o,n){return{id:o.id,name:o.label||o.name,data:{node:o,value:o.amount,currency:o.currency,percentage:(o.amount/k.amount)*100,$area:o.amount,link:o.html_url,$color:o.color||f.colorscale.getColor(n)}}})};d(l)};var b=function(){j.drilldowns=j.drilldowns||[j.drilldown];j.cuts=j.cuts||{};var k=[];for(var l in j.cuts){k.push(l+":"+j.cuts[l])}if(j.year){k.push("time.year:"+j.year)}if(j.drilldowns){OpenSpending.Aggregator.get({siteUrl:f.data.site,dataset:f.data.dataset,drilldowns:j.drilldowns,cuts:k,rootNodeLabel:"Total",callback:i})}};e.addClass("treemap-widget");b()};a.treemap.defaults={data:{site:"http://openspending.org",dataset:undefined,drilldowns:["from","to"],year:undefined,cuts:{}},click:function(b){return true},width:600,height:400,embed:false,colorscale:OpenSpending.Colors.DefaultPalette,transition:{animate:true,type:$jit.Trans.Expo.easeOut,duration:1000},node:{label:function(d,b){if(b.data.percentage>3){d.innerHTML=['<div class="desc"><div class="amount">',OpenSpending.Amounts.format(b.data.value,0,b.data.currency),'</div><div class="lbl">',b.name,"</div></div>"].join("")}},tooltip:function(b){return[b.name," (",OpenSpending.Amounts.format(b.data.percentage,2),"%)"].join("")}}};a.treemap.domopts=function(d){var b=a(d);return{data:{site:b.attr("data-site"),dataset:b.attr("data-dataset"),drilldowns:a(d).attr("data-drilldowns")?b.attr("data-drilldowns").split(","):undefined,year:b.attr("data-year"),cuts:a(d).attr("data-cuts")?JSON.parse(b.attr("data-cuts")):undefined},width:b.attr("data-width"),height:b.attr("data-height"),transition:{duration:b.attr("data-duration")}}};a.fn.extend({treemap:function(b){if(b==undefined){b={}}this.each(function(){a.treemap(this,b)})}});a(".treemap[data-dataset]").treemap()}(jQuery);